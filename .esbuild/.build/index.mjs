var d$=Object.create;var zu=Object.defineProperty;var l$=Object.getOwnPropertyDescriptor;var p$=Object.getOwnPropertyNames;var u$=Object.getPrototypeOf,f$=Object.prototype.hasOwnProperty;var d=(e,t)=>()=>(e&&(t=e(e=0)),t);var Fi=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Nt=(e,t)=>{for(var r in t)zu(e,r,{get:t[r],enumerable:!0})},m$=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of p$(t))!f$.call(e,n)&&n!==r&&zu(e,n,{get:()=>t[n],enumerable:!(o=l$(t,n))||o.enumerable});return e};var h$=(e,t,r)=>(r=e!=null?d$(u$(e)):{},m$(t||!e||!e.__esModule?zu(r,"default",{value:e,enumerable:!0}):r,e));var Ey=d(()=>{});var _y,by=d(()=>{(function(e){e.HEADER="header",e.QUERY="query"})(_y||(_y={}))});var wy,Ry=d(()=>{(function(e){e.HEADER="header",e.QUERY="query"})(wy||(wy={}))});var Iy=d(()=>{});var Ty=d(()=>{});var vy=d(()=>{});var Cy=d(()=>{});var Ay=d(()=>{by();Ry();Iy();Ty();vy();Cy()});var Py=d(()=>{});var Dy=d(()=>{});var Ny=d(()=>{});var Oy=d(()=>{});var ky=d(()=>{});var $y=d(()=>{});var My=d(()=>{});var Ly=d(()=>{ky();$y();My()});var Uy=d(()=>{});var Fy=d(()=>{});var Ws,By=d(()=>{(function(e){e.HTTP="http",e.HTTPS="https"})(Ws||(Ws={}))});var Hy=d(()=>{});var Vy=d(()=>{});var Gy=d(()=>{});var jy=d(()=>{});var Wy=d(()=>{});var zy=d(()=>{Hy();Vy();Gy();jy();Wy()});var Ky=d(()=>{});var zs,qy=d(()=>{(function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"})(zs||(zs={}))});var Jy=d(()=>{});var Yy=d(()=>{});var Xy=d(()=>{Jy();Yy();qy()});var Qy=d(()=>{});var Zy,e0=d(()=>{(function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"})(Zy||(Zy={}))});var t0=d(()=>{});var r0=d(()=>{});var o0=d(()=>{});var n0=d(()=>{});var s0=d(()=>{});var i0=d(()=>{r0();o0();n0();s0()});var a0=d(()=>{});var Zi,c0=d(()=>{Zi="__smithy_context"});var d0=d(()=>{});var Po,l0=d(()=>{(function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"})(Po||(Po={}))});var p0=d(()=>{});var u0=d(()=>{});var f0=d(()=>{});var m0=d(()=>{});var h0=d(()=>{});var g0=d(()=>{});var x0=d(()=>{});var y0=d(()=>{});var S0=d(()=>{});var E0=d(()=>{});var _0=d(()=>{});var b0=d(()=>{});var w0=d(()=>{});var R0=d(()=>{});var I0,T0=d(()=>{(function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"})(I0||(I0={}))});var v0=d(()=>{});var C0=d(()=>{});var A0=d(()=>{});var P0=d(()=>{});var D0=d(()=>{});var N0=d(()=>{});var O0=d(()=>{});var nn=d(()=>{Ey();Ay();Py();Dy();Ny();Oy();Ly();Uy();Fy();By();zy();Ky();Xy();Qy();e0();t0();i0();a0();c0();d0();l0();p0();u0();f0();m0();h0();g0();x0();y0();S0();E0();_0();b0();w0();R0();T0();v0();C0();A0();P0();D0();N0();O0()});var ve,k0=d(()=>{nn();ve=e=>e[Zi]||(e[Zi]={})});var de,$0=d(()=>{de=e=>{if(typeof e=="function")return e;let t=Promise.resolve(e);return()=>t}});var Ze=d(()=>{k0();$0()});var Kt,qt,G0=d(()=>{Kt=e=>({setHttpHandler(t){e.httpHandler=t},httpHandler(){return e.httpHandler},updateHttpClientConfig(t,r){e.httpHandler?.updateHttpClientConfig(t,r)},httpHandlerConfigs(){return e.httpHandler.httpHandlerConfigs()}}),qt=e=>({httpHandler:e.httpHandler()})});var j0=d(()=>{G0()});var W0=d(()=>{});var z0=d(()=>{});var K0=d(()=>{});function x2(e){return Object.keys(e).reduce((t,r)=>{let o=e[r];return{...t,[r]:Array.isArray(o)?[...o]:o}},{})}var le,q0=d(()=>{le=class e{method;protocol;hostname;port;path;query;headers;username;password;fragment;body;constructor(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?`${t.protocol}:`:t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?`/${t.path}`:t.path:"/",this.username=t.username,this.password=t.password,this.fragment=t.fragment}static clone(t){let r=new e({...t,headers:{...t.headers}});return r.query&&(r.query=x2(r.query)),r}static isInstance(t){if(!t)return!1;let r=t;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){return e.clone(this)}}});var Jt,J0=d(()=>{Jt=class{statusCode;reason;headers;body;constructor(t){this.statusCode=t.statusCode,this.reason=t.reason,this.headers=t.headers||{},this.body=t.body}static isInstance(t){if(!t)return!1;let r=t;return typeof r.statusCode=="number"&&typeof r.headers=="object"}}});var Y0=d(()=>{});var X0=d(()=>{});var we=d(()=>{j0();W0();z0();K0();q0();J0();Y0();X0()});var Z0=Fi((Iq,Q0)=>{function Do(e){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:e}),this.done=!1}Do.prototype.next=function(){if(this.done)return{done:!0};var e=this._next();return e.done&&(this.done=!0),e};typeof Symbol<"u"&&(Do.prototype[Symbol.iterator]=function(){return this});Do.of=function(){var e=arguments,t=e.length,r=0;return new Do(function(){return r>=t?{done:!0}:{done:!1,value:e[r++]}})};Do.empty=function(){var e=new Do(null);return e.done=!0,e};Do.is=function(e){return e instanceof Do?!0:typeof e=="object"&&e!==null&&typeof e.next=="function"};Q0.exports=Do});var mf=Fi((Tq,oS)=>{var eS=typeof ArrayBuffer<"u",tS=typeof Symbol<"u";function rS(e,t){var r,o,n,s,i;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof t!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||eS&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(n=0,s=e.length;n<s;n++)t(e[n],n);return}if(typeof e.forEach=="function"){e.forEach(t);return}if(tS&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(r=e,n=0;i=r.next(),i.done!==!0;)t(i.value,n),n++;return}for(o in e)e.hasOwnProperty(o)&&t(e[o],o)}rS.forEachWithNullKeys=function(e,t){var r,o,n,s,i;if(!e)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if(typeof t!="function")throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(e)||eS&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(n=0,s=e.length;n<s;n++)t(e[n],null);return}if(e instanceof Set){e.forEach(function(a){t(a,null)});return}if(typeof e.forEach=="function"){e.forEach(t);return}if(tS&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(r=e,n=0;i=r.next(),i.done!==!0;)t(i.value,null),n++;return}for(o in e)e.hasOwnProperty(o)&&t(e[o],o)};oS.exports=rS});var hf=Fi(no=>{var y2=Math.pow(2,8)-1,S2=Math.pow(2,16)-1,E2=Math.pow(2,32)-1,_2=Math.pow(2,7)-1,b2=Math.pow(2,15)-1,w2=Math.pow(2,31)-1;no.getPointerArray=function(e){var t=e-1;return t<=y2?Uint8Array:t<=S2?Uint16Array:t<=E2?Uint32Array:Float64Array};no.getSignedPointerArray=function(e){var t=e-1;return t<=_2?Int8Array:t<=b2?Int16Array:t<=w2?Int32Array:Float64Array};no.getNumberType=function(e){return e===(e|0)?Math.sign(e)===-1?e<=127&&e>=-128?Int8Array:e<=32767&&e>=-32768?Int16Array:Int32Array:e<=255?Uint8Array:e<=65535?Uint16Array:Uint32Array:Float64Array};var R2={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};no.getMinimalRepresentation=function(e,t){var r=null,o=0,n,s,i,a,c;for(a=0,c=e.length;a<c;a++)i=t?t(e[a]):e[a],s=no.getNumberType(i),n=R2[s.name],n>o&&(o=n,r=s);return r};no.isTypedArray=function(e){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(e)};no.concat=function(){var e=0,t,r,o;for(t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=new arguments[0].constructor(e);for(t=0,r=0;t<o;t++)n.set(arguments[t],r),r+=arguments[t].length;return n};no.indices=function(e){for(var t=no.getPointerArray(e),r=new t(e),o=0;o<e;o++)r[o]=o;return r}});var iS=Fi(ta=>{var nS=mf(),sS=hf();function I2(e){return Array.isArray(e)||sS.isTypedArray(e)}function gf(e){if(typeof e.length=="number")return e.length;if(typeof e.size=="number")return e.size}function T2(e){var t=gf(e),r=typeof t=="number"?new Array(t):[],o=0;return nS(e,function(n){r[o++]=n}),r}function v2(e){var t=gf(e),r=typeof t=="number"?sS.getPointerArray(t):Array,o=typeof t=="number"?new Array(t):[],n=typeof t=="number"?new r(t):[],s=0;return nS(e,function(i){o[s]=i,n[s]=s++}),[o,n]}ta.isArrayLike=I2;ta.guessLength=gf;ta.toArray=T2;ta.toArrayWithIndices=v2});var cS=Fi((Aq,aS)=>{var xf=Z0(),C2=mf(),A2=hf(),P2=iS();function Le(e,t,r){if(arguments.length<2&&(r=e,e=null,t=null),this.capacity=r,typeof this.capacity!="number"||this.capacity<=0)throw new Error("mnemonist/lru-cache: capacity should be positive number.");var o=A2.getPointerArray(r);this.forward=new o(r),this.backward=new o(r),this.K=typeof e=="function"?new e(r):new Array(r),this.V=typeof t=="function"?new t(r):new Array(r),this.size=0,this.head=0,this.tail=0,this.items={}}Le.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items={}};Le.prototype.splayOnTop=function(e){var t=this.head;if(this.head===e)return this;var r=this.backward[e],o=this.forward[e];return this.tail===e?this.tail=r:this.backward[o]=r,this.forward[r]=o,this.backward[t]=e,this.head=e,this.forward[e]=t,this};Le.prototype.set=function(e,t){var r=this.items[e];if(typeof r<"u"){this.splayOnTop(r),this.V[r]=t;return}this.size<this.capacity?r=this.size++:(r=this.tail,this.tail=this.backward[r],delete this.items[this.K[r]]),this.items[e]=r,this.K[r]=e,this.V[r]=t,this.forward[r]=this.head,this.backward[this.head]=r,this.head=r};Le.prototype.setpop=function(e,t){var r=null,o=null,n=this.items[e];return typeof n<"u"?(this.splayOnTop(n),r=this.V[n],this.V[n]=t,{evicted:!1,key:e,value:r}):(this.size<this.capacity?n=this.size++:(n=this.tail,this.tail=this.backward[n],r=this.V[n],o=this.K[n],delete this.items[this.K[n]]),this.items[e]=n,this.K[n]=e,this.V[n]=t,this.forward[n]=this.head,this.backward[this.head]=n,this.head=n,o?{evicted:!0,key:o,value:r}:null)};Le.prototype.has=function(e){return e in this.items};Le.prototype.get=function(e){var t=this.items[e];if(!(typeof t>"u"))return this.splayOnTop(t),this.V[t]};Le.prototype.peek=function(e){var t=this.items[e];if(!(typeof t>"u"))return this.V[t]};Le.prototype.forEach=function(e,t){t=arguments.length>1?t:this;for(var r=0,o=this.size,n=this.head,s=this.K,i=this.V,a=this.forward;r<o;)e.call(t,i[n],s[n],this),n=a[n],r++};Le.prototype.keys=function(){var e=0,t=this.size,r=this.head,o=this.K,n=this.forward;return new xf(function(){if(e>=t)return{done:!0};var s=o[r];return e++,e<t&&(r=n[r]),{done:!1,value:s}})};Le.prototype.values=function(){var e=0,t=this.size,r=this.head,o=this.V,n=this.forward;return new xf(function(){if(e>=t)return{done:!0};var s=o[r];return e++,e<t&&(r=n[r]),{done:!1,value:s}})};Le.prototype.entries=function(){var e=0,t=this.size,r=this.head,o=this.K,n=this.V,s=this.forward;return new xf(function(){if(e>=t)return{done:!0};var i=o[r],a=n[r];return e++,e<t&&(r=s[r]),{done:!1,value:[i,a]}})};typeof Symbol<"u"&&(Le.prototype[Symbol.iterator]=Le.prototype.entries);Le.prototype.inspect=function(){for(var e=new Map,t=this.entries(),r;r=t.next(),!r.done;)e.set(r.value[0],r.value[1]);return Object.defineProperty(e,"constructor",{value:Le,enumerable:!1}),e};typeof Symbol<"u"&&(Le.prototype[Symbol.for("nodejs.util.inspect.custom")]=Le.prototype.inspect);Le.from=function(e,t,r,o){if(arguments.length<2){if(o=P2.guessLength(e),typeof o!="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else arguments.length===2&&(o=t,t=null,r=null);var n=new Le(t,r,o);return C2(e,function(s,i){n.set(i,s)}),n};aS.exports=Le});var D2,N2,Yt,Xn=d(()=>{we();D2=e=>t=>async r=>{if(!le.isInstance(r.request))return t(r);let{request:o}=r,{handlerProtocol:n=""}=e.requestHandler.metadata||{};if(n.indexOf("h2")>=0&&!o.headers[":authority"])delete o.headers.host,o.headers[":authority"]=o.hostname+(o.port?":"+o.port:"");else if(!o.headers.host){let s=o.hostname;o.port!=null&&(s+=`:${o.port}`),o.headers.host=s}return t(r)},N2={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},Yt=e=>({applyToStack:t=>{t.add(D2(e),N2)}})});var O2,k2,Xt,pS=d(()=>{O2=()=>(e,t)=>async r=>{try{let o=await e(r),{clientName:n,commandName:s,logger:i,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:c,overrideOutputFilterSensitiveLog:l}=a,p=c??t.inputFilterSensitiveLog,u=l??t.outputFilterSensitiveLog,{$metadata:f,...m}=o.output;return i?.info?.({clientName:n,commandName:s,input:p(r.input),output:u(m),metadata:f}),o}catch(o){let{clientName:n,commandName:s,logger:i,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:c}=a,l=c??t.inputFilterSensitiveLog;throw i?.error?.({clientName:n,commandName:s,input:l(r.input),error:o,metadata:o.$metadata}),o}},k2={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},Xt=e=>({applyToStack:t=>{t.add(O2(),k2)}})});var Qn=d(()=>{pS()});var uS,fS=d(()=>{uS={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"}});var ra,yf,ed,Sf,Ef,td,mS=d(()=>{ra={REQUEST_ID:Symbol.for("_AWS_LAMBDA_REQUEST_ID"),X_RAY_TRACE_ID:Symbol.for("_AWS_LAMBDA_X_RAY_TRACE_ID"),TENANT_ID:Symbol.for("_AWS_LAMBDA_TENANT_ID")},yf=["true","1"].includes(process.env?.AWS_LAMBDA_NODEJS_NO_GLOBAL_AWSLAMBDA??"");yf||(globalThis.awslambda=globalThis.awslambda||{});ed=class{static PROTECTED_KEYS=ra;isProtectedKey(t){return Object.values(ra).includes(t)}getRequestId(){return this.get(ra.REQUEST_ID)??"-"}getXRayTraceId(){return this.get(ra.X_RAY_TRACE_ID)}getTenantId(){return this.get(ra.TENANT_ID)}},Sf=class extends ed{currentContext;getContext(){return this.currentContext}hasContext(){return this.currentContext!==void 0}get(t){return this.currentContext?.[t]}set(t,r){if(this.isProtectedKey(t))throw new Error(`Cannot modify protected Lambda context field: ${String(t)}`);this.currentContext=this.currentContext||{},this.currentContext[t]=r}run(t,r){return this.currentContext=t,r()}},Ef=class e extends ed{als;static async create(){let t=new e,r=await import("node:async_hooks");return t.als=new r.AsyncLocalStorage,t}getContext(){return this.als.getStore()}hasContext(){return this.als.getStore()!==void 0}get(t){return this.als.getStore()?.[t]}set(t,r){if(this.isProtectedKey(t))throw new Error(`Cannot modify protected Lambda context field: ${String(t)}`);let o=this.als.getStore();if(!o)throw new Error("No context available");o[t]=r}run(t,r){return this.als.run(t,r)}};(function(e){let t=null;async function r(){return t||(t=(async()=>{let n="AWS_LAMBDA_MAX_CONCURRENCY"in process.env?await Ef.create():new Sf;return!yf&&globalThis.awslambda?.InvokeStore?globalThis.awslambda.InvokeStore:(!yf&&globalThis.awslambda&&(globalThis.awslambda.InvokeStore=n),n)})()),t}e.getInstanceAsync=r,e._testing=process.env.AWS_LAMBDA_BENCHMARK_MODE==="1"?{reset:()=>{t=null,globalThis.awslambda?.InvokeStore&&delete globalThis.awslambda.InvokeStore,globalThis.awslambda={}}}:void 0})(td||(td={}))});var _f,$2,M2,hS,bf=d(()=>{mS();we();_f="X-Amzn-Trace-Id",$2="AWS_LAMBDA_FUNCTION_NAME",M2="_X_AMZN_TRACE_ID",hS=()=>e=>async t=>{let{request:r}=t;if(!le.isInstance(r))return e(t);let o=Object.keys(r.headers??{}).find(p=>p.toLowerCase()===_f.toLowerCase())??_f;if(r.headers.hasOwnProperty(o))return e(t);let n=process.env[$2],s=process.env[M2],c=(await td.getInstanceAsync())?.getXRayTraceId()??s,l=p=>typeof p=="string"&&p.length>0;return l(n)&&l(c)&&(r.headers[_f]=c),e({...t,request:r})}});var Qt,gS=d(()=>{fS();bf();Qt=e=>({applyToStack:t=>{t.add(hS(),uS)}})});var Zn=d(()=>{gS();bf()});var xS=d(()=>{});var yS,SS=d(()=>{yS=(e,t)=>{if(!t||t.length===0)return e;let r=[];for(let o of t)for(let n of e)n.schemeId.split("#")[1]===o&&r.push(n);for(let o of e)r.find(({schemeId:n})=>n===o.schemeId)||r.push(o);return r}});function L2(e){let t=new Map;for(let r of e)t.set(r.schemeId,r);return t}var ES,wf=d(()=>{Ze();SS();ES=(e,t)=>(r,o)=>async n=>{let s=e.httpAuthSchemeProvider(await t.httpAuthSchemeParametersProvider(e,o,n.input)),i=e.authSchemePreference?await e.authSchemePreference():[],a=yS(s,i),c=L2(e.httpAuthSchemes),l=ve(o),p=[];for(let u of a){let f=c.get(u.schemeId);if(!f){p.push(`HttpAuthScheme \`${u.schemeId}\` was not enabled for this service.`);continue}let m=f.identityProvider(await t.identityProviderConfigProvider(e));if(!m){p.push(`HttpAuthScheme \`${u.schemeId}\` did not have an IdentityProvider configured.`);continue}let{identityProperties:h={},signingProperties:g={}}=u.propertiesExtractor?.(e,o)||{};u.identityProperties=Object.assign(u.identityProperties||{},h),u.signingProperties=Object.assign(u.signingProperties||{},g),l.selectedHttpAuthScheme={httpAuthOption:u,identity:await m(u.identityProperties),signer:f.signer};break}if(!l.selectedHttpAuthScheme)throw new Error(p.join(`
`));return r(n)}});var U2,Zt,_S=d(()=>{wf();U2={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},Zt=(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:r})=>({applyToStack:o=>{o.addRelativeTo(ES(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:r}),U2)}})});var bS=d(()=>{});var wS=d(()=>{});var rd,RS=d(()=>{rd={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0}});var Rf=d(()=>{bS();RS();wS()});var lJ,IS=d(()=>{Rf();lJ={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:rd.name}});var TS=d(()=>{wf();_S();IS()});var F2,B2,vS,If=d(()=>{we();Ze();F2=e=>t=>{throw t},B2=(e,t)=>{},vS=e=>(t,r)=>async o=>{if(!le.isInstance(o.request))return t(o);let s=ve(r).selectedHttpAuthScheme;if(!s)throw new Error("No HttpAuthScheme was selected: unable to sign request");let{httpAuthOption:{signingProperties:i={}},identity:a,signer:c}=s,l=await t({...o,request:await c.sign(o.request,a,i)}).catch((c.errorHandler||F2)(i));return(c.successHandler||B2)(l.response,i),l}});var H2,er,CS=d(()=>{If();H2={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},er=e=>({applyToStack:t=>{t.addRelativeTo(vS(e),H2)}})});var AS=d(()=>{If();CS()});var es,PS=d(()=>{es=e=>{if(typeof e=="function")return e;let t=Promise.resolve(e);return()=>t}});function No(e,t,r,o,n){return async function*(i,a,...c){let l=a,p=i.startingToken??l[r],u=!0,f;for(;u;){if(l[r]=p,n&&(l[n]=l[n]??i.pageSize),i.client instanceof e)f=await V2(t,i.client,a,i.withCommand,...c);else throw new Error(`Invalid client, expected instance of ${e.name}`);yield f;let m=p;p=G2(f,o),u=!!(p&&(!i.stopOnSameToken||p!==m))}return void 0}}var V2,G2,DS=d(()=>{V2=async(e,t,r,o=s=>s,...n)=>{let s=new e(r);return s=o(s)??s,await t.send(s,...n)};G2=(e,t)=>{let r=e,o=t.split(".");for(let n of o){if(!r||typeof r!="object")return;r=r[n]}return r}});var od,Tf=d(()=>{od=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]"});import{Buffer as vf}from"buffer";var Oo,Ks,ts=d(()=>{Tf();Oo=(e,t=0,r=e.byteLength-t)=>{if(!od(e))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return vf.from(e,t,r)},Ks=(e,t)=>{if(typeof e!="string")throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?vf.from(e,t):vf.from(e)}});var j2,Ie,NS=d(()=>{ts();j2=/^[A-Za-z0-9+/]*={0,2}$/,Ie=e=>{if(e.length*3%4!==0)throw new TypeError("Incorrect padding on base64 string.");if(!j2.exec(e))throw new TypeError("Invalid base64 string.");let t=Ks(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}});var _e,Cf=d(()=>{ts();_e=e=>{let t=Ks(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)}});var jr,OS=d(()=>{Cf();jr=e=>typeof e=="string"?_e(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)});var Se,kS=d(()=>{ts();Se=e=>{if(typeof e=="string")return e;if(typeof e!="object"||typeof e.byteOffset!="number"||typeof e.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return Oo(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}});var Ae=d(()=>{Cf();OS();kS()});var Ee,$S=d(()=>{ts();Ae();Ee=e=>{let t;if(typeof e=="string"?t=_e(e):t=e,typeof t!="object"||typeof t.byteOffset!="number"||typeof t.byteLength!="number")throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return Oo(t.buffer,t.byteOffset,t.byteLength).toString("base64")}});var et=d(()=>{NS();$S()});var qs,MS=d(()=>{et();Ae();qs=class e extends Uint8Array{static fromString(t,r="utf-8"){if(typeof t=="string")return r==="base64"?e.mutate(Ie(t)):e.mutate(_e(t));throw new Error(`Unsupported conversion from ${typeof t} to Uint8ArrayBlobAdapter.`)}static mutate(t){return Object.setPrototypeOf(t,e.prototype),t}transformToString(t="utf-8"){return t==="base64"?Ee(this):Se(this)}}});var LS=d(()=>{});var Af,Pf=d(()=>{Af=e=>typeof ReadableStream=="function"&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream)});var US=d(()=>{});var FS=d(()=>{});var BS=d(()=>{});var HS=d(()=>{});var so,W2,VS=d(()=>{so=e=>encodeURIComponent(e).replace(/[!'()*]/g,W2),W2=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`});var GS=d(()=>{});var nd=d(()=>{VS();GS()});function jS(e){let t=[];for(let r of Object.keys(e).sort()){let o=e[r];if(r=so(r),Array.isArray(o))for(let n=0,s=o.length;n<s;n++)t.push(`${r}=${so(o[n])}`);else{let n=r;(o||typeof o=="string")&&(n+=`=${so(o)}`),t.push(n)}}return t.join("&")}var WS=d(()=>{nd()});var zS,KS=d(()=>{zS=["ECONNRESET","EPIPE","ETIMEDOUT"]});var qS,JS=d(()=>{qS=e=>{let t={};for(let r of Object.keys(e)){let o=e[r];t[r]=Array.isArray(o)?o.join(","):o}return t}});var Pe,rs=d(()=>{Pe={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e)}});var YS,XS,QS=d(()=>{rs();YS=1e3,XS=(e,t,r=0)=>{if(!r)return-1;let o=n=>{let s=Pe.setTimeout(()=>{e.destroy(),t(Object.assign(new Error(`@smithy/node-http-handler - the request socket did not establish a connection with the server within the configured timeout of ${r} ms.`),{name:"TimeoutError"}))},r-n),i=a=>{a?.connecting?a.on("connect",()=>{Pe.clearTimeout(s)}):Pe.clearTimeout(s)};e.socket?i(e.socket):e.on("socket",i)};return r<2e3?(o(0),0):Pe.setTimeout(o.bind(null,YS),YS)}});var ZS,eE=d(()=>{rs();ZS=(e,t,r=0,o,n)=>r?Pe.setTimeout(()=>{let s=`@smithy/node-http-handler - [${o?"ERROR":"WARN"}] a request has exceeded the configured ${r} ms requestTimeout.`;if(o){let i=Object.assign(new Error(s),{name:"TimeoutError",code:"ETIMEDOUT"});e.destroy(i),t(i)}else s+=" Init client requestHandler with throwOnRequestTimeout=true to turn this into an error.",n?.warn?.(s)},r):-1});var z2,tE,rE=d(()=>{rs();z2=3e3,tE=(e,{keepAlive:t,keepAliveMsecs:r},o=z2)=>{if(t!==!0)return-1;let n=()=>{e.socket?e.socket.setKeepAlive(t,r||0):e.on("socket",s=>{s.setKeepAlive(t,r||0)})};return o===0?(n(),0):Pe.setTimeout(n,o)}});var oE,nE,sE=d(()=>{rs();oE=3e3,nE=(e,t,r=0)=>{let o=n=>{let s=r-n,i=()=>{e.destroy(),t(Object.assign(new Error(`@smithy/node-http-handler - the request socket timed out after ${r} ms of inactivity (configured by client requestHandler).`),{name:"TimeoutError"}))};e.socket?(e.socket.setTimeout(s,i),e.on("close",()=>e.socket?.removeListener("timeout",i))):e.setTimeout(s,i)};return 0<r&&r<6e3?(o(0),0):Pe.setTimeout(o.bind(null,r===0?0:oE),oE)}});import{Readable as K2}from"stream";async function aE(e,t,r=iE,o=!1){let n=t.headers??{},s=n.Expect||n.expect,i=-1,a=!0;!o&&s==="100-continue"&&(a=await Promise.race([new Promise(c=>{i=Number(Pe.setTimeout(()=>c(!0),Math.max(iE,r)))}),new Promise(c=>{e.on("continue",()=>{Pe.clearTimeout(i),c(!0)}),e.on("response",()=>{Pe.clearTimeout(i),c(!1)}),e.on("error",()=>{Pe.clearTimeout(i),c(!1)})})])),a&&q2(e,t.body)}function q2(e,t){if(t instanceof K2){t.pipe(e);return}if(t){if(Buffer.isBuffer(t)||typeof t=="string"){e.end(t);return}let r=t;if(typeof r=="object"&&r.buffer&&typeof r.byteOffset=="number"&&typeof r.byteLength=="number"){e.end(Buffer.from(r.buffer,r.byteOffset,r.byteLength));return}e.end(Buffer.from(t));return}e.end()}var iE,cE=d(()=>{rs();iE=6e3});import{Agent as Df,request as J2}from"http";import{Agent as Nf,request as Y2}from"https";var tt,dE=d(()=>{we();WS();KS();JS();QS();eE();rE();sE();rs();cE();tt=class e{config;configProvider;socketWarningTimestamp=0;externalAgent=!1;metadata={handlerProtocol:"http/1.1"};static create(t){return typeof t?.handle=="function"?t:new e(t)}static checkSocketUsage(t,r,o=console){let{sockets:n,requests:s,maxSockets:i}=t;if(typeof i!="number"||i===1/0||Date.now()-15e3<r)return r;if(n&&s)for(let c in n){let l=n[c]?.length??0,p=s[c]?.length??0;if(l>=i&&p>=2*i)return o?.warn?.(`@smithy/node-http-handler:WARN - socket usage at capacity=${l} and ${p} additional requests are enqueued.
See https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/node-configuring-maxsockets.html
or increase socketAcquisitionWarningTimeout=(millis) in the NodeHttpHandler config.`),Date.now()}return r}constructor(t){this.configProvider=new Promise((r,o)=>{typeof t=="function"?t().then(n=>{r(this.resolveDefaultConfig(n))}).catch(o):r(this.resolveDefaultConfig(t))})}resolveDefaultConfig(t){let{requestTimeout:r,connectionTimeout:o,socketTimeout:n,socketAcquisitionWarningTimeout:s,httpAgent:i,httpsAgent:a,throwOnRequestTimeout:c}=t||{},l=!0,p=50;return{connectionTimeout:o,requestTimeout:r,socketTimeout:n,socketAcquisitionWarningTimeout:s,throwOnRequestTimeout:c,httpAgent:i instanceof Df||typeof i?.destroy=="function"?(this.externalAgent=!0,i):new Df({keepAlive:l,maxSockets:p,...i}),httpsAgent:a instanceof Nf||typeof a?.destroy=="function"?(this.externalAgent=!0,a):new Nf({keepAlive:l,maxSockets:p,...a}),logger:console}}destroy(){this.config?.httpAgent?.destroy(),this.config?.httpsAgent?.destroy()}async handle(t,{abortSignal:r,requestTimeout:o}={}){return this.config||(this.config=await this.configProvider),new Promise((n,s)=>{let i=this.config,a,c=[],l=async ye=>{await a,c.forEach(Pe.clearTimeout),n(ye)},p=async ye=>{await a,c.forEach(Pe.clearTimeout),s(ye)};if(r?.aborted){let ye=new Error("Request aborted");ye.name="AbortError",p(ye);return}let u=t.protocol==="https:",f=t.headers??{},m=(f.Expect??f.expect)==="100-continue",h=u?i.httpsAgent:i.httpAgent;m&&!this.externalAgent&&(h=new(u?Nf:Df)({keepAlive:!1,maxSockets:1/0})),c.push(Pe.setTimeout(()=>{this.socketWarningTimestamp=e.checkSocketUsage(h,this.socketWarningTimestamp,i.logger)},i.socketAcquisitionWarningTimeout??(i.requestTimeout??2e3)+(i.connectionTimeout??1e3)));let g=jS(t.query||{}),E;if(t.username!=null||t.password!=null){let ye=t.username??"",Ht=t.password??"";E=`${ye}:${Ht}`}let w=t.path;g&&(w+=`?${g}`),t.fragment&&(w+=`#${t.fragment}`);let C=t.hostname??"";C[0]==="["&&C.endsWith("]")?C=t.hostname.slice(1,-1):C=t.hostname;let ie={headers:t.headers,host:C,method:t.method,path:w,port:t.port,agent:h,auth:E},Me=(u?Y2:J2)(ie,ye=>{let Ht=new Jt({statusCode:ye.statusCode||-1,reason:ye.statusMessage,headers:qS(ye.headers),body:ye});l({response:Ht})});if(Me.on("error",ye=>{zS.includes(ye.code)?p(Object.assign(ye,{name:"TimeoutError"})):p(ye)}),r){let ye=()=>{Me.destroy();let Ht=new Error("Request aborted");Ht.name="AbortError",p(Ht)};if(typeof r.addEventListener=="function"){let Ht=r;Ht.addEventListener("abort",ye,{once:!0}),Me.once("close",()=>Ht.removeEventListener("abort",ye))}else r.onabort=ye}let je=o??i.requestTimeout;c.push(XS(Me,p,i.connectionTimeout)),c.push(ZS(Me,p,je,i.throwOnRequestTimeout,i.logger??console)),c.push(nE(Me,p,i.socketTimeout));let Dn=ie.agent;typeof Dn=="object"&&"keepAlive"in Dn&&c.push(tE(Me,{keepAlive:Dn.keepAlive,keepAliveMsecs:Dn.keepAliveMsecs})),a=aE(Me,t,je,this.externalAgent).catch(ye=>(c.forEach(Pe.clearTimeout),s(ye)))})}updateHttpClientConfig(t,r){this.config=void 0,this.configProvider=this.configProvider.then(o=>({...o,[t]:r}))}httpHandlerConfigs(){return this.config??{}}}});var lE=d(()=>{});import{Writable as X2}from"stream";var sd,pE=d(()=>{sd=class extends X2{bufferedBytes=[];_write(t,r,o){this.bufferedBytes.push(t),o()}}});async function Z2(e){let t=[],r=e.getReader(),o=!1,n=0;for(;!o;){let{done:a,value:c}=await r.read();c&&(t.push(c),n+=c.length),o=a}let s=new Uint8Array(n),i=0;for(let a of t)s.set(a,i),i+=a.length;return s}var xt,Q2,uE=d(()=>{pE();xt=e=>Q2(e)?Z2(e):new Promise((t,r)=>{let o=new sd;e.pipe(o),e.on("error",n=>{o.end(),r(n)}),o.on("error",r),o.on("finish",function(){let n=new Uint8Array(Buffer.concat(this.bufferedBytes));t(n)})}),Q2=e=>typeof ReadableStream=="function"&&e instanceof ReadableStream});var ko=d(()=>{dE();lE();uE()});var fE=d(()=>{});async function eM(e){let t=await rM(e),r=Ie(t);return new Uint8Array(r)}async function tM(e){let t=[],r=e.getReader(),o=!1,n=0;for(;!o;){let{done:a,value:c}=await r.read();c&&(t.push(c),n+=c.length),o=a}let s=new Uint8Array(n),i=0;for(let a of t)s.set(a,i),i+=a.length;return s}function rM(e){return new Promise((t,r)=>{let o=new FileReader;o.onloadend=()=>{if(o.readyState!==2)return r(new Error("Reader aborted too early"));let n=o.result??"",s=n.indexOf(","),i=s>-1?s+1:n.length;t(n.substring(i))},o.onabort=()=>r(new Error("Read aborted")),o.onerror=()=>r(o.error),o.readAsDataURL(e)})}var mE,hE=d(()=>{et();mE=async e=>typeof Blob=="function"&&e instanceof Blob||e.constructor?.name==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await e.arrayBuffer()):eM(e):tM(e)});var gE=d(()=>{fE();hE()});function yE(e){if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2){let o=e.slice(r,r+2).toLowerCase();if(o in Of)t[r/2]=Of[o];else throw new Error(`Cannot decode unrecognized sequence ${o} as hexadecimal`)}return t}function yt(e){let t="";for(let r=0;r<e.byteLength;r++)t+=xE[e[r]];return t}var xE,Of,os=d(()=>{xE={},Of={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),xE[e]=t,Of[t]=e}});var SE,_E,EE,bE=d(()=>{gE();et();os();Ae();Pf();SE="The stream has already been transformed.",_E=e=>{if(!EE(e)&&!Af(e)){let n=e?.__proto__?.constructor?.name||e;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${n}`)}let t=!1,r=async()=>{if(t)throw new Error(SE);return t=!0,await mE(e)},o=n=>{if(typeof n.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return n.stream()};return Object.assign(e,{transformToByteArray:r,transformToString:async n=>{let s=await r();if(n==="base64")return Ee(s);if(n==="hex")return yt(s);if(n===void 0||n==="utf8"||n==="utf-8")return Se(s);if(typeof TextDecoder=="function")return new TextDecoder(n).decode(s);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(t)throw new Error(SE);if(t=!0,EE(e))return o(e);if(Af(e))return e;throw new Error(`Cannot transform payload to web stream, got ${e}`)}})},EE=e=>typeof Blob=="function"&&e instanceof Blob});import{Readable as kf}from"stream";var wE,id,RE=d(()=>{ko();ts();bE();wE="The stream has already been transformed.",id=e=>{if(!(e instanceof kf))try{return _E(e)}catch{let n=e?.__proto__?.constructor?.name||e;throw new Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${n}`)}let t=!1,r=async()=>{if(t)throw new Error(wE);return t=!0,await xt(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async o=>{let n=await r();return o===void 0||Buffer.isEncoding(o)?Oo(n.buffer,n.byteOffset,n.byteLength).toString(o):new TextDecoder(o).decode(n)},transformToWebStream:()=>{if(t)throw new Error(wE);if(e.readableFlowing!==null)throw new Error("The stream has been consumed by other callbacks.");if(typeof kf.toWeb!="function")throw new Error("Readable.toWeb() is not supported. Please ensure a polyfill is available.");return t=!0,kf.toWeb(e)}})}});var IE=d(()=>{});var ad=d(()=>{MS();LS();US();FS();BS();HS();RE();IE();Pf()});var St,cd=d(()=>{ad();St=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return qs.mutate(e);if(!e)return qs.mutate(new Uint8Array);let r=t.streamCollector(e);return qs.mutate(await r)}});function Js(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}var $f=d(()=>{});var sn,Mf=d(()=>{sn=e=>typeof e=="function"?e():e});var dd,ld=d(()=>{dd=(e,t,r,o,n)=>({name:t,namespace:e,traits:r,input:o,output:n})});var TE,Lf,vE=d(()=>{we();Ze();ld();TE=e=>(t,r)=>async o=>{let{response:n}=await t(o),{operationSchema:s}=ve(r),[,i,a,c,l,p]=s??[];try{let u=await e.protocol.deserializeResponse(dd(i,a,c,l,p),{...e,...r},n);return{response:n,output:u}}catch(u){if(Object.defineProperty(u,"$response",{value:n,enumerable:!1,writable:!1,configurable:!1}),!("$metadata"in u)){let f="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{u.message+=`
  `+f}catch{!r.logger||r.logger?.constructor?.name==="NoOpLogger"?console.warn(f):r.logger?.warn?.(f)}typeof u.$responseBodyText<"u"&&u.$response&&(u.$response.body=u.$responseBodyText);try{if(Jt.isInstance(n)){let{headers:m={}}=n,h=Object.entries(m);u.$metadata={httpStatusCode:n.statusCode,requestId:Lf(/^x-[\w-]+-request-?id$/,h),extendedRequestId:Lf(/^x-[\w-]+-id-2$/,h),cfId:Lf(/^x-[\w-]+-cf-id$/,h)}}}catch{}}throw u}},Lf=(e,t)=>(t.find(([r])=>r.match(e))||[void 0,void 0])[1]});var CE,AE=d(()=>{Ze();ld();CE=e=>(t,r)=>async o=>{let{operationSchema:n}=ve(r),[,s,i,a,c,l]=n??[],p=r.endpointV2?.url&&e.urlParser?async()=>e.urlParser(r.endpointV2.url):e.endpoint,u=await e.protocol.serializeRequest(dd(s,i,a,c,l),o.input,{...e,...r,endpoint:p});return t({...o,request:u})}});function tr(e){return{applyToStack:t=>{t.add(CE(e),nM),t.add(TE(e),oM),e.protocol.setSerdeContext(e)}}}var oM,nM,PE=d(()=>{vE();AE();oM={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},nM={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0}});var rr,ns=d(()=>{rr=class{name;namespace;traits;static assign(t,r){return Object.assign(t,r)}static[Symbol.hasInstance](t){let r=this.prototype.isPrototypeOf(t);return!r&&typeof t=="object"&&t!==null?t.symbol===this.symbol:r}getName(){return this.namespace+"#"+this.name}}});var DE,NE=d(()=>{ns();DE=class e extends rr{static symbol=Symbol.for("@smithy/lis");name;traits;valueSchema;symbol=e.symbol}});var OE,kE=d(()=>{ns();OE=class e extends rr{static symbol=Symbol.for("@smithy/map");name;traits;keySchema;valueSchema;symbol=e.symbol}});var $E,ME=d(()=>{ns();$E=class e extends rr{static symbol=Symbol.for("@smithy/ope");name;traits;input;output;symbol=e.symbol}});var pd,Uf=d(()=>{ns();pd=class e extends rr{static symbol=Symbol.for("@smithy/str");name;traits;memberNames;memberList;symbol=e.symbol}});var LE,UE=d(()=>{Uf();LE=class e extends pd{static symbol=Symbol.for("@smithy/err");ctor;symbol=e.symbol}});function $o(e){if(typeof e=="object")return e;e=e|0;let t={},r=0;for(let o of["httpLabel","idempotent","idempotencyToken","sensitive","httpPayload","httpResponseCode","httpQueryParams"])(e>>r++&1)===1&&(t[o]=1);return t}var Ff=d(()=>{});function oa(e,t){if(e instanceof M)return Object.assign(e,{memberName:t,_isMemberSchema:!0});let r=M;return new r(e,t)}var M,Bf,sM,FE=d(()=>{Mf();Ff();M=class e{ref;memberName;static symbol=Symbol.for("@smithy/nor");symbol=e.symbol;name;schema;_isMemberSchema;traits;memberTraits;normalizedTraits;constructor(t,r){this.ref=t,this.memberName=r;let o=[],n=t,s=t;for(this._isMemberSchema=!1;Bf(n);)o.push(n[1]),n=n[0],s=sn(n),this._isMemberSchema=!0;if(o.length>0){this.memberTraits={};for(let i=o.length-1;i>=0;--i){let a=o[i];Object.assign(this.memberTraits,$o(a))}}else this.memberTraits=0;if(s instanceof e){let i=this.memberTraits;Object.assign(this,s),this.memberTraits=Object.assign({},i,s.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.memberName=r??s.memberName;return}if(this.schema=sn(s),sM(this.schema)?(this.name=`${this.schema[1]}#${this.schema[2]}`,this.traits=this.schema[3]):(this.name=this.memberName??String(s),this.traits=0),this._isMemberSchema&&!r)throw new Error(`@smithy/core/schema - NormalizedSchema member init ${this.getName(!0)} missing member name.`)}static[Symbol.hasInstance](t){let r=this.prototype.isPrototypeOf(t);return!r&&typeof t=="object"&&t!==null?t.symbol===this.symbol:r}static of(t){let r=sn(t);if(r instanceof e)return r;if(Bf(r)){let[o,n]=r;if(o instanceof e)return Object.assign(o.getMergedTraits(),$o(n)),o;throw new Error(`@smithy/core/schema - may not init unwrapped member schema=${JSON.stringify(t,null,2)}.`)}return new e(r)}getSchema(){let t=this.schema;return t[0]===0?t[4]:t}getName(t=!1){let{name:r}=this;return!t&&r&&r.includes("#")?r.split("#")[1]:r||void 0}getMemberName(){return this.memberName}isMemberSchema(){return this._isMemberSchema}isListSchema(){let t=this.getSchema();return typeof t=="number"?t>=64&&t<128:t[0]===1}isMapSchema(){let t=this.getSchema();return typeof t=="number"?t>=128&&t<=255:t[0]===2}isStructSchema(){let r=this.getSchema()[0];return r===3||r===-3||r===4}isUnionSchema(){return this.getSchema()[0]===4}isBlobSchema(){let t=this.getSchema();return t===21||t===42}isTimestampSchema(){let t=this.getSchema();return typeof t=="number"&&t>=4&&t<=7}isUnitSchema(){return this.getSchema()==="unit"}isDocumentSchema(){return this.getSchema()===15}isStringSchema(){return this.getSchema()===0}isBooleanSchema(){return this.getSchema()===2}isNumericSchema(){return this.getSchema()===1}isBigIntegerSchema(){return this.getSchema()===17}isBigDecimalSchema(){return this.getSchema()===19}isStreaming(){let{streaming:t}=this.getMergedTraits();return!!t||this.getSchema()===42}isIdempotencyToken(){let t=s=>(s&4)===4||!!s?.idempotencyToken,{normalizedTraits:r,traits:o,memberTraits:n}=this;return t(r)||t(o)||t(n)}getMergedTraits(){return this.normalizedTraits??(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()})}getMemberTraits(){return $o(this.memberTraits)}getOwnTraits(){return $o(this.traits)}getKeySchema(){let[t,r]=[this.isDocumentSchema(),this.isMapSchema()];if(!t&&!r)throw new Error(`@smithy/core/schema - cannot get key for non-map: ${this.getName(!0)}`);let o=this.getSchema(),n=t?15:o[4]??0;return oa([n,0],"key")}getValueSchema(){let t=this.getSchema(),[r,o,n]=[this.isDocumentSchema(),this.isMapSchema(),this.isListSchema()],s=typeof t=="number"?63&t:t&&typeof t=="object"&&(o||n)?t[3+t[0]]:r?15:void 0;if(s!=null)return oa([s,0],o?"value":"member");throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no value member.`)}getMemberSchema(t){let r=this.getSchema();if(this.isStructSchema()&&r[4].includes(t)){let o=r[4].indexOf(t),n=r[5][o];return oa(Bf(n)?n:[n,0],t)}if(this.isDocumentSchema())return oa([15,0],t);throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no no member=${t}.`)}getMemberSchemas(){let t={};try{for(let[r,o]of this.structIterator())t[r]=o}catch{}return t}getEventStreamMember(){if(this.isStructSchema()){for(let[t,r]of this.structIterator())if(r.isStreaming()&&r.isStructSchema())return t}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw new Error("@smithy/core/schema - cannot iterate non-struct schema.");let t=this.getSchema();for(let r=0;r<t[4].length;++r)yield[t[4][r],oa([t[5][r],0],t[4][r])]}};Bf=e=>Array.isArray(e)&&e.length===2,sM=e=>Array.isArray(e)&&e.length>=5});var BE,HE=d(()=>{ns();BE=class e extends rr{static symbol=Symbol.for("@smithy/sim");name;schemaRef;traits;symbol=e.symbol}});var VE=d(()=>{});var S,GE=d(()=>{S=class e{namespace;schemas;exceptions;static registries=new Map;constructor(t,r=new Map,o=new Map){this.namespace=t,this.schemas=r,this.exceptions=o}static for(t){return e.registries.has(t)||e.registries.set(t,new e(t)),e.registries.get(t)}register(t,r){let o=this.normalizeShapeId(t);e.for(o.split("#")[0]).schemas.set(o,r)}getSchema(t){let r=this.normalizeShapeId(t);if(!this.schemas.has(r))throw new Error(`@smithy/core/schema - schema not found for ${r}`);return this.schemas.get(r)}registerError(t,r){let o=t,n=e.for(o[1]);n.schemas.set(o[1]+"#"+o[2],o),n.exceptions.set(o,r)}getErrorCtor(t){let r=t;return e.for(r[1]).exceptions.get(r)}getBaseException(){for(let t of this.exceptions.keys())if(Array.isArray(t)){let[,r,o]=t,n=r+"#"+o;if(n.startsWith("smithy.ts.sdk.synthetic.")&&n.endsWith("ServiceException"))return t}}find(t){return[...this.schemas.values()].find(t)}clear(){this.schemas.clear(),this.exceptions.clear()}normalizeShapeId(t){return t.includes("#")?t:this.namespace+"#"+t}}});var ae=d(()=>{Mf();PE();NE();kE();ME();ld();UE();FE();ns();HE();Uf();VE();Ff();GE()});var jE=d(()=>{});var Hf,iM,WE,aM,zE,KE,qE,cM,JE,YE,dM,ud,Ys,XE,lM,pM,Vf=d(()=>{Hf=e=>{if(e!=null){if(typeof e=="string"){let t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&pM.warn(lM(`Expected number but observed string: ${e}`)),t}if(typeof e=="number")return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}},iM=Math.ceil(34028234663852886e22),WE=e=>{let t=Hf(e);if(t!==void 0&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>iM)throw new TypeError(`Expected 32-bit float, got ${e}`);return t},aM=e=>{if(e!=null){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}},zE=e=>qE(e,16),KE=e=>qE(e,8),qE=(e,t)=>{let r=aM(e);if(r!==void 0&&cM(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},cM=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},JE=e=>Hf(typeof e=="string"?ud(e):e),YE=e=>WE(typeof e=="string"?ud(e):e),dM=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,ud=e=>{let t=e.match(dM);if(t===null||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)},Ys=e=>zE(typeof e=="string"?ud(e):e),XE=e=>KE(typeof e=="string"?ud(e):e),lM=e=>String(new TypeError(e).stack||e).split(`
`).slice(0,5).filter(t=>!t.includes("stackTraceWarning")).join(`
`),pM={warn:console.warn}});function Qs(e){let t=e.getUTCFullYear(),r=e.getUTCMonth(),o=e.getUTCDay(),n=e.getUTCDate(),s=e.getUTCHours(),i=e.getUTCMinutes(),a=e.getUTCSeconds(),c=n<10?`0${n}`:`${n}`,l=s<10?`0${s}`:`${s}`,p=i<10?`0${i}`:`${i}`,u=a<10?`0${a}`:`${a}`;return`${uM[o]}, ${c} ${jf[r]} ${t} ${l}:${p}:${u} GMT`}var uM,jf,fM,QE,mM,ZE,hM,gM,xM,e_,t_,na,yM,SM,EM,Gf,_M,bM,wM,io,RM,IM,Xs,r_=d(()=>{Vf();uM=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],jf=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];fM=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/),QE=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");let t=fM.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");let[r,o,n,s,i,a,c,l]=t,p=Ys(Xs(o)),u=io(n,"month",1,12),f=io(s,"day",1,31);return na(p,u,f,{hours:i,minutes:a,seconds:c,fractionalMilliseconds:l})},mM=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),ZE=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");let t=mM.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");let[r,o,n,s,i,a,c,l,p]=t,u=Ys(Xs(o)),f=io(n,"month",1,12),m=io(s,"day",1,31),h=na(u,f,m,{hours:i,minutes:a,seconds:c,fractionalMilliseconds:l});return p.toUpperCase()!="Z"&&h.setTime(h.getTime()-IM(p)),h},hM=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),gM=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),xM=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),e_=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let t=hM.exec(e);if(t){let[r,o,n,s,i,a,c,l]=t;return na(Ys(Xs(s)),Gf(n),io(o,"day",1,31),{hours:i,minutes:a,seconds:c,fractionalMilliseconds:l})}if(t=gM.exec(e),t){let[r,o,n,s,i,a,c,l]=t;return EM(na(yM(s),Gf(n),io(o,"day",1,31),{hours:i,minutes:a,seconds:c,fractionalMilliseconds:l}))}if(t=xM.exec(e),t){let[r,o,n,s,i,a,c,l]=t;return na(Ys(Xs(l)),Gf(o),io(n.trimLeft(),"day",1,31),{hours:s,minutes:i,seconds:a,fractionalMilliseconds:c})}throw new TypeError("Invalid RFC-7231 date-time value")},t_=e=>{if(e==null)return;let t;if(typeof e=="number")t=e;else if(typeof e=="string")t=JE(e);else if(typeof e=="object"&&e.tag===1)t=e.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(t)||t===1/0||t===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(t*1e3))},na=(e,t,r,o)=>{let n=t-1;return bM(e,n,r),new Date(Date.UTC(e,n,r,io(o.hours,"hour",0,23),io(o.minutes,"minute",0,59),io(o.seconds,"seconds",0,60),RM(o.fractionalMilliseconds)))},yM=e=>{let t=new Date().getUTCFullYear(),r=Math.floor(t/100)*100+Ys(Xs(e));return r<t?r+100:r},SM=50*365*24*60*60*1e3,EM=e=>e.getTime()-new Date().getTime()>SM?new Date(Date.UTC(e.getUTCFullYear()-100,e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())):e,Gf=e=>{let t=jf.indexOf(e);if(t<0)throw new TypeError(`Invalid month: ${e}`);return t+1},_M=[31,28,31,30,31,30,31,31,30,31,30,31],bM=(e,t,r)=>{let o=_M[t];if(t===1&&wM(e)&&(o=29),r>o)throw new TypeError(`Invalid day for ${jf[t]} in ${e}: ${r}`)},wM=e=>e%4===0&&(e%100!==0||e%400===0),io=(e,t,r,o)=>{let n=XE(Xs(e));if(n<r||n>o)throw new TypeError(`${t} must be between ${r} and ${o}, inclusive`);return n},RM=e=>e==null?0:YE("0."+e)*1e3,IM=e=>{let t=e[0],r=1;if(t=="+")r=1;else if(t=="-")r=-1;else throw new TypeError(`Offset direction, ${t}, must be "+" or "-"`);let o=Number(e.substring(1,3)),n=Number(e.substring(4,6));return r*(o*60+n)*60*1e3},Xs=e=>{let t=0;for(;t<e.length-1&&e.charAt(t)==="0";)t++;return t===0?e:e.slice(t)}});import o_ from"crypto";var Wf,n_=d(()=>{Wf=o_.randomUUID.bind(o_)});var rt,Mo,s_=d(()=>{n_();rt=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),Mo=()=>{if(Wf)return Wf();let e=new Uint8Array(16);return crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128,rt[e[0]]+rt[e[1]]+rt[e[2]]+rt[e[3]]+"-"+rt[e[4]]+rt[e[5]]+"-"+rt[e[6]]+rt[e[7]]+"-"+rt[e[8]]+rt[e[9]]+"-"+rt[e[10]]+rt[e[11]]+rt[e[12]]+rt[e[13]]+rt[e[14]]+rt[e[15]]}});var zf=d(()=>{s_()});var i_=d(()=>{zf()});var Et,a_=d(()=>{Et=function(t){return Object.assign(new String(t),{deserializeJSON(){return JSON.parse(String(t))},toString(){return String(t)},toJSON(){return String(t)}})};Et.from=e=>e&&typeof e=="object"&&(e instanceof Et||"deserializeJSON"in e)?e:typeof e=="string"||Object.getPrototypeOf(e)===String.prototype?Et(String(e)):Et(JSON.stringify(e));Et.fromObject=Et.from});function c_(e){return(e.includes(",")||e.includes('"'))&&(e=`"${e.replace(/"/g,'\\"')}"`),e}var d_=d(()=>{});function Lo(e,t,r){let o=Number(e);if(o<t||o>r)throw new Error(`Value ${o} out of range [${t}, ${r}]`)}var Kf,qf,Jf,l_,p_,TM,vM,CM,AM,PM,u_,f_,m_,h_=d(()=>{Kf="(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun)(?:[ne|u?r]?s?day)?",qf="(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)",Jf="(\\d?\\d):(\\d{2}):(\\d{2})(?:\\.(\\d+))?",l_="(\\d?\\d)",p_="(\\d{4})",TM=new RegExp(/^(\d{4})-(\d\d)-(\d\d)[tT](\d\d):(\d\d):(\d\d)(\.(\d+))?(([-+]\d\d:\d\d)|[zZ])$/),vM=new RegExp(`^${Kf}, ${l_} ${qf} ${p_} ${Jf} GMT$`),CM=new RegExp(`^${Kf}, ${l_}-${qf}-(\\d\\d) ${Jf} GMT$`),AM=new RegExp(`^${Kf} ${qf} ( [1-9]|\\d\\d) ${Jf} ${p_}$`),PM=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u_=e=>{if(e==null)return;let t=NaN;if(typeof e=="number")t=e;else if(typeof e=="string"){if(!/^-?\d*\.?\d+$/.test(e))throw new TypeError("parseEpochTimestamp - numeric string invalid.");t=Number.parseFloat(e)}else typeof e=="object"&&e.tag===1&&(t=e.value);if(isNaN(t)||Math.abs(t)===1/0)throw new TypeError("Epoch timestamps must be valid finite numbers.");return new Date(Math.round(t*1e3))},f_=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC3339 timestamps must be strings");let t=TM.exec(e);if(!t)throw new TypeError(`Invalid RFC3339 timestamp format ${e}`);let[,r,o,n,s,i,a,,c,l]=t;Lo(o,1,12),Lo(n,1,31),Lo(s,0,23),Lo(i,0,59),Lo(a,0,60);let p=new Date(Date.UTC(Number(r),Number(o)-1,Number(n),Number(s),Number(i),Number(a),Number(c)?Math.round(parseFloat(`0.${c}`)*1e3):0));if(p.setUTCFullYear(Number(r)),l.toUpperCase()!="Z"){let[,u,f,m]=/([+-])(\d\d):(\d\d)/.exec(l)||[void 0,"+",0,0],h=u==="-"?1:-1;p.setTime(p.getTime()+h*(Number(f)*60*60*1e3+Number(m)*60*1e3))}return p},m_=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC7231 timestamps must be strings.");let t,r,o,n,s,i,a,c;if((c=vM.exec(e))?[,t,r,o,n,s,i,a]=c:(c=CM.exec(e))?([,t,r,o,n,s,i,a]=c,o=(Number(o)+1900).toString()):(c=AM.exec(e))&&([,r,t,n,s,i,a,o]=c),o&&i){let l=Date.UTC(Number(o),PM.indexOf(r),Number(t),Number(n),Number(s),Number(i),a?Math.round(parseFloat(`0.${a}`)*1e3):0);Lo(t,1,31),Lo(n,0,23),Lo(s,0,59),Lo(i,0,60);let p=new Date(l);return p.setUTCFullYear(Number(o)),p}throw new TypeError(`Invalid RFC7231 date-time value ${e}.`)}});function g_(e,t,r){if(r<=0||!Number.isInteger(r))throw new Error("Invalid number of delimiters ("+r+") for splitEvery.");let o=e.split(t);if(r===1)return o;let n=[],s="";for(let i=0;i<o.length;i++)s===""?s=o[i]:s+=t+o[i],(i+1)%r===0&&(n.push(s),s="");return s!==""&&n.push(s),n}var x_=d(()=>{});var fd,y_=d(()=>{fd=e=>{let t=e.length,r=[],o=!1,n,s=0;for(let i=0;i<t;++i){let a=e[i];switch(a){case'"':n!=="\\"&&(o=!o);break;case",":o||(r.push(e.slice(s,i)),s=i+1);break;default:}n=a}return r.push(e.slice(s)),r.map(i=>{i=i.trim();let a=i.length;return a<2?i:(i[0]==='"'&&i[a-1]==='"'&&(i=i.slice(1,a-1)),i.replace(/\\"/g,'"'))})}});var S_,He,E_=d(()=>{S_=/^-?\d*(\.\d+)?$/,He=class e{string;type;constructor(t,r){if(this.string=t,this.type=r,!S_.test(t))throw new Error('@smithy/core/serde - NumericValue must only contain [0-9], at most one decimal point ".", and an optional negation prefix "-".')}toString(){return this.string}static[Symbol.hasInstance](t){if(!t||typeof t!="object")return!1;let r=t;return e.prototype.isPrototypeOf(t)||r.type==="bigDecimal"&&S_.test(r.string)}}});var ao=d(()=>{jE();r_();i_();a_();Vf();d_();h_();x_();y_();E_()});var co,Zs=d(()=>{co=class{serdeContext;setSerdeContext(t){this.serdeContext=t}}});var Yf,__=d(()=>{Ae();Yf=class{marshaller;serializer;deserializer;serdeContext;defaultContentType;constructor({marshaller:t,serializer:r,deserializer:o,serdeContext:n,defaultContentType:s}){this.marshaller=t,this.serializer=r,this.deserializer=o,this.serdeContext=n,this.defaultContentType=s}async serializeEventStream({eventStream:t,requestSchema:r,initialRequest:o}){let n=this.marshaller,s=r.getEventStreamMember(),i=r.getMemberSchema(s),a=this.serializer,c=this.defaultContentType,l=Symbol("initialRequestMarker"),p={async*[Symbol.asyncIterator](){if(o){let u={":event-type":{type:"string",value:"initial-request"},":message-type":{type:"string",value:"event"},":content-type":{type:"string",value:c}};a.write(r,o);let f=a.flush();yield{[l]:!0,headers:u,body:f}}for await(let u of t)yield u}};return n.serialize(p,u=>{if(u[l])return{headers:u.headers,body:u.body};let f=Object.keys(u).find(C=>C!=="__type")??"",{additionalHeaders:m,body:h,eventType:g,explicitPayloadContentType:E}=this.writeEventBody(f,i,u);return{headers:{":event-type":{type:"string",value:g},":message-type":{type:"string",value:"event"},":content-type":{type:"string",value:E??c},...m},body:h}})}async deserializeEventStream({response:t,responseSchema:r,initialResponseContainer:o}){let n=this.marshaller,s=r.getEventStreamMember(),a=r.getMemberSchema(s).getMemberSchemas(),c=Symbol("initialResponseMarker"),l=n.deserialize(t.body,async f=>{let m=Object.keys(f).find(g=>g!=="__type")??"",h=f[m].body;if(m==="initial-response"){let g=await this.deserializer.read(r,h);return delete g[s],{[c]:!0,...g}}else if(m in a){let g=a[m];if(g.isStructSchema()){let E={},w=!1;for(let[C,ie]of g.structIterator()){let{eventHeader:he,eventPayload:Me}=ie.getMergedTraits();if(w=w||!!(he||Me),Me)ie.isBlobSchema()?E[C]=h:ie.isStringSchema()?E[C]=(this.serdeContext?.utf8Encoder??Se)(h):ie.isStructSchema()&&(E[C]=await this.deserializer.read(ie,h));else if(he){let je=f[m].headers[C]?.value;je!=null&&(ie.isNumericSchema()?je&&typeof je=="object"&&"bytes"in je?E[C]=BigInt(je.toString()):E[C]=Number(je):E[C]=je)}}if(w)return{[m]:E}}return{[m]:await this.deserializer.read(g,h)}}else return{$unknown:f}}),p=l[Symbol.asyncIterator](),u=await p.next();if(u.done)return l;if(u.value?.[c]){if(!r)throw new Error("@smithy::core/protocols - initial-response event encountered in event stream but no response schema given.");for(let[f,m]of Object.entries(u.value))o[f]=m}return{async*[Symbol.asyncIterator](){for(u?.value?.[c]||(yield u.value);;){let{done:f,value:m}=await p.next();if(f)break;yield m}}}}writeEventBody(t,r,o){let n=this.serializer,s=t,i=null,a,c=r.getSchema()[4].includes(t),l={};if(c){let f=r.getMemberSchema(t);if(f.isStructSchema()){for(let[m,h]of f.structIterator()){let{eventHeader:g,eventPayload:E}=h.getMergedTraits();if(E)i=m;else if(g){let w=o[t][m],C="binary";h.isNumericSchema()?(-2)**31<=w&&w<=2**31-1?C="integer":C="long":h.isTimestampSchema()?C="timestamp":h.isStringSchema()?C="string":h.isBooleanSchema()&&(C="boolean"),w!=null&&(l[m]={type:C,value:w},delete o[t][m])}}if(i!==null){let m=f.getMemberSchema(i);m.isBlobSchema()?a="application/octet-stream":m.isStringSchema()&&(a="text/plain"),n.write(m,o[t][i])}else n.write(f,o[t])}else throw new Error("@smithy/core/event-streams - non-struct member not supported in event stream union.")}else{let[f,m]=o[t];s=f,n.write(15,m)}let p=n.flush();return{body:typeof p=="string"?(this.serdeContext?.utf8Decoder??_e)(p):p,eventType:s,explicitPayloadContentType:a,additionalHeaders:l}}}});var b_={};Nt(b_,{EventStreamSerde:()=>Yf});var w_=d(()=>{__()});var ei,md=d(()=>{ae();we();Zs();ei=class extends co{options;constructor(t){super(),this.options=t}getRequestType(){return le}getResponseType(){return Jt}setSerdeContext(t){this.serdeContext=t,this.serializer.setSerdeContext(t),this.deserializer.setSerdeContext(t),this.getPayloadCodec()&&this.getPayloadCodec().setSerdeContext(t)}updateServiceEndpoint(t,r){if("url"in r){t.protocol=r.url.protocol,t.hostname=r.url.hostname,t.port=r.url.port?Number(r.url.port):void 0,t.path=r.url.pathname,t.fragment=r.url.hash||void 0,t.username=r.url.username||void 0,t.password=r.url.password||void 0,t.query||(t.query={});for(let[o,n]of r.url.searchParams.entries())t.query[o]=n;return t}else return t.protocol=r.protocol,t.hostname=r.hostname,t.port=r.port?Number(r.port):void 0,t.path=r.path,t.query={...r.query},t}setHostPrefix(t,r,o){let n=M.of(r.input),s=$o(r.traits??{});if(s.endpoint){let i=s.endpoint?.[0];if(typeof i=="string"){let a=[...n.structIterator()].filter(([,c])=>c.getMergedTraits().hostLabel);for(let[c]of a){let l=o[c];if(typeof l!="string")throw new Error(`@smithy/core/schema - ${c} in input must be a string as hostLabel.`);i=i.replace(`{${c}}`,l)}t.hostname=i+t.hostname}}}deserializeMetadata(t){return{httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}}async serializeEventStream({eventStream:t,requestSchema:r,initialRequest:o}){return(await this.loadEventStreamCapability()).serializeEventStream({eventStream:t,requestSchema:r,initialRequest:o})}async deserializeEventStream({response:t,responseSchema:r,initialResponseContainer:o}){return(await this.loadEventStreamCapability()).deserializeEventStream({response:t,responseSchema:r,initialResponseContainer:o})}async loadEventStreamCapability(){let{EventStreamSerde:t}=await Promise.resolve().then(()=>(w_(),b_));return new t({marshaller:this.getEventStreamMarshaller(),serializer:this.serializer,deserializer:this.deserializer,serdeContext:this.serdeContext,defaultContentType:this.getDefaultContentType()})}getDefaultContentType(){throw new Error(`@smithy/core/protocols - ${this.constructor.name} getDefaultContentType() implementation missing.`)}async deserializeHttpMessage(t,r,o,n,s){return[]}getEventStreamMarshaller(){let t=this.serdeContext;if(!t.eventStreamMarshaller)throw new Error("@smithy/core - HttpProtocol: eventStreamMarshaller missing in serdeContext.");return t.eventStreamMarshaller}}});var hd,R_=d(()=>{ae();ao();we();ad();cd();$f();md();hd=class extends ei{async serializeRequest(t,r,o){let n={...r??{}},s=this.serializer,i={},a={},c=await o.endpoint(),l=M.of(t?.input),p=l.getSchema(),u=!1,f,m=new le({protocol:"",hostname:"",port:void 0,path:"",fragment:void 0,query:i,headers:a,body:void 0});if(c){this.updateServiceEndpoint(m,c),this.setHostPrefix(m,t,n);let h=$o(t.traits);if(h.http){m.method=h.http[0];let[g,E]=h.http[1].split("?");m.path=="/"?m.path=g:m.path+=g;let w=new URLSearchParams(E??"");Object.assign(i,Object.fromEntries(w))}}for(let[h,g]of l.structIterator()){let E=g.getMergedTraits()??{},w=n[h];if(!(w==null&&!g.isIdempotencyToken()))if(E.httpPayload)g.isStreaming()?g.isStructSchema()?n[h]&&(f=await this.serializeEventStream({eventStream:n[h],requestSchema:l})):f=w:(s.write(g,w),f=s.flush()),delete n[h];else if(E.httpLabel){s.write(g,w);let C=s.flush();m.path.includes(`{${h}+}`)?m.path=m.path.replace(`{${h}+}`,C.split("/").map(Js).join("/")):m.path.includes(`{${h}}`)&&(m.path=m.path.replace(`{${h}}`,Js(C))),delete n[h]}else if(E.httpHeader)s.write(g,w),a[E.httpHeader.toLowerCase()]=String(s.flush()),delete n[h];else if(typeof E.httpPrefixHeaders=="string"){for(let[C,ie]of Object.entries(w)){let he=E.httpPrefixHeaders+C;s.write([g.getValueSchema(),{httpHeader:he}],ie),a[he.toLowerCase()]=s.flush()}delete n[h]}else E.httpQuery||E.httpQueryParams?(this.serializeQuery(g,w,i),delete n[h]):u=!0}return u&&n&&(s.write(p,n),f=s.flush()),m.headers=a,m.query=i,m.body=f,m}serializeQuery(t,r,o){let n=this.serializer,s=t.getMergedTraits();if(s.httpQueryParams){for(let[i,a]of Object.entries(r))if(!(i in o)){let c=t.getValueSchema();Object.assign(c.getMergedTraits(),{...s,httpQuery:i,httpQueryParams:void 0}),this.serializeQuery(c,a,o)}return}if(t.isListSchema()){let i=!!t.getMergedTraits().sparse,a=[];for(let c of r){n.write([t.getValueSchema(),s],c);let l=n.flush();(i||l!==void 0)&&a.push(l)}o[s.httpQuery]=a}else n.write([t,s],r),o[s.httpQuery]=n.flush()}async deserializeResponse(t,r,o){let n=this.deserializer,s=M.of(t.output),i={};if(o.statusCode>=300){let c=await St(o.body,r);throw c.byteLength>0&&Object.assign(i,await n.read(15,c)),await this.handleError(t,r,o,i,this.deserializeMetadata(o)),new Error("@smithy/core/protocols - HTTP Protocol error handler failed to throw.")}for(let c in o.headers){let l=o.headers[c];delete o.headers[c],o.headers[c.toLowerCase()]=l}let a=await this.deserializeHttpMessage(s,r,o,i);if(a.length){let c=await St(o.body,r);if(c.byteLength>0){let l=await n.read(s,c);for(let p of a)i[p]=l[p]}}else a.discardResponseBody&&await St(o.body,r);return i.$metadata=this.deserializeMetadata(o),i}async deserializeHttpMessage(t,r,o,n,s){let i;n instanceof Set?i=s:i=n;let a=!0,c=this.deserializer,l=M.of(t),p=[];for(let[u,f]of l.structIterator()){let m=f.getMemberTraits();if(m.httpPayload){if(a=!1,f.isStreaming())f.isStructSchema()?i[u]=await this.deserializeEventStream({response:o,responseSchema:l}):i[u]=id(o.body);else if(o.body){let g=await St(o.body,r);g.byteLength>0&&(i[u]=await c.read(f,g))}}else if(m.httpHeader){let h=String(m.httpHeader).toLowerCase(),g=o.headers[h];if(g!=null)if(f.isListSchema()){let E=f.getValueSchema();E.getMergedTraits().httpHeader=h;let w;E.isTimestampSchema()&&E.getSchema()===4?w=g_(g,",",2):w=fd(g);let C=[];for(let ie of w)C.push(await c.read(E,ie.trim()));i[u]=C}else i[u]=await c.read(f,g)}else if(m.httpPrefixHeaders!==void 0){i[u]={};for(let[h,g]of Object.entries(o.headers))if(h.startsWith(m.httpPrefixHeaders)){let E=f.getValueSchema();E.getMergedTraits().httpHeader=h,i[u][h.slice(m.httpPrefixHeaders.length)]=await c.read(E,g)}}else m.httpResponseCode?i[u]=o.statusCode:p.push(u)}return p.discardResponseBody=a,p}}});var ti,I_=d(()=>{ae();we();cd();md();ti=class extends ei{async serializeRequest(t,r,o){let n=this.serializer,s={},i={},a=await o.endpoint(),c=M.of(t?.input),l=c.getSchema(),p,u=new le({protocol:"",hostname:"",port:void 0,path:"/",fragment:void 0,query:s,headers:i,body:void 0});a&&(this.updateServiceEndpoint(u,a),this.setHostPrefix(u,t,r));let f={...r};if(r){let m=c.getEventStreamMember();if(m){if(f[m]){let h={};for(let[g,E]of c.structIterator())g!==m&&f[g]&&(n.write(E,f[g]),h[g]=n.flush());p=await this.serializeEventStream({eventStream:f[m],requestSchema:c,initialRequest:h})}}else n.write(l,f),p=n.flush()}return u.headers=i,u.query=s,u.body=p,u.method="POST",u}async deserializeResponse(t,r,o){let n=this.deserializer,s=M.of(t.output),i={};if(o.statusCode>=300){let c=await St(o.body,r);throw c.byteLength>0&&Object.assign(i,await n.read(15,c)),await this.handleError(t,r,o,i,this.deserializeMetadata(o)),new Error("@smithy/core/protocols - RPC Protocol error handler failed to throw.")}for(let c in o.headers){let l=o.headers[c];delete o.headers[c],o.headers[c.toLowerCase()]=l}let a=s.getEventStreamMember();if(a)i[a]=await this.deserializeEventStream({response:o,responseSchema:s,initialResponseContainer:i});else{let c=await St(o.body,r);c.byteLength>0&&Object.assign(i,await n.read(s,c))}return i.$metadata=this.deserializeMetadata(o),i}}});var T_=d(()=>{});var v_=d(()=>{});function lo(e,t){if(t.timestampFormat.useTrait&&e.isTimestampSchema()&&(e.getSchema()===5||e.getSchema()===6||e.getSchema()===7))return e.getSchema();let{httpLabel:r,httpPrefixHeaders:o,httpHeader:n,httpQuery:s}=e.getMergedTraits();return(t.httpBindings?typeof o=="string"||n?6:s||r?5:void 0:void 0)??t.timestampFormat.default}var gd=d(()=>{});var ri,Xf=d(()=>{ae();ao();et();Ae();Zs();gd();ri=class extends co{settings;constructor(t){super(),this.settings=t}read(t,r){let o=M.of(t);if(o.isListSchema())return fd(r).map(n=>this.read(o.getValueSchema(),n));if(o.isBlobSchema())return(this.serdeContext?.base64Decoder??Ie)(r);if(o.isTimestampSchema())switch(lo(o,this.settings)){case 5:return f_(r);case 6:return m_(r);case 7:return u_(r);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",r),new Date(r)}if(o.isStringSchema()){let n=o.getMergedTraits().mediaType,s=r;if(n)return o.getMergedTraits().httpHeader&&(s=this.base64ToUtf8(s)),(n==="application/json"||n.endsWith("+json"))&&(s=Et.from(s)),s}return o.isNumericSchema()?Number(r):o.isBigIntegerSchema()?BigInt(r):o.isBigDecimalSchema()?new He(r,"bigDecimal"):o.isBooleanSchema()?String(r).toLowerCase()==="true":r}base64ToUtf8(t){return(this.serdeContext?.utf8Encoder??Se)((this.serdeContext?.base64Decoder??Ie)(t))}}});var xd,C_=d(()=>{ae();Ae();Zs();Xf();xd=class extends co{codecDeserializer;stringDeserializer;constructor(t,r){super(),this.codecDeserializer=t,this.stringDeserializer=new ri(r)}setSerdeContext(t){this.stringDeserializer.setSerdeContext(t),this.codecDeserializer.setSerdeContext(t),this.serdeContext=t}read(t,r){let o=M.of(t),n=o.getMergedTraits(),s=this.serdeContext?.utf8Encoder??Se;if(n.httpHeader||n.httpResponseCode)return this.stringDeserializer.read(o,s(r));if(n.httpPayload){if(o.isBlobSchema()){let i=this.serdeContext?.utf8Decoder??_e;return typeof r=="string"?i(r):r}else if(o.isStringSchema())return"byteLength"in r?s(r):r}return this.codecDeserializer.read(o,r)}}});var yd,Qf=d(()=>{ae();ao();et();Zs();gd();yd=class extends co{settings;stringBuffer="";constructor(t){super(),this.settings=t}write(t,r){let o=M.of(t);switch(typeof r){case"object":if(r===null){this.stringBuffer="null";return}if(o.isTimestampSchema()){if(!(r instanceof Date))throw new Error(`@smithy/core/protocols - received non-Date value ${r} when schema expected Date in ${o.getName(!0)}`);switch(lo(o,this.settings)){case 5:this.stringBuffer=r.toISOString().replace(".000Z","Z");break;case 6:this.stringBuffer=Qs(r);break;case 7:this.stringBuffer=String(r.getTime()/1e3);break;default:console.warn("Missing timestamp format, using epoch seconds",r),this.stringBuffer=String(r.getTime()/1e3)}return}if(o.isBlobSchema()&&"byteLength"in r){this.stringBuffer=(this.serdeContext?.base64Encoder??Ee)(r);return}if(o.isListSchema()&&Array.isArray(r)){let i="";for(let a of r){this.write([o.getValueSchema(),o.getMergedTraits()],a);let c=this.flush(),l=o.getValueSchema().isTimestampSchema()?c:c_(c);i!==""&&(i+=", "),i+=l}this.stringBuffer=i;return}this.stringBuffer=JSON.stringify(r,null,2);break;case"string":let n=o.getMergedTraits().mediaType,s=r;if(n&&((n==="application/json"||n.endsWith("+json"))&&(s=Et.from(s)),o.getMergedTraits().httpHeader)){this.stringBuffer=(this.serdeContext?.base64Encoder??Ee)(s.toString());return}this.stringBuffer=r;break;default:o.isIdempotencyToken()?this.stringBuffer=Mo():this.stringBuffer=String(r)}}flush(){let t=this.stringBuffer;return this.stringBuffer="",t}}});var Sd,A_=d(()=>{ae();Qf();Sd=class{codecSerializer;stringSerializer;buffer;constructor(t,r,o=new yd(r)){this.codecSerializer=t,this.stringSerializer=o}setSerdeContext(t){this.codecSerializer.setSerdeContext(t),this.stringSerializer.setSerdeContext(t)}write(t,r){let o=M.of(t),n=o.getMergedTraits();if(n.httpHeader||n.httpLabel||n.httpQuery){this.stringSerializer.write(o,r),this.buffer=this.stringSerializer.flush();return}return this.codecSerializer.write(o,r)}flush(){if(this.buffer!==void 0){let t=this.buffer;return this.buffer=void 0,t}return this.codecSerializer.flush()}}});var Uo=d(()=>{cd();$f();R_();md();I_();v_();T_();Xf();C_();A_();Qf();gd();Zs()});var P_=d(()=>{});function D_(e,t,r){e.__smithy_context?e.__smithy_context.features||(e.__smithy_context.features={}):e.__smithy_context={features:{}},e.__smithy_context.features[t]=r}var N_=d(()=>{});var _t,O_=d(()=>{_t=class{authSchemes=new Map;constructor(t){for(let[r,o]of Object.entries(t))o!==void 0&&this.authSchemes.set(r,o)}getIdentityProvider(t){return this.authSchemes.get(t)}}});var k_=d(()=>{});var $_=d(()=>{});var or,M_=d(()=>{or=class{async sign(t,r,o){return t}}});var L_=d(()=>{k_();$_();M_()});var DM,U_,Zf,F_,B_=d(()=>{DM=e=>function(r){return Zf(r)&&r.expiration.getTime()-Date.now()<e},U_=DM(3e5),Zf=e=>e.expiration!==void 0,F_=(e,t,r)=>{if(e===void 0)return;let o=typeof e!="function"?async()=>Promise.resolve(e):e,n,s,i,a=!1,c=async l=>{s||(s=o(l));try{n=await s,i=!0,a=!1}finally{s=void 0}return n};return t===void 0?async l=>((!i||l?.forceRefresh)&&(n=await c(l)),n):async l=>((!i||l?.forceRefresh)&&(n=await c(l)),a?n:r(n)?(t(n)&&await c(l),n):(a=!0,n))}});var H_=d(()=>{O_();L_();B_()});var Fe=d(()=>{xS();TS();AS();PS();DS();P_();N_();H_()});function NM(e){return e===void 0?!0:typeof e=="string"&&e.length<=50}function nr(e){let t=es(e.userAgentAppId??em),{customUserAgent:r}=e;return Object.assign(e,{customUserAgent:typeof r=="string"?[[r]]:r,userAgentAppId:async()=>{let o=await t();if(!NM(o)){let n=e.logger?.constructor?.name==="NoOpLogger"||!e.logger?console:e.logger;typeof o!="string"?n?.warn("userAgentAppId must be a string or undefined."):o.length>50&&n?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return o}})}var em,V_=d(()=>{Fe();em=void 0});var bt,G_=d(()=>{bt=class{capacity;data=new Map;parameters=[];constructor({size:t,params:r}){this.capacity=t??50,r&&(this.parameters=r)}get(t,r){let o=this.hash(t);if(o===!1)return r();if(!this.data.has(o)){if(this.data.size>this.capacity+10){let n=this.data.keys(),s=0;for(;;){let{value:i,done:a}=n.next();if(this.data.delete(i),a||++s>10)break}}this.data.set(o,r())}return this.data.get(o)}size(){return this.data.size}hash(t){let r="",{parameters:o}=this;if(o.length===0)return!1;for(let n of o){let s=String(t[n]??"");if(s.includes("|;"))return!1;r+=s+"|;"}return r}}});var OM,sa,tm=d(()=>{OM=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),sa=e=>OM.test(e)||e.startsWith("[")&&e.endsWith("]")});var kM,ss,rm=d(()=>{kM=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),ss=(e,t=!1)=>{if(!t)return kM.test(e);let r=e.split(".");for(let o of r)if(!ss(o))return!1;return!0}});var ze,Ed=d(()=>{ze={}});var Fo,j_=d(()=>{Fo="endpoints"});function sr(e){return typeof e!="object"||e==null?e:"ref"in e?`$${sr(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(sr).join(", ")})`:JSON.stringify(e,null,2)}var W_=d(()=>{});var ia=d(()=>{j_();W_()});var be,z_=d(()=>{be=class extends Error{constructor(t){super(t),this.name="EndpointError"}}});var K_=d(()=>{});var q_=d(()=>{});var J_=d(()=>{});var Y_=d(()=>{});var X_=d(()=>{});var Q_=d(()=>{});var ir=d(()=>{z_();K_();q_();J_();Y_();X_();Q_()});var Z_,eb=d(()=>{Z_=(e,t)=>e===t});var tb,rb=d(()=>{ir();tb=e=>{let t=e.split("."),r=[];for(let o of t){let n=o.indexOf("[");if(n!==-1){if(o.indexOf("]")!==o.length-1)throw new be(`Path: '${e}' does not end with ']'`);let s=o.slice(n+1,-1);if(Number.isNaN(parseInt(s)))throw new be(`Invalid array index: '${s}' in path: '${e}'`);n!==0&&r.push(o.slice(0,n)),r.push(s)}else r.push(o)}return r}});var _d,ob=d(()=>{ir();rb();_d=(e,t)=>tb(t).reduce((r,o)=>{if(typeof r!="object")throw new be(`Index '${o}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(r)?r[parseInt(o)]:r[o]},e)});var nb,sb=d(()=>{nb=e=>e!=null});var ib,ab=d(()=>{ib=e=>!e});var om,cb,db=d(()=>{nn();tm();om={[Ws.HTTP]:80,[Ws.HTTPS]:443},cb=e=>{let t=(()=>{try{if(e instanceof URL)return e;if(typeof e=="object"&&"hostname"in e){let{hostname:f,port:m,protocol:h="",path:g="",query:E={}}=e,w=new URL(`${h}//${f}${m?`:${m}`:""}${g}`);return w.search=Object.entries(E).map(([C,ie])=>`${C}=${ie}`).join("&"),w}return new URL(e)}catch{return null}})();if(!t)return console.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;let r=t.href,{host:o,hostname:n,pathname:s,protocol:i,search:a}=t;if(a)return null;let c=i.slice(0,-1);if(!Object.values(Ws).includes(c))return null;let l=sa(n),p=r.includes(`${o}:${om[c]}`)||typeof e=="string"&&e.includes(`${o}:${om[c]}`),u=`${o}${p?`:${om[c]}`:""}`;return{scheme:c,authority:u,path:s,normalizedPath:s.endsWith("/")?s:`${s}/`,isIp:l}}});var lb,pb=d(()=>{lb=(e,t)=>e===t});var ub,fb=d(()=>{ub=(e,t,r,o)=>t>=r||e.length<r?null:o?e.substring(e.length-r,e.length-t):e.substring(t,r)});var mb,hb=d(()=>{mb=e=>encodeURIComponent(e).replace(/[!*'()]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`)});var nm=d(()=>{eb();ob();sb();rm();ab();db();pb();fb();hb()});var gb,xb=d(()=>{nm();gb={booleanEquals:Z_,getAttr:_d,isSet:nb,isValidHostLabel:ss,not:ib,parseURL:cb,stringEquals:lb,substring:ub,uriEncode:mb}});var bd,sm=d(()=>{nm();bd=(e,t)=>{let r=[],o={...t.endpointParams,...t.referenceRecord},n=0;for(;n<e.length;){let s=e.indexOf("{",n);if(s===-1){r.push(e.slice(n));break}r.push(e.slice(n,s));let i=e.indexOf("}",s);if(i===-1){r.push(e.slice(s));break}e[s+1]==="{"&&e[i+1]==="}"&&(r.push(e.slice(s+1,i)),n=i+2);let a=e.substring(s+1,i);if(a.includes("#")){let[c,l]=a.split("#");r.push(_d(o[c],l))}else r.push(o[a]);n=i+1}return r.join("")}});var yb,Sb=d(()=>{yb=({ref:e},t)=>({...t.endpointParams,...t.referenceRecord})[e]});var is,wd,Eb,aa=d(()=>{ir();Ed();xb();sm();Sb();is=(e,t,r)=>{if(typeof e=="string")return bd(e,r);if(e.fn)return Eb.callFunction(e,r);if(e.ref)return yb(e,r);throw new be(`'${t}': ${String(e)} is not a string, function or reference.`)},wd=({fn:e,argv:t},r)=>{let o=t.map(s=>["boolean","number"].includes(typeof s)?s:Eb.evaluateExpression(s,"arg",r)),n=e.split(".");return n[0]in ze&&n[1]!=null?ze[n[0]][n[1]](...o):gb[e](...o)},Eb={evaluateExpression:is,callFunction:wd}});var _b=d(()=>{aa()});var bb,wb=d(()=>{ia();ir();_b();bb=({assign:e,...t},r)=>{if(e&&e in r.referenceRecord)throw new be(`'${e}' is already defined in Reference Record.`);let o=wd(t,r);return r.logger?.debug?.(`${Fo} evaluateCondition: ${sr(t)} = ${sr(o)}`),{result:o===""?!0:!!o,...e!=null&&{toAssign:{name:e,value:o}}}}});var oi,Rd=d(()=>{ia();wb();oi=(e=[],t)=>{let r={};for(let o of e){let{result:n,toAssign:s}=bb(o,{...t,referenceRecord:{...t.referenceRecord,...r}});if(!n)return{result:n};s&&(r[s.name]=s.value,t.logger?.debug?.(`${Fo} assign: ${s.name} := ${sr(s.value)}`))}return{result:!0,referenceRecord:r}}});var Rb,Ib=d(()=>{ir();aa();Rb=(e,t)=>Object.entries(e).reduce((r,[o,n])=>({...r,[o]:n.map(s=>{let i=is(s,"Header value entry",t);if(typeof i!="string")throw new be(`Header '${o}' value '${i}' is not a string`);return i})}),{})});var im,Tb,vb,Cb=d(()=>{ir();sm();im=(e,t)=>Object.entries(e).reduce((r,[o,n])=>({...r,[o]:vb.getEndpointProperty(n,t)}),{}),Tb=(e,t)=>{if(Array.isArray(e))return e.map(r=>Tb(r,t));switch(typeof e){case"string":return bd(e,t);case"object":if(e===null)throw new be(`Unexpected endpoint property: ${e}`);return vb.getEndpointProperties(e,t);case"boolean":return e;default:throw new be(`Unexpected endpoint property type: ${typeof e}`)}},vb={getEndpointProperty:Tb,getEndpointProperties:im}});var Ab,Pb=d(()=>{ir();aa();Ab=(e,t)=>{let r=is(e,"Endpoint URL",t);if(typeof r=="string")try{return new URL(r)}catch(o){throw console.error(`Failed to construct URL with ${r}`,o),o}throw new be(`Endpoint URL must be a string, got ${typeof r}`)}});var Db,Nb=d(()=>{ia();Rd();Ib();Cb();Pb();Db=(e,t)=>{let{conditions:r,endpoint:o}=e,{result:n,referenceRecord:s}=oi(r,t);if(!n)return;let i={...t,referenceRecord:{...t.referenceRecord,...s}},{url:a,properties:c,headers:l}=o;return t.logger?.debug?.(`${Fo} Resolving endpoint from template: ${sr(o)}`),{...l!=null&&{headers:Rb(l,i)},...c!=null&&{properties:im(c,i)},url:Ab(a,i)}}});var Ob,kb=d(()=>{ir();Rd();aa();Ob=(e,t)=>{let{conditions:r,error:o}=e,{result:n,referenceRecord:s}=oi(r,t);if(n)throw new be(is(o,"Error",{...t,referenceRecord:{...t.referenceRecord,...s}}))}});var am,$M,$b,Mb=d(()=>{ir();Rd();Nb();kb();am=(e,t)=>{for(let r of e)if(r.type==="endpoint"){let o=Db(r,t);if(o)return o}else if(r.type==="error")Ob(r,t);else if(r.type==="tree"){let o=$b.evaluateTreeRule(r,t);if(o)return o}else throw new be(`Unknown endpoint rule: ${r}`);throw new be("Rules evaluation failed")},$M=(e,t)=>{let{conditions:r,rules:o}=e,{result:n,referenceRecord:s}=oi(r,t);if(n)return $b.evaluateRules(o,{...t,referenceRecord:{...t.referenceRecord,...s}})},$b={evaluateRules:am,evaluateTreeRule:$M}});var Lb=d(()=>{Ed();Mb()});var ar,Ub=d(()=>{ia();ir();Lb();ar=(e,t)=>{let{endpointParams:r,logger:o}=t,{parameters:n,rules:s}=e;t.logger?.debug?.(`${Fo} Initial EndpointParams: ${sr(r)}`);let i=Object.entries(n).filter(([,l])=>l.default!=null).map(([l,p])=>[l,p.default]);if(i.length>0)for(let[l,p]of i)r[l]=r[l]??p;let a=Object.entries(n).filter(([,l])=>l.required).map(([l])=>l);for(let l of a)if(r[l]==null)throw new be(`Missing required parameter: '${l}'`);let c=am(s,{endpointParams:r,logger:o,referenceRecord:{}});return t.logger?.debug?.(`${Fo} Resolved endpoint: ${sr(c)}`),c}});var Wr=d(()=>{G_();tm();rm();Ed();Ub();ir()});var cm=d(()=>{Wr()});var dm,Fb=d(()=>{Wr();cm();dm=(e,t=!1)=>{if(t){for(let r of e.split("."))if(!dm(r))return!1;return!0}return!(!ss(e)||e.length<3||e.length>63||e!==e.toLowerCase()||sa(e))}});var Bb,MM,Hb,Vb=d(()=>{Bb=":",MM="/",Hb=e=>{let t=e.split(Bb);if(t.length<6)return null;let[r,o,n,s,i,...a]=t;if(r!=="arn"||o===""||n===""||a.join(Bb)==="")return null;let c=a.map(l=>l.split(MM)).flat();return{partition:o,service:n,region:s,accountId:i,resourceId:c}}});var jb,Gb=d(()=>{jb={partitions:[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"EU (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],version:"1.1"}});var UM,FM,Wb,zb,lm=d(()=>{Gb();UM=jb,FM="",Wb=e=>{let{partitions:t}=UM;for(let o of t){let{regions:n,outputs:s}=o;for(let[i,a]of Object.entries(n))if(i===e)return{...s,...a}}for(let o of t){let{regionRegex:n,outputs:s}=o;if(new RegExp(n).test(e))return{...s}}let r=t.find(o=>o.id==="aws");if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}},zb=()=>FM});var kt,Kb=d(()=>{Wr();Fb();Vb();lm();kt={isVirtualHostableS3Bucket:dm,parseArn:Hb,partition:Wb};ze.aws=kt});function qb(e){let t={};if(e=e.replace(/^\?/,""),e)for(let r of e.split("&")){let[o,n=null]=r.split("=");o=decodeURIComponent(o),n&&(n=decodeURIComponent(n)),o in t?Array.isArray(t[o])?t[o].push(n):t[o]=[t[o],n]:t[o]=n}return t}var Jb=d(()=>{});var Ve,Bo=d(()=>{Jb();Ve=e=>{if(typeof e=="string")return Ve(new URL(e));let{hostname:t,pathname:r,port:o,protocol:n,search:s}=e,i;return s&&(i=qb(s)),{hostname:t,port:o?parseInt(o):void 0,protocol:n,path:r,query:i}}});var Yb=d(()=>{});var Xb=d(()=>{});var Qb=d(()=>{});var Zb=d(()=>{});var ew=d(()=>{});var tw=d(()=>{});var rw=d(()=>{});var ow=d(()=>{});var nw=d(()=>{Qb();Zb();ew();tw();rw();ow()});var an=d(()=>{Kb();lm();cm();Yb();Xb();nw()});var sw,cr,iw=d(()=>{sw={warningEmitted:!1},cr=e=>{e&&!sw.warningEmitted&&parseInt(e.substring(1,e.indexOf(".")))<20&&(sw.warningEmitted=!0,process.emitWarning(`NodeDeprecationWarning: The AWS SDK for JavaScript (v3) will
no longer support Node.js ${e} in January 2026.

To continue receiving updates to AWS services, bug fixes, and security
updates please upgrade to a supported Node.js LTS version.

More information can be found at: https://a.co/c895JFp`))}});function q(e,t,r){return e.$source||(e.$source={}),e.$source[t]=r,e}var aw=d(()=>{});function $t(e,t,r){e.__aws_sdk_context?e.__aws_sdk_context.features||(e.__aws_sdk_context.features={}):e.__aws_sdk_context={features:{}},e.__aws_sdk_context.features[t]=r}var cw=d(()=>{});var dw=d(()=>{});var Ke=d(()=>{iw();aw();cw();dw()});var pm,lw=d(()=>{we();pm=e=>Jt.isInstance(e)?e.headers?.date??e.headers?.Date:void 0});var Id,um=d(()=>{Id=e=>new Date(Date.now()+e)});var pw,uw=d(()=>{um();pw=(e,t)=>Math.abs(Id(t).getTime()-e)>=3e5});var fm,fw=d(()=>{uw();fm=(e,t)=>{let r=Date.parse(e);return pw(r,t)?r-Date.now():t}});var mw=d(()=>{lw();um();fw()});var ca,hw,qe,gw=d(()=>{we();mw();ca=(e,t)=>{if(!t)throw new Error(`Property \`${e}\` is not resolved for AWS SDK SigV4Auth`);return t},hw=async e=>{let t=ca("context",e.context),r=ca("config",e.config),o=t.endpointV2?.properties?.authSchemes?.[0],s=await ca("signer",r.signer)(o),i=e?.signingRegion,a=e?.signingRegionSet,c=e?.signingName;return{config:r,signer:s,signingRegion:i,signingRegionSet:a,signingName:c}},qe=class{async sign(t,r,o){if(!le.isInstance(t))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");let n=await hw(o),{config:s,signer:i}=n,{signingRegion:a,signingName:c}=n,l=o.context;if(l?.authSchemes?.length??0>1){let[u,f]=l.authSchemes;u?.name==="sigv4a"&&f?.name==="sigv4"&&(a=f?.signingRegion??a,c=f?.signingName??c)}return await i.sign(t,{signingDate:Id(s.systemClockOffset),signingRegion:a,signingService:c})}errorHandler(t){return r=>{let o=r.ServerTime??pm(r.$response);if(o){let n=ca("config",t.config),s=n.systemClockOffset;n.systemClockOffset=fm(o,n.systemClockOffset),n.systemClockOffset!==s&&r.$metadata&&(r.$metadata.clockSkewCorrected=!0)}throw r}}successHandler(t,r){let o=pm(t);if(o){let n=ca("config",r.config);n.systemClockOffset=fm(o,n.systemClockOffset)}}}});var mm,xw=d(()=>{mm=e=>typeof e=="string"&&e.length>0?e.split(",").map(t=>t.trim()):[]});var yw,hm=d(()=>{yw=e=>`AWS_BEARER_TOKEN_${e.replace(/[\s-]/g,"_").toUpperCase()}`});var Sw,Ew,dr,_w=d(()=>{xw();hm();Sw="AWS_AUTH_SCHEME_PREFERENCE",Ew="auth_scheme_preference",dr={environmentVariableSelector:(e,t)=>{if(t?.signingName&&yw(t.signingName)in e)return["httpBearerAuth"];if(Sw in e)return mm(e[Sw])},configFileSelector:e=>{if(Ew in e)return mm(e[Ew])},default:[]}});var lr,da=d(()=>{lr=class e extends Error{name="ProviderError";tryNextLink;constructor(t,r=!0){let o,n=!0;typeof r=="boolean"?(o=void 0,n=r):r!=null&&typeof r=="object"&&(o=r.logger,n=r.tryNextLink??!0),super(t),this.tryNextLink=n,Object.setPrototypeOf(this,e.prototype),o?.debug?.(`@smithy/property-provider ${n?"->":"(!)"} ${t}`)}static from(t,r=!0){return Object.assign(new this(t.message,r),t)}}});var v,bw=d(()=>{da();v=class e extends lr{name="CredentialsProviderError";constructor(t,r=!0){super(t,r),Object.setPrototypeOf(this,e.prototype)}}});var pr,ww=d(()=>{da();pr=class e extends lr{name="TokenProviderError";constructor(t,r=!0){super(t,r),Object.setPrototypeOf(this,e.prototype)}}});var ni,Rw=d(()=>{da();ni=(...e)=>async()=>{if(e.length===0)throw new lr("No providers in chain");let t;for(let r of e)try{return await r()}catch(o){if(t=o,o?.tryNextLink)continue;throw o}throw t}});var Iw,Tw=d(()=>{Iw=e=>()=>Promise.resolve(e)});var Td,vw=d(()=>{Td=(e,t,r)=>{let o,n,s,i=!1,a=async()=>{n||(n=e());try{o=await n,s=!0,i=!1}finally{n=void 0}return o};return t===void 0?async c=>((!s||c?.forceRefresh)&&(o=await a()),o):async c=>((!s||c?.forceRefresh)&&(o=await a()),i?o:r&&!r(o)?(i=!0,o):(t(o)&&await a(),o))}});var fe=d(()=>{bw();da();ww();Rw();Tw();vw()});var Cw=d(()=>{});var Aw,Pw,gm,Dw,Nw,xm,ym,Sm,Em,BM,Ow,kw,la,$w,Mw,Lw,Uw,vd,Fw,Bw,Hw,_m,Vw,cn=d(()=>{Aw="X-Amz-Algorithm",Pw="X-Amz-Credential",gm="X-Amz-Date",Dw="X-Amz-SignedHeaders",Nw="X-Amz-Expires",xm="X-Amz-Signature",ym="X-Amz-Security-Token",Sm="authorization",Em=gm.toLowerCase(),BM="date",Ow=[Sm,Em,BM],kw=xm.toLowerCase(),la="x-amz-content-sha256",$w=ym.toLowerCase(),Mw={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},Lw=/^proxy-/,Uw=/^sec-/,vd="AWS4-HMAC-SHA256",Fw="AWS4-HMAC-SHA256-PAYLOAD",Bw="UNSIGNED-PAYLOAD",Hw=50,_m="aws4_request",Vw=60*60*24*7});var Cd,bm,Ad,jw,Gw,wm=d(()=>{os();Ae();cn();Cd={},bm=[],Ad=(e,t,r)=>`${e}/${t}/${r}/${_m}`,jw=async(e,t,r,o,n)=>{let s=await Gw(e,t.secretAccessKey,t.accessKeyId),i=`${r}:${o}:${n}:${yt(s)}:${t.sessionToken}`;if(i in Cd)return Cd[i];for(bm.push(i);bm.length>Hw;)delete Cd[bm.shift()];let a=`AWS4${t.secretAccessKey}`;for(let c of[r,o,n,_m])a=await Gw(e,a,c);return Cd[i]=a},Gw=(e,t,r)=>{let o=new e(t);return o.update(jr(r)),o.digest()}});var Rm,Ww=d(()=>{cn();Rm=({headers:e},t,r)=>{let o={};for(let n of Object.keys(e).sort()){if(e[n]==null)continue;let s=n.toLowerCase();(s in Mw||t?.has(s)||Lw.test(s)||Uw.test(s))&&(!r||r&&!r.has(s))||(o[s]=e[n].trim().replace(/\s+/g," "))}return o}});var Pd,zw=d(()=>{Tf();os();Ae();cn();Pd=async({headers:e,body:t},r)=>{for(let o of Object.keys(e))if(o.toLowerCase()===la)return e[o];if(t==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof t=="string"||ArrayBuffer.isView(t)||od(t)){let o=new r;return o.update(jr(t)),yt(await o.digest())}return Bw}});function qw(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,e[t]===0);t--);}var Dd,Kw,HM,Im,Jw=d(()=>{os();Ae();Dd=class{format(t){let r=[];for(let s of Object.keys(t)){let i=_e(s);r.push(Uint8Array.from([i.byteLength]),i,this.formatHeaderValue(t[s]))}let o=new Uint8Array(r.reduce((s,i)=>s+i.byteLength,0)),n=0;for(let s of r)o.set(s,n),n+=s.byteLength;return o}formatHeaderValue(t){switch(t.type){case"boolean":return Uint8Array.from([t.value?0:1]);case"byte":return Uint8Array.from([2,t.value]);case"short":let r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,t.value,!1),new Uint8Array(r.buffer);case"integer":let o=new DataView(new ArrayBuffer(5));return o.setUint8(0,4),o.setInt32(1,t.value,!1),new Uint8Array(o.buffer);case"long":let n=new Uint8Array(9);return n[0]=5,n.set(t.value.bytes,1),n;case"binary":let s=new DataView(new ArrayBuffer(3+t.value.byteLength));s.setUint8(0,6),s.setUint16(1,t.value.byteLength,!1);let i=new Uint8Array(s.buffer);return i.set(t.value,3),i;case"string":let a=_e(t.value),c=new DataView(new ArrayBuffer(3+a.byteLength));c.setUint8(0,7),c.setUint16(1,a.byteLength,!1);let l=new Uint8Array(c.buffer);return l.set(a,3),l;case"timestamp":let p=new Uint8Array(9);return p[0]=8,p.set(Im.fromNumber(t.value.valueOf()).bytes,1),p;case"uuid":if(!HM.test(t.value))throw new Error(`Invalid UUID received: ${t.value}`);let u=new Uint8Array(17);return u[0]=9,u.set(yE(t.value.replace(/\-/g,"")),1),u}}};(function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"})(Kw||(Kw={}));HM=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,Im=class e{bytes;constructor(t){if(this.bytes=t,t.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(t){if(t>9223372036854776e3||t<-9223372036854776e3)throw new Error(`${t} is too large (or, if negative, too small) to represent as an Int64`);let r=new Uint8Array(8);for(let o=7,n=Math.abs(Math.round(t));o>-1&&n>0;o--,n/=256)r[o]=n;return t<0&&qw(r),new e(r)}valueOf(){let t=this.bytes.slice(0),r=t[0]&128;return r&&qw(t),parseInt(yt(t),16)*(r?-1:1)}toString(){return String(this.valueOf())}}});var Yw,Xw=d(()=>{Yw=(e,t)=>{e=e.toLowerCase();for(let r of Object.keys(t))if(e===r.toLowerCase())return!0;return!1}});var Qw,Zw=d(()=>{we();Qw=(e,t={})=>{let{headers:r,query:o={}}=le.clone(e);for(let n of Object.keys(r)){let s=n.toLowerCase();(s.slice(0,6)==="x-amz-"&&!t.unhoistableHeaders?.has(s)||t.hoistableHeaders?.has(s))&&(o[n]=r[n],delete r[n])}return{...e,headers:r,query:o}}});var Tm,eR=d(()=>{we();cn();Tm=e=>{e=le.clone(e);for(let t of Object.keys(e.headers))Ow.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e}});var tR,rR=d(()=>{nd();cn();tR=({query:e={}})=>{let t=[],r={};for(let o of Object.keys(e)){if(o.toLowerCase()===kw)continue;let n=so(o);t.push(n);let s=e[o];typeof s=="string"?r[n]=`${n}=${so(s)}`:Array.isArray(s)&&(r[n]=s.slice(0).reduce((i,a)=>i.concat([`${n}=${so(a)}`]),[]).sort().join("&"))}return t.sort().map(o=>r[o]).filter(o=>o).join("&")}});var oR,VM,nR=d(()=>{oR=e=>VM(e).toISOString().replace(/\.\d{3}Z$/,"Z"),VM=e=>typeof e=="number"?new Date(e*1e3):typeof e=="string"?Number(e)?new Date(Number(e)*1e3):new Date(e):e});var Nd,sR=d(()=>{os();Ze();nd();Ae();rR();nR();Nd=class{service;regionProvider;credentialProvider;sha256;uriEscapePath;applyChecksum;constructor({applyChecksum:t,credentials:r,region:o,service:n,sha256:s,uriEscapePath:i=!0}){this.service=n,this.sha256=s,this.uriEscapePath=i,this.applyChecksum=typeof t=="boolean"?t:!0,this.regionProvider=de(o),this.credentialProvider=de(r)}createCanonicalRequest(t,r,o){let n=Object.keys(r).sort();return`${t.method}
${this.getCanonicalPath(t)}
${tR(t)}
${n.map(s=>`${s}:${r[s]}`).join(`
`)}

${n.join(";")}
${o}`}async createStringToSign(t,r,o,n){let s=new this.sha256;s.update(jr(o));let i=await s.digest();return`${n}
${t}
${r}
${yt(i)}`}getCanonicalPath({path:t}){if(this.uriEscapePath){let r=[];for(let s of t.split("/"))s?.length!==0&&s!=="."&&(s===".."?r.pop():r.push(s));let o=`${t?.startsWith("/")?"/":""}${r.join("/")}${r.length>0&&t?.endsWith("/")?"/":""}`;return so(o).replace(/%2F/g,"/")}return t}validateResolvedCredentials(t){if(typeof t!="object"||typeof t.accessKeyId!="string"||typeof t.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(t){let r=oR(t).replace(/[\-:]/g,"");return{longDate:r,shortDate:r.slice(0,8)}}getCanonicalHeaderList(t){return Object.keys(t).sort().join(";")}}});var pa,iR=d(()=>{os();Ae();cn();wm();Ww();zw();Jw();Xw();Zw();eR();sR();pa=class extends Nd{headerFormatter=new Dd;constructor({applyChecksum:t,credentials:r,region:o,service:n,sha256:s,uriEscapePath:i=!0}){super({applyChecksum:t,credentials:r,region:o,service:n,sha256:s,uriEscapePath:i})}async presign(t,r={}){let{signingDate:o=new Date,expiresIn:n=3600,unsignableHeaders:s,unhoistableHeaders:i,signableHeaders:a,hoistableHeaders:c,signingRegion:l,signingService:p}=r,u=await this.credentialProvider();this.validateResolvedCredentials(u);let f=l??await this.regionProvider(),{longDate:m,shortDate:h}=this.formatDate(o);if(n>Vw)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");let g=Ad(h,f,p??this.service),E=Qw(Tm(t),{unhoistableHeaders:i,hoistableHeaders:c});u.sessionToken&&(E.query[ym]=u.sessionToken),E.query[Aw]=vd,E.query[Pw]=`${u.accessKeyId}/${g}`,E.query[gm]=m,E.query[Nw]=n.toString(10);let w=Rm(E,s,a);return E.query[Dw]=this.getCanonicalHeaderList(w),E.query[xm]=await this.getSignature(m,g,this.getSigningKey(u,f,h,p),this.createCanonicalRequest(E,w,await Pd(t,this.sha256))),E}async sign(t,r){return typeof t=="string"?this.signString(t,r):t.headers&&t.payload?this.signEvent(t,r):t.message?this.signMessage(t,r):this.signRequest(t,r)}async signEvent({headers:t,payload:r},{signingDate:o=new Date,priorSignature:n,signingRegion:s,signingService:i}){let a=s??await this.regionProvider(),{shortDate:c,longDate:l}=this.formatDate(o),p=Ad(c,a,i??this.service),u=await Pd({headers:{},body:r},this.sha256),f=new this.sha256;f.update(t);let m=yt(await f.digest()),h=[Fw,l,p,n,m,u].join(`
`);return this.signString(h,{signingDate:o,signingRegion:a,signingService:i})}async signMessage(t,{signingDate:r=new Date,signingRegion:o,signingService:n}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:r,signingRegion:o,signingService:n,priorSignature:t.priorSignature}).then(i=>({message:t.message,signature:i}))}async signString(t,{signingDate:r=new Date,signingRegion:o,signingService:n}={}){let s=await this.credentialProvider();this.validateResolvedCredentials(s);let i=o??await this.regionProvider(),{shortDate:a}=this.formatDate(r),c=new this.sha256(await this.getSigningKey(s,i,a,n));return c.update(jr(t)),yt(await c.digest())}async signRequest(t,{signingDate:r=new Date,signableHeaders:o,unsignableHeaders:n,signingRegion:s,signingService:i}={}){let a=await this.credentialProvider();this.validateResolvedCredentials(a);let c=s??await this.regionProvider(),l=Tm(t),{longDate:p,shortDate:u}=this.formatDate(r),f=Ad(u,c,i??this.service);l.headers[Em]=p,a.sessionToken&&(l.headers[$w]=a.sessionToken);let m=await Pd(l,this.sha256);!Yw(la,l.headers)&&this.applyChecksum&&(l.headers[la]=m);let h=Rm(l,n,o),g=await this.getSignature(p,f,this.getSigningKey(a,c,u,i),this.createCanonicalRequest(l,h,m));return l.headers[Sm]=`${vd} Credential=${a.accessKeyId}/${f}, SignedHeaders=${this.getCanonicalHeaderList(h)}, Signature=${g}`,l}async getSignature(t,r,o,n){let s=await this.createStringToSign(t,r,n,vd),i=new this.sha256(await o);return i.update(jr(s)),yt(await i.digest())}getSigningKey(t,r,o,n){return jw(this.sha256,t,o,r,n||this.service)}}});var aR=d(()=>{});var cR=d(()=>{iR();cn();wm();aR()});function GM(e,{credentials:t,credentialDefaultProvider:r}){let o;return t?t?.memoized?o=t:o=F_(t,U_,Zf):r?o=es(r(Object.assign({},e,{parentClientConfig:e}))):o=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},o.memoized=!0,o}function jM(e,t){if(t.configBound)return t;let r=async o=>t({...o,callerClientConfig:e});return r.memoized=t.memoized,r.configBound=!0,r}var ur,dR=d(()=>{Ke();Fe();cR();ur=e=>{let t=e.credentials,r=!!e.credentials,o;Object.defineProperty(e,"credentials",{set(l){l&&l!==t&&l!==o&&(r=!0),t=l;let p=GM(e,{credentials:t,credentialDefaultProvider:e.credentialDefaultProvider}),u=jM(e,p);r&&!u.attributed?(o=async f=>u(f).then(m=>q(m,"CREDENTIALS_CODE","e")),o.memoized=u.memoized,o.configBound=u.configBound,o.attributed=!0):o=u},get(){return o},enumerable:!0,configurable:!0}),e.credentials=t;let{signingEscapePath:n=!0,systemClockOffset:s=e.systemClockOffset||0,sha256:i}=e,a;return e.signer?a=es(e.signer):e.regionInfoProvider?a=()=>es(e.region)().then(async l=>[await e.regionInfoProvider(l,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},l]).then(([l,p])=>{let{signingRegion:u,signingService:f}=l;e.signingRegion=e.signingRegion||u||p,e.signingName=e.signingName||f||e.serviceId;let m={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:i,uriEscapePath:n},h=e.signerConstructor||pa;return new h(m)}):a=async l=>{l=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await es(e.region)(),properties:{}},l);let p=l.signingRegion,u=l.signingName;e.signingRegion=e.signingRegion||p,e.signingName=e.signingName||u||e.serviceId;let f={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:i,uriEscapePath:n},m=e.signerConstructor||pa;return new m(f)},Object.assign(e,{systemClockOffset:s,signingEscapePath:n,signer:a})}});var lR=d(()=>{gw();_w();Cw();dR()});var pR=d(()=>{lR();hm()});var as,dn,si,uR,fR,mR=d(()=>{as=(e,t)=>{let r=[];if(e&&r.push(e),t)for(let o of t)r.push(o);return r},dn=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,si=()=>{let e=[],t=[],r=!1,o=new Set,n=u=>u.sort((f,m)=>uR[m.step]-uR[f.step]||fR[m.priority||"normal"]-fR[f.priority||"normal"]),s=u=>{let f=!1,m=h=>{let g=as(h.name,h.aliases);if(g.includes(u)){f=!0;for(let E of g)o.delete(E);return!1}return!0};return e=e.filter(m),t=t.filter(m),f},i=u=>{let f=!1,m=h=>{if(h.middleware===u){f=!0;for(let g of as(h.name,h.aliases))o.delete(g);return!1}return!0};return e=e.filter(m),t=t.filter(m),f},a=u=>(e.forEach(f=>{u.add(f.middleware,{...f})}),t.forEach(f=>{u.addRelativeTo(f.middleware,{...f})}),u.identifyOnResolve?.(p.identifyOnResolve()),u),c=u=>{let f=[];return u.before.forEach(m=>{m.before.length===0&&m.after.length===0?f.push(m):f.push(...c(m))}),f.push(u),u.after.reverse().forEach(m=>{m.before.length===0&&m.after.length===0?f.push(m):f.push(...c(m))}),f},l=(u=!1)=>{let f=[],m=[],h={};return e.forEach(E=>{let w={...E,before:[],after:[]};for(let C of as(w.name,w.aliases))h[C]=w;f.push(w)}),t.forEach(E=>{let w={...E,before:[],after:[]};for(let C of as(w.name,w.aliases))h[C]=w;m.push(w)}),m.forEach(E=>{if(E.toMiddleware){let w=h[E.toMiddleware];if(w===void 0){if(u)return;throw new Error(`${E.toMiddleware} is not found when adding ${dn(E.name,E.aliases)} middleware ${E.relation} ${E.toMiddleware}`)}E.relation==="after"&&w.after.push(E),E.relation==="before"&&w.before.push(E)}}),n(f).map(c).reduce((E,w)=>(E.push(...w),E),[])},p={add:(u,f={})=>{let{name:m,override:h,aliases:g}=f,E={step:"initialize",priority:"normal",middleware:u,...f},w=as(m,g);if(w.length>0){if(w.some(C=>o.has(C))){if(!h)throw new Error(`Duplicate middleware name '${dn(m,g)}'`);for(let C of w){let ie=e.findIndex(Me=>Me.name===C||Me.aliases?.some(je=>je===C));if(ie===-1)continue;let he=e[ie];if(he.step!==E.step||E.priority!==he.priority)throw new Error(`"${dn(he.name,he.aliases)}" middleware with ${he.priority} priority in ${he.step} step cannot be overridden by "${dn(m,g)}" middleware with ${E.priority} priority in ${E.step} step.`);e.splice(ie,1)}}for(let C of w)o.add(C)}e.push(E)},addRelativeTo:(u,f)=>{let{name:m,override:h,aliases:g}=f,E={middleware:u,...f},w=as(m,g);if(w.length>0){if(w.some(C=>o.has(C))){if(!h)throw new Error(`Duplicate middleware name '${dn(m,g)}'`);for(let C of w){let ie=t.findIndex(Me=>Me.name===C||Me.aliases?.some(je=>je===C));if(ie===-1)continue;let he=t[ie];if(he.toMiddleware!==E.toMiddleware||he.relation!==E.relation)throw new Error(`"${dn(he.name,he.aliases)}" middleware ${he.relation} "${he.toMiddleware}" middleware cannot be overridden by "${dn(m,g)}" middleware ${E.relation} "${E.toMiddleware}" middleware.`);t.splice(ie,1)}}for(let C of w)o.add(C)}t.push(E)},clone:()=>a(si()),use:u=>{u.applyToStack(p)},remove:u=>typeof u=="string"?s(u):i(u),removeByTag:u=>{let f=!1,m=h=>{let{tags:g,name:E,aliases:w}=h;if(g&&g.includes(u)){let C=as(E,w);for(let ie of C)o.delete(ie);return f=!0,!1}return!0};return e=e.filter(m),t=t.filter(m),f},concat:u=>{let f=a(si());return f.use(u),f.identifyOnResolve(r||f.identifyOnResolve()||(u.identifyOnResolve?.()??!1)),f},applyToStack:a,identify:()=>l(!0).map(u=>{let f=u.step??u.relation+" "+u.toMiddleware;return dn(u.name,u.aliases)+" - "+f}),identifyOnResolve(u){return typeof u=="boolean"&&(r=u),r},resolve:(u,f)=>{for(let m of l().map(h=>h.middleware).reverse())u=m(u,f);return r&&console.log(p.identify()),u}};return p},uR={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},fR={high:3,normal:2,low:1}});var vm=d(()=>{mR()});var Be,hR=d(()=>{vm();Be=class{config;middlewareStack=si();initConfig;handlers;constructor(t){this.config=t;let{protocol:r,protocolSettings:o}=t;o&&typeof r=="function"&&(t.protocol=new r(o))}send(t,r,o){let n=typeof r!="function"?r:void 0,s=typeof r=="function"?r:o,i=n===void 0&&this.config.cacheMiddleware===!0,a;if(i){this.handlers||(this.handlers=new WeakMap);let c=this.handlers;c.has(t.constructor)?a=c.get(t.constructor):(a=t.resolveMiddleware(this.middlewareStack,this.config,n),c.set(t.constructor,a))}else delete this.handlers,a=t.resolveMiddleware(this.middlewareStack,this.config,n);if(s)a(t).then(c=>s(null,c.output),c=>s(c)).catch(()=>{});else return a(t).then(c=>c.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}});var gR=d(()=>{Uo()});function Od(e,t){if(t==null)return t;let r=M.of(e);if(r.getMergedTraits().sensitive)return Cm;if(r.isListSchema()){if(!!r.getValueSchema().getMergedTraits().sensitive)return Cm}else if(r.isMapSchema()){if(!!r.getKeySchema().getMergedTraits().sensitive||!!r.getValueSchema().getMergedTraits().sensitive)return Cm}else if(r.isStructSchema()&&typeof t=="object"){let o=t,n={};for(let[s,i]of r.structIterator())o[s]!=null&&(n[s]=Od(i,o[s]));return n}return t}var Cm,xR=d(()=>{ae();Cm="***SensitiveInformation***"});var V,Am,yR=d(()=>{vm();nn();xR();V=class{middlewareStack=si();schema;static classBuilder(){return new Am}resolveMiddlewareWithContext(t,r,o,{middlewareFn:n,clientName:s,commandName:i,inputFilterSensitiveLog:a,outputFilterSensitiveLog:c,smithyContext:l,additionalContext:p,CommandCtor:u}){for(let E of n.bind(this)(u,t,r,o))this.middlewareStack.use(E);let f=t.concat(this.middlewareStack),{logger:m}=r,h={logger:m,clientName:s,commandName:i,inputFilterSensitiveLog:a,outputFilterSensitiveLog:c,[Zi]:{commandInstance:this,...l},...p},{requestHandler:g}=r;return f.resolve(E=>g.handle(E.request,o||{}),h)}},Am=class{_init=()=>{};_ep={};_middlewareFn=()=>[];_commandName="";_clientName="";_additionalContext={};_smithyContext={};_inputFilterSensitiveLog=void 0;_outputFilterSensitiveLog=void 0;_serializer=null;_deserializer=null;_operationSchema;init(t){this._init=t}ep(t){return this._ep=t,this}m(t){return this._middlewareFn=t,this}s(t,r,o={}){return this._smithyContext={service:t,operation:r,...o},this}c(t={}){return this._additionalContext=t,this}n(t,r){return this._clientName=t,this._commandName=r,this}f(t=o=>o,r=o=>o){return this._inputFilterSensitiveLog=t,this._outputFilterSensitiveLog=r,this}ser(t){return this._serializer=t,this}de(t){return this._deserializer=t,this}sc(t){return this._operationSchema=t,this._smithyContext.operationSchema=t,this}build(){let t=this,r;return r=class extends V{input;static getEndpointParameterInstructions(){return t._ep}constructor(...[o]){super(),this.input=o??{},t._init(this),this.schema=t._operationSchema}resolveMiddleware(o,n,s){let i=t._operationSchema,a=i?.[4]??i?.input,c=i?.[5]??i?.output;return this.resolveMiddlewareWithContext(o,n,s,{CommandCtor:r,middlewareFn:t._middlewareFn,clientName:t._clientName,commandName:t._commandName,inputFilterSensitiveLog:t._inputFilterSensitiveLog??(i?Od.bind(null,a):l=>l),outputFilterSensitiveLog:t._outputFilterSensitiveLog??(i?Od.bind(null,c):l=>l),smithyContext:t._smithyContext,additionalContext:t._additionalContext})}serialize=t._serializer;deserialize=t._deserializer}}}});var SR=d(()=>{});var ln,ER=d(()=>{ln=(e,t)=>{for(let r of Object.keys(e)){let o=e[r],n=async function(i,a,c){let l=new o(i);if(typeof a=="function")this.send(l,a);else if(typeof c=="function"){if(typeof a!="object")throw new Error(`Expected http options but got ${typeof a}`);this.send(l,a||{},c)}else return this.send(l,a)},s=(r[0].toLowerCase()+r.slice(1)).replace(/Command$/,"");t.prototype[s]=n}}});var wt,Pm,_R=d(()=>{wt=class e extends Error{$fault;$response;$retryable;$metadata;constructor(t){super(t.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;let r=t;return e.prototype.isPrototypeOf(r)||!!r.$fault&&!!r.$metadata&&(r.$fault==="client"||r.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;let r=t;return this===e?e.isInstance(t):e.isInstance(t)?r.name&&this.name?this.prototype.isPrototypeOf(t)||r.name===this.name:this.prototype.isPrototypeOf(t):!1}},Pm=(e,t={})=>{Object.entries(t).filter(([,o])=>o!==void 0).forEach(([o,n])=>{(e[o]==null||e[o]==="")&&(e[o]=n)});let r=e.message||e.Message||"UnknownError";return e.message=r,delete e.Message,e}});var bR=d(()=>{});var fr,wR=d(()=>{fr=e=>{switch(e){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}}});var RR,mr,IR=d(()=>{RR=!1,mr=e=>{e&&!RR&&parseInt(e.substring(1,e.indexOf(".")))<16&&(RR=!0)}});var TR=d(()=>{});var vR,CR,AR=d(()=>{nn();vR=e=>{let t=[];for(let r in zs){let o=zs[r];e[o]!==void 0&&t.push({algorithmId:()=>o,checksumConstructor:()=>e[o]})}return{addChecksumAlgorithm(r){t.push(r)},checksumAlgorithms(){return t}}},CR=e=>{let t={};return e.checksumAlgorithms().forEach(r=>{t[r.algorithmId()]=r.checksumConstructor()}),t}});var PR,DR,NR=d(()=>{PR=e=>({setRetryStrategy(t){e.retryStrategy=t},retryStrategy(){return e.retryStrategy}}),DR=e=>{let t={};return t.retryStrategy=e.retryStrategy(),t}});var hr,gr,OR=d(()=>{AR();NR();hr=e=>Object.assign(vR(e),PR(e)),gr=e=>Object.assign(CR(e),DR(e))});var kR=d(()=>{OR()});var $R=d(()=>{});var Dm,MR=d(()=>{Dm=e=>{let t="#text";for(let r in e)e.hasOwnProperty(r)&&e[r][t]!==void 0?e[r]=e[r][t]:typeof e[r]=="object"&&e[r]!==null&&(e[r]=Dm(e[r]));return e}});var LR=d(()=>{});var ot,UR=d(()=>{ot=class{trace(){}debug(){}info(){}warn(){}error(){}}});var FR=d(()=>{});var BR=d(()=>{});var HR=d(()=>{});var ua,VR=d(()=>{ua=e=>{if(e==null)return{};if(Array.isArray(e))return e.filter(t=>t!=null).map(ua);if(typeof e=="object"){let t={};for(let r of Object.keys(e))e[r]!=null&&(t[r]=ua(e[r]));return t}return e}});var N=d(()=>{hR();gR();yR();SR();ER();bR();wR();IR();_R();TR();kR();$R();MR();LR();UR();FR();BR();HR();VR();ao()});var pn,kd=d(()=>{ae();N();pn=class{queryCompat;constructor(t=!1){this.queryCompat=t}resolveRestContentType(t,r){let o=r.getMemberSchemas(),n=Object.values(o).find(s=>!!s.getMergedTraits().httpPayload);if(n){let s=n.getMergedTraits().mediaType;return s||(n.isStringSchema()?"text/plain":n.isBlobSchema()?"application/octet-stream":t)}else if(!r.isUnitSchema()&&Object.values(o).find(i=>{let{httpQuery:a,httpQueryParams:c,httpHeader:l,httpLabel:p,httpPrefixHeaders:u}=i.getMergedTraits();return!a&&!c&&!l&&!p&&u===void 0}))return t}async getErrorSchemaOrThrowBaseException(t,r,o,n,s,i){let a=r,c=t;t.includes("#")&&([a,c]=t.split("#"));let l={$metadata:s,$fault:o.statusCode<500?"client":"server"},p=S.for(a);try{return{errorSchema:i?.(p,c)??p.getSchema(t),errorMetadata:l}}catch{n.message=n.message??n.Message??"UnknownError";let f=S.for("smithy.ts.sdk.synthetic."+a),m=f.getBaseException();if(m){let h=f.getErrorCtor(m)??Error;throw this.decorateServiceException(Object.assign(new h({name:c}),l),n)}throw this.decorateServiceException(Object.assign(new Error(c),l),n)}}decorateServiceException(t,r={}){if(this.queryCompat){let o=t.Message??r.Message,n=Pm(t,r);o&&(n.message=o),n.Error={...n.Error,Type:n.Error.Type,Code:n.Error.Code,Message:n.Error.message??n.Error.Message??o};let s=n.$metadata.requestId;return s&&(n.RequestId=s),n}return Pm(t,r)}setQueryCompatError(t,r){let o=r.headers?.["x-amzn-query-error"];if(t!==void 0&&o!=null){let[n,s]=o.split(";"),i=Object.entries(t),a={Code:n,Type:s};Object.assign(t,a);for(let[c,l]of i)a[c==="message"?"Message":c]=l;delete a.__type,t.Error=a}}queryCompatOutput(t,r){t.Error&&(r.Error=t.Error),t.Type&&(r.Type=t.Type),t.Code&&(r.Code=t.Code)}findQueryCompatibleError(t,r){try{return t.getSchema(r)}catch{return t.find(n=>M.of(n).getMergedTraits().awsQueryError?.[0]===r)}}}});var GR=d(()=>{});var jR=d(()=>{});var xr,ii=d(()=>{xr=class{serdeContext;setSerdeContext(t){this.serdeContext=t}}});function*$d(e,t){if(e.isUnitSchema())return;let r=e.getSchema();for(let o=0;o<r[4].length;++o){let n=r[4][o],s=r[5][o],i=new M([s,0],n);!(n in t)&&!i.isIdempotencyToken()||(yield[n,i])}}function*WR(e,t,r){if(e.isUnitSchema())return;let o=e.getSchema(),n=Object.keys(t).filter(s=>s!=="__type").length;for(let s=0;s<o[4].length&&n!==0;++s){let i=o[4][s],a=o[5][s],c=new M([a,0],i),l=i;r&&(l=c.getMergedTraits()[r]??i),l in t&&(yield[i,c],n-=1)}}var Md=d(()=>{ae()});var ai,Nm=d(()=>{ai=class{from;to;keys;constructor(t,r){this.from=t,this.to=r,this.keys=new Set(Object.keys(this.from).filter(o=>o!=="__type"))}mark(t){this.keys.delete(t)}hasUnknown(){return this.keys.size===1&&Object.keys(this.to).length===0}writeUnknown(){if(this.hasUnknown()){let t=this.keys.values().next().value,r=this.from[t];this.to.$unknown=[t,r]}}}});function zR(e,t,r){if(r?.source){let o=r.source;if(typeof t=="number"&&(t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER||o!==String(t)))return o.includes(".")?new He(o,"bigDecimal"):BigInt(o)}return t}var KR=d(()=>{ao()});var qR,JR=d(()=>{N();Ae();qR=(e,t)=>St(e,t).then(r=>(t?.utf8Encoder??Se)(r))});var YR,Ld,fa=d(()=>{JR();YR=(e,t)=>qR(e,t).then(r=>{if(r.length)try{return JSON.parse(r)}catch(o){throw o?.name==="SyntaxError"&&Object.defineProperty(o,"$responseBodyText",{value:r}),o}return{}}),Ld=(e,t)=>{let r=(s,i)=>Object.keys(s).find(a=>a.toLowerCase()===i.toLowerCase()),o=s=>{let i=s;return typeof i=="number"&&(i=i.toString()),i.indexOf(",")>=0&&(i=i.split(",")[0]),i.indexOf(":")>=0&&(i=i.split(":")[0]),i.indexOf("#")>=0&&(i=i.split("#")[1]),i},n=r(e.headers,"x-amzn-errortype");if(n!==void 0)return o(e.headers[n]);if(t&&typeof t=="object"){let s=r(t,"code");if(s&&t[s]!==void 0)return o(t[s]);if(t.__type!==void 0)return o(t.__type)}}});var ci,Om=d(()=>{Uo();ae();ao();et();ii();Md();Nm();KR();fa();ci=class extends xr{settings;constructor(t){super(),this.settings=t}async read(t,r){return this._read(t,typeof r=="string"?JSON.parse(r,zR):await YR(r,this.serdeContext))}readObject(t,r){return this._read(t,r)}_read(t,r){let o=r!==null&&typeof r=="object",n=M.of(t);if(o){if(n.isStructSchema()){let i=n.isUnionSchema(),a={},c;i&&(c=new ai(r,a));for(let[l,p]of WR(n,r,this.settings.jsonName?"jsonName":!1)){let u=this.settings.jsonName?p.getMergedTraits().jsonName??l:l;i&&c.mark(u),r[u]!=null&&(a[l]=this._read(p,r[u]))}return i&&c.writeUnknown(),a}if(Array.isArray(r)&&n.isListSchema()){let i=n.getValueSchema(),a=[],c=!!n.getMergedTraits().sparse;for(let l of r)(c||l!=null)&&a.push(this._read(i,l));return a}if(n.isMapSchema()){let i=n.getValueSchema(),a={},c=!!n.getMergedTraits().sparse;for(let[l,p]of Object.entries(r))(c||p!=null)&&(a[l]=this._read(i,p));return a}}if(n.isBlobSchema()&&typeof r=="string")return Ie(r);let s=n.getMergedTraits().mediaType;if(n.isStringSchema()&&typeof r=="string"&&s)return s==="application/json"||s.endsWith("+json")?Et.from(r):r;if(n.isTimestampSchema()&&r!=null)switch(lo(n,this.settings)){case 5:return ZE(r);case 6:return e_(r);case 7:return t_(r);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",r),new Date(r)}if(n.isBigIntegerSchema()&&(typeof r=="number"||typeof r=="string"))return BigInt(r);if(n.isBigDecimalSchema()&&r!=null){if(r instanceof He)return r;let i=r;return i.type==="bigDecimal"&&"string"in i?new He(i.string,i.type):new He(String(r),"bigDecimal")}if(n.isNumericSchema()&&typeof r=="string"){switch(r){case"Infinity":return 1/0;case"-Infinity":return-1/0;case"NaN":return NaN}return r}if(n.isDocumentSchema())if(o){let i=Array.isArray(r)?[]:{};for(let[a,c]of Object.entries(r))c instanceof He?i[a]=c:i[a]=this._read(n,c);return i}else return structuredClone(r);return r}}});var XR,Ud,QR=d(()=>{ao();XR="\u039D",Ud=class{values=new Map;counter=0;stage=0;createReplacer(){if(this.stage===1)throw new Error("@aws-sdk/core/protocols - JsonReplacer already created.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");return this.stage=1,(t,r)=>{if(r instanceof He){let o=`${XR+"nv"+this.counter++}_`+r.string;return this.values.set(`"${o}"`,r.string),o}if(typeof r=="bigint"){let o=r.toString(),n=`${XR+"b"+this.counter++}_`+o;return this.values.set(`"${n}"`,o),n}return r}}replaceInJson(t){if(this.stage===0)throw new Error("@aws-sdk/core/protocols - JsonReplacer not created yet.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");if(this.stage=2,this.counter===0)return t;for(let[r,o]of this.values)t=t.replace(r,o);return t}}});var di,km=d(()=>{Uo();ae();ao();et();ii();Md();QR();di=class extends xr{settings;buffer;useReplacer=!1;rootSchema;constructor(t){super(),this.settings=t}write(t,r){this.rootSchema=M.of(t),this.buffer=this._write(this.rootSchema,r)}writeDiscriminatedDocument(t,r){this.write(t,r),typeof this.buffer=="object"&&(this.buffer.__type=M.of(t).getName(!0))}flush(){let{rootSchema:t,useReplacer:r}=this;if(this.rootSchema=void 0,this.useReplacer=!1,t?.isStructSchema()||t?.isDocumentSchema()){if(!r)return JSON.stringify(this.buffer);let o=new Ud;return o.replaceInJson(JSON.stringify(this.buffer,o.createReplacer(),0))}return this.buffer}_write(t,r,o){let n=r!==null&&typeof r=="object",s=M.of(t);if(n){if(s.isStructSchema()){let i={};for(let[a,c]of $d(s,r)){let l=this._write(c,r[a],s);if(l!==void 0){let p=c.getMergedTraits().jsonName,u=this.settings.jsonName?p??a:a;i[u]=l}}if(s.isUnionSchema()&&Object.keys(i).length===0){let{$unknown:a}=r;if(Array.isArray(a)){let[c,l]=a;i[c]=this._write(15,l)}}return i}if(Array.isArray(r)&&s.isListSchema()){let i=s.getValueSchema(),a=[],c=!!s.getMergedTraits().sparse;for(let l of r)(c||l!=null)&&a.push(this._write(i,l));return a}if(s.isMapSchema()){let i=s.getValueSchema(),a={},c=!!s.getMergedTraits().sparse;for(let[l,p]of Object.entries(r))(c||p!=null)&&(a[l]=this._write(i,p));return a}if(r instanceof Uint8Array&&(s.isBlobSchema()||s.isDocumentSchema()))return s===this.rootSchema?r:(this.serdeContext?.base64Encoder??Ee)(r);if(r instanceof Date&&(s.isTimestampSchema()||s.isDocumentSchema()))switch(lo(s,this.settings)){case 5:return r.toISOString().replace(".000Z","Z");case 6:return Qs(r);case 7:return r.getTime()/1e3;default:return console.warn("Missing timestamp format, using epoch seconds",r),r.getTime()/1e3}r instanceof He&&(this.useReplacer=!0)}if(!(r===null&&o?.isStructSchema())){if(s.isStringSchema()){if(typeof r>"u"&&s.isIdempotencyToken())return Mo();let i=s.getMergedTraits().mediaType;return r!=null&&i&&(i==="application/json"||i.endsWith("+json"))?Et.from(r):r}if(typeof r=="number"&&s.isNumericSchema())return Math.abs(r)===1/0||isNaN(r)?String(r):r;if(typeof r=="string"&&s.isBlobSchema())return s===this.rootSchema?r:(this.serdeContext?.base64Encoder??Ee)(r);if(typeof r=="bigint"&&(this.useReplacer=!0),s.isDocumentSchema())if(n){let i=Array.isArray(r)?[]:{};for(let[a,c]of Object.entries(r))c instanceof He?(this.useReplacer=!0,i[a]=c):i[a]=this._write(s,c);return i}else return structuredClone(r);return r}}}});var un,Fd=d(()=>{ii();Om();km();un=class extends xr{settings;constructor(t){super(),this.settings=t}createSerializer(){let t=new di(this.settings);return t.setSerdeContext(this.serdeContext),t}createDeserializer(){let t=new ci(this.settings);return t.setSerdeContext(this.serdeContext),t}}});var Bd,$m=d(()=>{Uo();ae();kd();Fd();fa();Bd=class extends ti{serializer;deserializer;serviceTarget;codec;mixin;awsQueryCompatible;constructor({defaultNamespace:t,serviceTarget:r,awsQueryCompatible:o,jsonCodec:n}){super({defaultNamespace:t}),this.serviceTarget=r,this.codec=n??new un({timestampFormat:{useTrait:!0,default:7},jsonName:!1}),this.serializer=this.codec.createSerializer(),this.deserializer=this.codec.createDeserializer(),this.awsQueryCompatible=!!o,this.mixin=new pn(this.awsQueryCompatible)}async serializeRequest(t,r,o){let n=await super.serializeRequest(t,r,o);return n.path.endsWith("/")||(n.path+="/"),Object.assign(n.headers,{"content-type":`application/x-amz-json-${this.getJsonRpcVersion()}`,"x-amz-target":`${this.serviceTarget}.${t.name}`}),this.awsQueryCompatible&&(n.headers["x-amzn-query-mode"]="true"),(sn(t.input)==="unit"||!n.body)&&(n.body="{}"),n}getPayloadCodec(){return this.codec}async handleError(t,r,o,n,s){this.awsQueryCompatible&&this.mixin.setQueryCompatError(n,o);let i=Ld(o,n)??"Unknown",{errorSchema:a,errorMetadata:c}=await this.mixin.getErrorSchemaOrThrowBaseException(i,this.options.defaultNamespace,o,n,s,this.awsQueryCompatible?this.mixin.findQueryCompatibleError:void 0),l=M.of(a),p=n.message??n.Message??"Unknown",u=S.for(a[1]).getErrorCtor(a)??Error,f=new u(p),m={};for(let[h,g]of l.structIterator())n[h]!=null&&(m[h]=this.codec.createDeserializer().readObject(g,n[h]));throw this.awsQueryCompatible&&this.mixin.queryCompatOutput(n,m),this.mixin.decorateServiceException(Object.assign(f,c,{$fault:l.getMergedTraits().error,message:p},m),n)}}});var Hd,ZR=d(()=>{$m();Hd=class extends Bd{constructor({defaultNamespace:t,serviceTarget:r,awsQueryCompatible:o,jsonCodec:n}){super({defaultNamespace:t,serviceTarget:r,awsQueryCompatible:o,jsonCodec:n})}getShapeId(){return"aws.protocols#awsJson1_0"}getJsonRpcVersion(){return"1.0"}getDefaultContentType(){return"application/x-amz-json-1.0"}}});var eI=d(()=>{});var fn,tI=d(()=>{Uo();ae();kd();Fd();fa();fn=class extends hd{serializer;deserializer;codec;mixin=new pn;constructor({defaultNamespace:t}){super({defaultNamespace:t});let r={timestampFormat:{useTrait:!0,default:7},httpBindings:!0,jsonName:!0};this.codec=new un(r),this.serializer=new Sd(this.codec.createSerializer(),r),this.deserializer=new xd(this.codec.createDeserializer(),r)}getShapeId(){return"aws.protocols#restJson1"}getPayloadCodec(){return this.codec}setSerdeContext(t){this.codec.setSerdeContext(t),super.setSerdeContext(t)}async serializeRequest(t,r,o){let n=await super.serializeRequest(t,r,o),s=M.of(t.input);if(!n.headers["content-type"]){let i=this.mixin.resolveRestContentType(this.getDefaultContentType(),s);i&&(n.headers["content-type"]=i)}return n.body==null&&n.headers["content-type"]===this.getDefaultContentType()&&(n.body="{}"),n}async deserializeResponse(t,r,o){let n=await super.deserializeResponse(t,r,o),s=M.of(t.output);for(let[i,a]of s.structIterator())a.getMemberTraits().httpPayload&&!(i in n)&&(n[i]=null);return n}async handleError(t,r,o,n,s){let i=Ld(o,n)??"Unknown",{errorSchema:a,errorMetadata:c}=await this.mixin.getErrorSchemaOrThrowBaseException(i,this.options.defaultNamespace,o,n,s),l=M.of(a),p=n.message??n.Message??"Unknown",u=S.for(a[1]).getErrorCtor(a)??Error,f=new u(p);await this.deserializeHttpMessage(a,r,o,n);let m={};for(let[h,g]of l.structIterator()){let E=g.getMergedTraits().jsonName??h;m[h]=this.codec.createDeserializer().readObject(g,n[E])}throw this.mixin.decorateServiceException(Object.assign(f,c,{$fault:l.getMergedTraits().error,message:p},m),n)}getDefaultContentType(){return"application/json"}}});var rI=d(()=>{});var oI=d(()=>{});var nI=d(()=>{});function Vd(e,t){let r=[],o=t.exec(e);for(;o;){let n=[];n.startIndex=t.lastIndex-o[0].length;let s=o.length;for(let i=0;i<s;i++)n.push(o[i]);r.push(n),o=t.exec(e)}return r}function iI(e){return typeof e<"u"}var sI,WM,zM,KM,ma,Gd=d(()=>{"use strict";sI=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",WM=sI+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",zM="["+sI+"]["+WM+"]*",KM=new RegExp("^"+zM+"$");ma=function(e){let t=KM.exec(e);return!(t===null||typeof t>"u")}});function pI(e,t){t=Object.assign({},qM,t);let r=[],o=!1,n=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let s=0;s<e.length;s++)if(e[s]==="<"&&e[s+1]==="?"){if(s+=2,s=cI(e,s),s.err)return s}else if(e[s]==="<"){let i=s;if(s++,e[s]==="!"){s=dI(e,s);continue}else{let a=!1;e[s]==="/"&&(a=!0,s++);let c="";for(;s<e.length&&e[s]!==">"&&e[s]!==" "&&e[s]!=="	"&&e[s]!==`
`&&e[s]!=="\r";s++)c+=e[s];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),s--),!rL(c)){let u;return c.trim().length===0?u="Invalid space after '<'.":u="Tag '"+c+"' is an invalid name.",De("InvalidTag",u,pt(e,s))}let l=XM(e,s);if(l===!1)return De("InvalidAttr","Attributes for '"+c+"' have open quote.",pt(e,s));let p=l.value;if(s=l.index,p[p.length-1]==="/"){let u=s-p.length;p=p.substring(0,p.length-1);let f=lI(p,t);if(f===!0)o=!0;else return De(f.err.code,f.err.msg,pt(e,u+f.err.line))}else if(a)if(l.tagClosed){if(p.trim().length>0)return De("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",pt(e,i));if(r.length===0)return De("InvalidTag","Closing tag '"+c+"' has not been opened.",pt(e,i));{let u=r.pop();if(c!==u.tagName){let f=pt(e,u.tagStartPos);return De("InvalidTag","Expected closing tag '"+u.tagName+"' (opened in line "+f.line+", col "+f.col+") instead of closing tag '"+c+"'.",pt(e,i))}r.length==0&&(n=!0)}}else return De("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",pt(e,s));else{let u=lI(p,t);if(u!==!0)return De(u.err.code,u.err.msg,pt(e,s-p.length+u.err.line));if(n===!0)return De("InvalidXml","Multiple possible root nodes found.",pt(e,s));t.unpairedTags.indexOf(c)!==-1||r.push({tagName:c,tagStartPos:i}),o=!0}for(s++;s<e.length;s++)if(e[s]==="<")if(e[s+1]==="!"){s++,s=dI(e,s);continue}else if(e[s+1]==="?"){if(s=cI(e,++s),s.err)return s}else break;else if(e[s]==="&"){let u=eL(e,s);if(u==-1)return De("InvalidChar","char '&' is not expected.",pt(e,s));s=u}else if(n===!0&&!aI(e[s]))return De("InvalidXml","Extra text at the end",pt(e,s));e[s]==="<"&&s--}}else{if(aI(e[s]))continue;return De("InvalidChar","char '"+e[s]+"' is not expected.",pt(e,s))}if(o){if(r.length==1)return De("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",pt(e,r[0].tagStartPos));if(r.length>0)return De("InvalidXml","Invalid '"+JSON.stringify(r.map(s=>s.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return De("InvalidXml","Start tag expected.",1);return!0}function aI(e){return e===" "||e==="	"||e===`
`||e==="\r"}function cI(e,t){let r=t;for(;t<e.length;t++)if(e[t]=="?"||e[t]==" "){let o=e.substr(r,t-r);if(t>5&&o==="xml")return De("InvalidXml","XML declaration allowed only at the start of the document.",pt(e,t));if(e[t]=="?"&&e[t+1]==">"){t++;break}else continue}return t}function dI(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++)if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let r=1;for(t+=8;t<e.length;t++)if(e[t]==="<")r++;else if(e[t]===">"&&(r--,r===0))break}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++)if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}return t}function XM(e,t){let r="",o="",n=!1;for(;t<e.length;t++){if(e[t]===JM||e[t]===YM)o===""?o=e[t]:o!==e[t]||(o="");else if(e[t]===">"&&o===""){n=!0;break}r+=e[t]}return o!==""?!1:{value:r,index:t,tagClosed:n}}function lI(e,t){let r=Vd(e,QM),o={};for(let n=0;n<r.length;n++){if(r[n][1].length===0)return De("InvalidAttr","Attribute '"+r[n][2]+"' has no space in starting.",ha(r[n]));if(r[n][3]!==void 0&&r[n][4]===void 0)return De("InvalidAttr","Attribute '"+r[n][2]+"' is without value.",ha(r[n]));if(r[n][3]===void 0&&!t.allowBooleanAttributes)return De("InvalidAttr","boolean attribute '"+r[n][2]+"' is not allowed.",ha(r[n]));let s=r[n][2];if(!tL(s))return De("InvalidAttr","Attribute '"+s+"' is an invalid name.",ha(r[n]));if(!o.hasOwnProperty(s))o[s]=1;else return De("InvalidAttr","Attribute '"+s+"' is repeated.",ha(r[n]))}return!0}function ZM(e,t){let r=/\d/;for(e[t]==="x"&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(r))break}return-1}function eL(e,t){if(t++,e[t]===";")return-1;if(e[t]==="#")return t++,ZM(e,t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(e[t]===";")break;return-1}return t}function De(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function tL(e){return ma(e)}function rL(e){return ma(e)}function pt(e,t){let r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function ha(e){return e.startIndex+e[1].length}var qM,JM,YM,QM,uI=d(()=>{"use strict";Gd();qM={allowBooleanAttributes:!1,unpairedTags:[]};JM='"',YM="'";QM=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g")});var oL,fI,mI=d(()=>{oL={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e},captureMetaData:!1},fI=function(e){return Object.assign({},oL,e)}});var jd,Mt,Wd=d(()=>{"use strict";typeof Symbol!="function"?jd="@@xmlMetadata":jd=Symbol("XML Node Metadata");Mt=class{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,r){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:r})}addChild(t,r){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child}),r!==void 0&&(this.child[this.child.length-1][jd]={startIndex:r})}static getMetaDataSymbol(){return jd}}});function Mm(e,t){let r={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let o=1,n=!1,s=!1,i="";for(;t<e.length;t++)if(e[t]==="<"&&!s){if(n&&cs(e,"!ENTITY",t)){t+=7;let a,c;[a,c,t]=nL(e,t+1),c.indexOf("&")===-1&&(r[a]={regx:RegExp(`&${a};`,"g"),val:c})}else if(n&&cs(e,"!ELEMENT",t)){t+=8;let{index:a}=iL(e,t+1);t=a}else if(n&&cs(e,"!ATTLIST",t))t+=8;else if(n&&cs(e,"!NOTATION",t)){t+=9;let{index:a}=sL(e,t+1);t=a}else if(cs(e,"!--",t))s=!0;else throw new Error("Invalid DOCTYPE");o++,i=""}else if(e[t]===">"){if(s?e[t-1]==="-"&&e[t-2]==="-"&&(s=!1,o--):o--,o===0)break}else e[t]==="["?n=!0:i+=e[t];if(o!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:t}}function nL(e,t){t=mn(e,t);let r="";for(;t<e.length&&!/\s/.test(e[t])&&e[t]!=='"'&&e[t]!=="'";)r+=e[t],t++;if(Lm(r),t=mn(e,t),e.substring(t,t+6).toUpperCase()==="SYSTEM")throw new Error("External entities are not supported");if(e[t]==="%")throw new Error("Parameter entities are not supported");let o="";return[t,o]=zd(e,t,"entity"),t--,[r,o,t]}function sL(e,t){t=mn(e,t);let r="";for(;t<e.length&&!/\s/.test(e[t]);)r+=e[t],t++;Lm(r),t=mn(e,t);let o=e.substring(t,t+6).toUpperCase();if(o!=="SYSTEM"&&o!=="PUBLIC")throw new Error(`Expected SYSTEM or PUBLIC, found "${o}"`);t+=o.length,t=mn(e,t);let n=null,s=null;if(o==="PUBLIC")[t,n]=zd(e,t,"publicIdentifier"),t=mn(e,t),(e[t]==='"'||e[t]==="'")&&([t,s]=zd(e,t,"systemIdentifier"));else if(o==="SYSTEM"&&([t,s]=zd(e,t,"systemIdentifier"),!s))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:r,publicIdentifier:n,systemIdentifier:s,index:--t}}function zd(e,t,r){let o="",n=e[t];if(n!=='"'&&n!=="'")throw new Error(`Expected quoted string, found "${n}"`);for(t++;t<e.length&&e[t]!==n;)o+=e[t],t++;if(e[t]!==n)throw new Error(`Unterminated ${r} value`);return t++,[t,o]}function iL(e,t){t=mn(e,t);let r="";for(;t<e.length&&!/\s/.test(e[t]);)r+=e[t],t++;if(!Lm(r))throw new Error(`Invalid element name: "${r}"`);t=mn(e,t);let o="";if(e[t]==="E"&&cs(e,"MPTY",t))t+=4;else if(e[t]==="A"&&cs(e,"NY",t))t+=2;else if(e[t]==="("){for(t++;t<e.length&&e[t]!==")";)o+=e[t],t++;if(e[t]!==")")throw new Error("Unterminated content model")}else throw new Error(`Invalid Element Expression, found "${e[t]}"`);return{elementName:r,contentModel:o.trim(),index:t}}function cs(e,t,r){for(let o=0;o<t.length;o++)if(t[o]!==e[r+o+1])return!1;return!0}function Lm(e){if(ma(e))return e;throw new Error(`Invalid entity name ${e}`)}var mn,hI=d(()=>{Gd();mn=(e,t)=>{for(;t<e.length&&/\s/.test(e[t]);)t++;return t}});function Um(e,t={}){if(t=Object.assign({},dL,t),!e||typeof e!="string")return e;let r=e.trim();if(t.skipLike!==void 0&&t.skipLike.test(r))return e;if(e==="0")return 0;if(t.hex&&aL.test(r))return fL(r,16);if(r.includes("e")||r.includes("E"))return pL(e,r,t);{let o=cL.exec(r);if(o){let n=o[1]||"",s=o[2],i=uL(o[3]),a=n?e[s.length+1]===".":e[s.length]===".";if(!t.leadingZeros&&(s.length>1||s.length===1&&!a))return e;{let c=Number(r),l=String(c);if(c===0)return c;if(l.search(/[eE]/)!==-1)return t.eNotation?c:e;if(r.indexOf(".")!==-1)return l==="0"||l===i||l===`${n}${i}`?c:e;let p=s?i:r;return s?p===l||n+p===l?c:e:p===l||p===n+l?c:e}}else return e}}function pL(e,t,r){if(!r.eNotation)return e;let o=t.match(lL);if(o){let n=o[1]||"",s=o[3].indexOf("e")===-1?"E":"e",i=o[2],a=n?e[i.length+1]===s:e[i.length]===s;return i.length>1&&a?e:i.length===1&&(o[3].startsWith(`.${s}`)||o[3][0]===s)?Number(t):r.leadingZeros&&!a?(t=(o[1]||"")+o[3],Number(t)):e}else return e}function uL(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substring(0,e.length-1))),e}function fL(e,t){if(parseInt)return parseInt(e,t);if(Number.parseInt)return Number.parseInt(e,t);if(window&&window.parseInt)return window.parseInt(e,t);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}var aL,cL,dL,lL,gI=d(()=>{aL=/^[-+]?0x[a-fA-F0-9]+$/,cL=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,dL={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};lL=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/});function Fm(e){return typeof e=="function"?e:Array.isArray(e)?t=>{for(let r of e)if(typeof r=="string"&&t===r||r instanceof RegExp&&r.test(t))return!0}:()=>!1}var xI=d(()=>{});function mL(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let o=t[r];this.lastEntities[o]={regex:new RegExp("&"+o+";","g"),val:e[o]}}}function hL(e,t,r,o,n,s,i){if(e!==void 0&&(this.options.trimValues&&!o&&(e=e.trim()),e.length>0)){i||(e=this.replaceEntitiesValue(e));let a=this.options.tagValueProcessor(t,e,r,n,s);return a==null?e:typeof a!=typeof e||a!==e?a:this.options.trimValues?Hm(e,this.options.parseTagValue,this.options.numberParseOptions):e.trim()===e?Hm(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function gL(e){if(this.options.removeNSPrefix){let t=e.split(":"),r=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(e=r+t[1])}return e}function yL(e,t,r){if(this.options.ignoreAttributes!==!0&&typeof e=="string"){let o=Vd(e,xL),n=o.length,s={};for(let i=0;i<n;i++){let a=this.resolveNameSpace(o[i][1]);if(this.ignoreAttributesFn(a,t))continue;let c=o[i][4],l=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);let p=this.options.attributeValueProcessor(a,c,t);p==null?s[l]=c:typeof p!=typeof c||p!==c?s[l]=p:s[l]=Hm(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(s[l]=!0)}if(!Object.keys(s).length)return;if(this.options.attributesGroupName){let i={};return i[this.options.attributesGroupName]=s,i}return s}}function EL(e,t,r,o){this.options.captureMetaData||(o=void 0);let n=this.options.updateTag(t.tagname,r,t[":@"]);n===!1||(typeof n=="string"&&(t.tagname=n),e.addChild(t,o))}function bL(e,t,r,o){return e&&(o===void 0&&(o=t.child.length===0),e=this.parseTextData(e,t.tagname,r,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,o),e!==void 0&&e!==""&&t.add(this.options.textNodeName,e),e=""),e}function wL(e,t,r){let o="*."+r;for(let n in e){let s=e[n];if(o===s||t===s)return!0}return!1}function RL(e,t,r=">"){let o,n="";for(let s=t;s<e.length;s++){let i=e[s];if(o)i===o&&(o="");else if(i==='"'||i==="'")o=i;else if(i===r[0])if(r[1]){if(e[s+1]===r[1])return{data:n,index:s}}else return{data:n,index:s};else i==="	"&&(i=" ");n+=i}}function ds(e,t,r,o){let n=e.indexOf(t,r);if(n===-1)throw new Error(o);return n+t.length-1}function Bm(e,t,r,o=">"){let n=RL(e,t+1,o);if(!n)return;let s=n.data,i=n.index,a=s.search(/\s/),c=s,l=!0;a!==-1&&(c=s.substring(0,a),s=s.substring(a+1).trimStart());let p=c;if(r){let u=c.indexOf(":");u!==-1&&(c=c.substr(u+1),l=c!==n.data.substr(u+1))}return{tagName:c,tagExp:s,closeIndex:i,attrExpPresent:l,rawTagName:p}}function IL(e,t,r){let o=r,n=1;for(;r<e.length;r++)if(e[r]==="<")if(e[r+1]==="/"){let s=ds(e,">",r,`${t} is not closed`);if(e.substring(r+2,s).trim()===t&&(n--,n===0))return{tagContent:e.substring(o,r),i:s};r=s}else if(e[r+1]==="?")r=ds(e,"?>",r+1,"StopNode is not closed.");else if(e.substr(r+1,3)==="!--")r=ds(e,"-->",r+3,"StopNode is not closed.");else if(e.substr(r+1,2)==="![")r=ds(e,"]]>",r,"StopNode is not closed.")-2;else{let s=Bm(e,r,">");s&&((s&&s.tagName)===t&&s.tagExp[s.tagExp.length-1]!=="/"&&n++,r=s.closeIndex)}}function Hm(e,t,r){if(t&&typeof e=="string"){let o=e.trim();return o==="true"?!0:o==="false"?!1:Um(e,r)}else return iI(e)?e:""}var ga,xL,SL,_L,yI=d(()=>{"use strict";Gd();Wd();hI();gI();xI();ga=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(r,o)=>String.fromCodePoint(Number.parseInt(o,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(r,o)=>String.fromCodePoint(Number.parseInt(o,16))}},this.addExternalEntities=mL,this.parseXml=SL,this.parseTextData=hL,this.resolveNameSpace=gL,this.buildAttributesMap=yL,this.isItStopNode=wL,this.replaceEntitiesValue=_L,this.readStopNodeData=IL,this.saveTextToParentTag=bL,this.addChild=EL,this.ignoreAttributesFn=Fm(this.options.ignoreAttributes)}};xL=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");SL=function(e){e=e.replace(/\r\n?/g,`
`);let t=new Mt("!xml"),r=t,o="",n="";for(let s=0;s<e.length;s++)if(e[s]==="<")if(e[s+1]==="/"){let a=ds(e,">",s,"Closing Tag is not closed."),c=e.substring(s+2,a).trim();if(this.options.removeNSPrefix){let u=c.indexOf(":");u!==-1&&(c=c.substr(u+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&(o=this.saveTextToParentTag(o,r,n));let l=n.substring(n.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let p=0;l&&this.options.unpairedTags.indexOf(l)!==-1?(p=n.lastIndexOf(".",n.lastIndexOf(".")-1),this.tagsNodeStack.pop()):p=n.lastIndexOf("."),n=n.substring(0,p),r=this.tagsNodeStack.pop(),o="",s=a}else if(e[s+1]==="?"){let a=Bm(e,s,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(o=this.saveTextToParentTag(o,r,n),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){let c=new Mt(a.tagName);c.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(c[":@"]=this.buildAttributesMap(a.tagExp,n,a.tagName)),this.addChild(r,c,n,s)}s=a.closeIndex+1}else if(e.substr(s+1,3)==="!--"){let a=ds(e,"-->",s+4,"Comment is not closed.");if(this.options.commentPropName){let c=e.substring(s+4,a-2);o=this.saveTextToParentTag(o,r,n),r.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}s=a}else if(e.substr(s+1,2)==="!D"){let a=Mm(e,s);this.docTypeEntities=a.entities,s=a.i}else if(e.substr(s+1,2)==="!["){let a=ds(e,"]]>",s,"CDATA is not closed.")-2,c=e.substring(s+9,a);o=this.saveTextToParentTag(o,r,n);let l=this.parseTextData(c,r.tagname,n,!0,!1,!0,!0);l==null&&(l=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]):r.add(this.options.textNodeName,l),s=a+2}else{let a=Bm(e,s,this.options.removeNSPrefix),c=a.tagName,l=a.rawTagName,p=a.tagExp,u=a.attrExpPresent,f=a.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&o&&r.tagname!=="!xml"&&(o=this.saveTextToParentTag(o,r,n,!1));let m=r;m&&this.options.unpairedTags.indexOf(m.tagname)!==-1&&(r=this.tagsNodeStack.pop(),n=n.substring(0,n.lastIndexOf("."))),c!==t.tagname&&(n+=n?"."+c:c);let h=s;if(this.isItStopNode(this.options.stopNodes,n,c)){let g="";if(p.length>0&&p.lastIndexOf("/")===p.length-1)c[c.length-1]==="/"?(c=c.substr(0,c.length-1),n=n.substr(0,n.length-1),p=c):p=p.substr(0,p.length-1),s=a.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)s=a.closeIndex;else{let w=this.readStopNodeData(e,l,f+1);if(!w)throw new Error(`Unexpected end of ${l}`);s=w.i,g=w.tagContent}let E=new Mt(c);c!==p&&u&&(E[":@"]=this.buildAttributesMap(p,n,c)),g&&(g=this.parseTextData(g,c,n,!0,u,!0,!0)),n=n.substr(0,n.lastIndexOf(".")),E.add(this.options.textNodeName,g),this.addChild(r,E,n,h)}else{if(p.length>0&&p.lastIndexOf("/")===p.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),n=n.substr(0,n.length-1),p=c):p=p.substr(0,p.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));let g=new Mt(c);c!==p&&u&&(g[":@"]=this.buildAttributesMap(p,n,c)),this.addChild(r,g,n,h),n=n.substr(0,n.lastIndexOf("."))}else{let g=new Mt(c);this.tagsNodeStack.push(r),c!==p&&u&&(g[":@"]=this.buildAttributesMap(p,n,c)),this.addChild(r,g,n,h),r=g}o="",s=f}}else o+=e[s];return t.child};_L=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){let r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){let r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){let r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e}});function Gm(e,t){return SI(e,t)}function SI(e,t,r){let o,n={};for(let s=0;s<e.length;s++){let i=e[s],a=TL(i),c="";if(r===void 0?c=a:c=r+"."+a,a===t.textNodeName)o===void 0?o=i[a]:o+=""+i[a];else{if(a===void 0)continue;if(i[a]){let l=SI(i[a],t,c),p=CL(l,t);i[Vm]!==void 0&&(l[Vm]=i[Vm]),i[":@"]?vL(l,i[":@"],c,t):Object.keys(l).length===1&&l[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?l=l[t.textNodeName]:Object.keys(l).length===0&&(t.alwaysCreateTextNode?l[t.textNodeName]="":l=""),n[a]!==void 0&&n.hasOwnProperty(a)?(Array.isArray(n[a])||(n[a]=[n[a]]),n[a].push(l)):t.isArray(a,c,p)?n[a]=[l]:n[a]=l}}}return typeof o=="string"?o.length>0&&(n[t.textNodeName]=o):o!==void 0&&(n[t.textNodeName]=o),n}function TL(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let o=t[r];if(o!==":@")return o}}function vL(e,t,r,o){if(t){let n=Object.keys(t),s=n.length;for(let i=0;i<s;i++){let a=n[i];o.isArray(a,r+"."+a,!0,!0)?e[a]=[t[a]]:e[a]=t[a]}}}function CL(e,t){let{textNodeName:r}=t,o=Object.keys(e).length;return!!(o===0||o===1&&(e[r]||typeof e[r]=="boolean"||e[r]===0))}var Vm,EI=d(()=>{"use strict";Wd();Vm=Mt.getMetaDataSymbol()});var li,_I=d(()=>{mI();yI();EI();uI();Wd();li=class{constructor(t){this.externalEntities={},this.options=fI(t)}parse(t,r){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});let s=pI(t,r);if(s!==!0)throw Error(`${s.err.msg}:${s.err.line}:${s.err.col}`)}let o=new ga(this.options);o.addExternalEntities(this.externalEntities);let n=o.parseXml(t);return this.options.preserveOrder||n===void 0?n:Gm(n,this.options)}addEntity(t,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=r}static getMetaDataSymbol(){return Mt.getMetaDataSymbol()}}});var bI=d(()=>{"use strict";_I()});function Wm(e){return jm.parse(e,!0)}var jm,wI=d(()=>{bI();jm=new li({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(e,t)=>t.trim()===""&&t.includes(`
`)?"":void 0});jm.addEntity("#xD","\r");jm.addEntity("#10",`
`)});var RI=d(()=>{nI();oI();wI()});var Kd,zm=d(()=>{RI();Uo();ae();N();Ae();ii();Nm();Kd=class extends xr{settings;stringDeserializer;constructor(t){super(),this.settings=t,this.stringDeserializer=new ri(t)}setSerdeContext(t){this.serdeContext=t,this.stringDeserializer.setSerdeContext(t)}read(t,r,o){let n=M.of(t),s=n.getMemberSchemas();if(n.isStructSchema()&&n.isMemberSchema()&&!!Object.values(s).find(l=>!!l.getMemberTraits().eventPayload)){let l={},p=Object.keys(s)[0];return s[p].isBlobSchema()?l[p]=r:l[p]=this.read(s[p],r),l}let a=(this.serdeContext?.utf8Encoder??Se)(r),c=this.parseXml(a);return this.readSchema(t,o?c[o]:c)}readSchema(t,r){let o=M.of(t);if(o.isUnitSchema())return;let n=o.getMergedTraits();if(o.isListSchema()&&!Array.isArray(r))return this.readSchema(o,[r]);if(r==null)return r;if(typeof r=="object"){let s=!!n.sparse,i=!!n.xmlFlattened;if(o.isListSchema()){let c=o.getValueSchema(),l=[],p=c.getMergedTraits().xmlName??"member",u=i?r:(r[0]??r)[p],f=Array.isArray(u)?u:[u];for(let m of f)(m!=null||s)&&l.push(this.readSchema(c,m));return l}let a={};if(o.isMapSchema()){let c=o.getKeySchema(),l=o.getValueSchema(),p;i?p=Array.isArray(r)?r:[r]:p=Array.isArray(r.entry)?r.entry:[r.entry];let u=c.getMergedTraits().xmlName??"key",f=l.getMergedTraits().xmlName??"value";for(let m of p){let h=m[u],g=m[f];(g!=null||s)&&(a[h]=this.readSchema(l,g))}return a}if(o.isStructSchema()){let c=o.isUnionSchema(),l;c&&(l=new ai(r,a));for(let[p,u]of o.structIterator()){let f=u.getMergedTraits(),m=f.httpPayload?f.xmlName??u.getName():u.getMemberTraits().xmlName??p;c&&l.mark(m),r[m]!=null&&(a[p]=this.readSchema(u,r[m]))}return c&&l.writeUnknown(),a}if(o.isDocumentSchema())return r;throw new Error(`@aws-sdk/core/protocols - xml deserializer unhandled schema type for ${o.getName(!0)}`)}return o.isListSchema()?[]:o.isMapSchema()||o.isStructSchema()?{}:this.stringDeserializer.read(o,r)}parseXml(t){if(t.length){let r;try{r=Wm(t)}catch(i){throw i&&typeof i=="object"&&Object.defineProperty(i,"$responseBodyText",{value:t}),i}let o="#text",n=Object.keys(r)[0],s=r[n];return s[o]&&(s[n]=s[o],delete s[o]),Dm(s)}return{}}}});var qd,II=d(()=>{Uo();ae();ao();N();et();ii();Md();qd=class extends xr{settings;buffer;constructor(t){super(),this.settings=t}write(t,r,o=""){this.buffer===void 0&&(this.buffer="");let n=M.of(t);if(o&&!o.endsWith(".")&&(o+="."),n.isBlobSchema())(typeof r=="string"||r instanceof Uint8Array)&&(this.writeKey(o),this.writeValue((this.serdeContext?.base64Encoder??Ee)(r)));else if(n.isBooleanSchema()||n.isNumericSchema()||n.isStringSchema())r!=null?(this.writeKey(o),this.writeValue(String(r))):n.isIdempotencyToken()&&(this.writeKey(o),this.writeValue(Mo()));else if(n.isBigIntegerSchema())r!=null&&(this.writeKey(o),this.writeValue(String(r)));else if(n.isBigDecimalSchema())r!=null&&(this.writeKey(o),this.writeValue(r instanceof He?r.string:String(r)));else if(n.isTimestampSchema()){if(r instanceof Date)switch(this.writeKey(o),lo(n,this.settings)){case 5:this.writeValue(r.toISOString().replace(".000Z","Z"));break;case 6:this.writeValue(Qs(r));break;case 7:this.writeValue(String(r.getTime()/1e3));break}}else if(n.isDocumentSchema())Array.isArray(r)?this.write(79,r,o):r instanceof Date?this.write(4,r,o):r instanceof Uint8Array?this.write(21,r,o):r&&typeof r=="object"?this.write(143,r,o):(this.writeKey(o),this.writeValue(String(r)));else if(n.isListSchema()){if(Array.isArray(r))if(r.length===0)this.settings.serializeEmptyLists&&(this.writeKey(o),this.writeValue(""));else{let s=n.getValueSchema(),i=this.settings.flattenLists||n.getMergedTraits().xmlFlattened,a=1;for(let c of r){if(c==null)continue;let l=this.getKey("member",s.getMergedTraits().xmlName),p=i?`${o}${a}`:`${o}${l}.${a}`;this.write(s,c,p),++a}}}else if(n.isMapSchema()){if(r&&typeof r=="object"){let s=n.getKeySchema(),i=n.getValueSchema(),a=n.getMergedTraits().xmlFlattened,c=1;for(let[l,p]of Object.entries(r)){if(p==null)continue;let u=this.getKey("key",s.getMergedTraits().xmlName),f=a?`${o}${c}.${u}`:`${o}entry.${c}.${u}`,m=this.getKey("value",i.getMergedTraits().xmlName),h=a?`${o}${c}.${m}`:`${o}entry.${c}.${m}`;this.write(s,l,f),this.write(i,p,h),++c}}}else if(n.isStructSchema()){if(r&&typeof r=="object"){let s=!1;for(let[i,a]of $d(n,r)){if(r[i]==null&&!a.isIdempotencyToken())continue;let c=this.getKey(i,a.getMergedTraits().xmlName),l=`${o}${c}`;this.write(a,r[i],l),s=!0}if(!s&&n.isUnionSchema()){let{$unknown:i}=r;if(Array.isArray(i)){let[a,c]=i,l=`${o}${a}`;this.write(15,c,l)}}}}else if(!n.isUnitSchema())throw new Error(`@aws-sdk/core/protocols - QuerySerializer unrecognized schema type ${n.getName(!0)}`)}flush(){if(this.buffer===void 0)throw new Error("@aws-sdk/core/protocols - QuerySerializer cannot flush with nothing written to buffer.");let t=this.buffer;return delete this.buffer,t}getKey(t,r){let o=r??t;return this.settings.capitalizeKeys?o[0].toUpperCase()+o.slice(1):o}writeKey(t){t.endsWith(".")&&(t=t.slice(0,t.length-1)),this.buffer+=`&${Js(t)}=`}writeValue(t){this.buffer+=Js(t)}}});var pi,TI=d(()=>{Uo();ae();kd();zm();II();pi=class extends ti{options;serializer;deserializer;mixin=new pn;constructor(t){super({defaultNamespace:t.defaultNamespace}),this.options=t;let r={timestampFormat:{useTrait:!0,default:5},httpBindings:!1,xmlNamespace:t.xmlNamespace,serviceNamespace:t.defaultNamespace,serializeEmptyLists:!0};this.serializer=new qd(r),this.deserializer=new Kd(r)}getShapeId(){return"aws.protocols#awsQuery"}setSerdeContext(t){this.serializer.setSerdeContext(t),this.deserializer.setSerdeContext(t)}getPayloadCodec(){throw new Error("AWSQuery protocol has no payload codec.")}async serializeRequest(t,r,o){let n=await super.serializeRequest(t,r,o);n.path.endsWith("/")||(n.path+="/"),Object.assign(n.headers,{"content-type":"application/x-www-form-urlencoded"}),(sn(t.input)==="unit"||!n.body)&&(n.body="");let s=t.name.split("#")[1]??t.name;return n.body=`Action=${s}&Version=${this.options.version}`+n.body,n.body.endsWith("&")&&(n.body=n.body.slice(-1)),n}async deserializeResponse(t,r,o){let n=this.deserializer,s=M.of(t.output),i={};if(o.statusCode>=300){let u=await St(o.body,r);u.byteLength>0&&Object.assign(i,await n.read(15,u)),await this.handleError(t,r,o,i,this.deserializeMetadata(o))}for(let u in o.headers){let f=o.headers[u];delete o.headers[u],o.headers[u.toLowerCase()]=f}let a=t.name.split("#")[1]??t.name,c=s.isStructSchema()&&this.useNestedResult()?a+"Result":void 0,l=await St(o.body,r);return l.byteLength>0&&Object.assign(i,await n.read(s,l,c)),{$metadata:this.deserializeMetadata(o),...i}}useNestedResult(){return!0}async handleError(t,r,o,n,s){let i=this.loadQueryErrorCode(o,n)??"Unknown",a=this.loadQueryError(n),c=this.loadQueryErrorMessage(n);a.message=c,a.Error={Type:a.Type,Code:a.Code,Message:c};let{errorSchema:l,errorMetadata:p}=await this.mixin.getErrorSchemaOrThrowBaseException(i,this.options.defaultNamespace,o,a,s,this.mixin.findQueryCompatibleError),u=M.of(l),f=S.for(l[1]).getErrorCtor(l)??Error,m=new f(c),h={Type:a.Error.Type,Code:a.Error.Code,Error:a.Error};for(let[g,E]of u.structIterator()){let w=E.getMergedTraits().xmlName??g,C=a[w]??n[w];h[g]=this.deserializer.readSchema(E,C)}throw this.mixin.decorateServiceException(Object.assign(m,p,{$fault:u.getMergedTraits().error,message:c},h),n)}loadQueryErrorCode(t,r){let o=(r.Errors?.[0]?.Error??r.Errors?.Error??r.Error)?.Code;if(o!==void 0)return o;if(t.statusCode==404)return"NotFound"}loadQueryError(t){return t.Errors?.[0]?.Error??t.Errors?.Error??t.Error}loadQueryErrorMessage(t){let r=this.loadQueryError(t);return r?.message??r?.Message??t.message??t.Message??"Unknown"}getDefaultContentType(){return"application/x-www-form-urlencoded"}}});var vI=d(()=>{});var CI=d(()=>{});var AI=d(()=>{});var PI=d(()=>{});var DI=d(()=>{});var Ho=d(()=>{GR();jR();ZR();eI();$m();tI();Fd();Om();km();rI();fa();vI();TI();DI();PI();zm();AI();CI()});var Ne=d(()=>{Ke();pR();Ho()});async function NI(e,t,r){if(r.request?.headers?.["smithy-protocol"]==="rpc-v2-cbor"&&$t(e,"PROTOCOL_RPC_V2_CBOR","M"),typeof t.retryStrategy=="function"){let s=await t.retryStrategy();typeof s.acquireInitialRetryToken=="function"?s.constructor?.name?.includes("Adaptive")?$t(e,"RETRY_MODE_ADAPTIVE","F"):$t(e,"RETRY_MODE_STANDARD","E"):$t(e,"RETRY_MODE_LEGACY","D")}if(typeof t.accountIdEndpointMode=="function"){let s=e.endpointV2;switch(String(s?.url?.hostname).match(AL)&&$t(e,"ACCOUNT_ID_ENDPOINT","O"),await t.accountIdEndpointMode?.()){case"disabled":$t(e,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":$t(e,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":$t(e,"ACCOUNT_ID_MODE_REQUIRED","R");break}}let n=e.__smithy_context?.selectedHttpAuthScheme?.identity;if(n?.$source){let s=n;s.accountId&&$t(e,"RESOLVED_ACCOUNT_ID","T");for(let[i,a]of Object.entries(s.$source??{}))$t(e,i,a)}}var AL,OI=d(()=>{Ne();AL=/\d{12}\.ddb/});var Km,Jd,qm,Yd,kI,$I,Jm,MI=d(()=>{Km="user-agent",Jd="x-amz-user-agent",qm=" ",Yd="/",kI=/[^!$%&'*+\-.^_`|~\w]/g,$I=/[^!$%&'*+\-.^_`|~\w#]/g,Jm="-"});function LI(e){let t="";for(let r in e){let o=e[r];if(t.length+o.length+1<=1024){t.length?t+=","+o:t+=o;continue}break}return t}var UI=d(()=>{});var PL,Xd,DL,yr,FI=d(()=>{an();we();OI();MI();UI();PL=e=>(t,r)=>async o=>{let{request:n}=o;if(!le.isInstance(n))return t(o);let{headers:s}=n,i=r?.userAgent?.map(Xd)||[],a=(await e.defaultUserAgentProvider()).map(Xd);await NI(r,e,o);let c=r;a.push(`m/${LI(Object.assign({},r.__smithy_context?.features,c.__aws_sdk_context?.features))}`);let l=e?.customUserAgent?.map(Xd)||[],p=await e.userAgentAppId();p&&a.push(Xd(["app",`${p}`]));let u=zb(),f=(u?[u]:[]).concat([...a,...i,...l]).join(qm),m=[...a.filter(h=>h.startsWith("aws-sdk-")),...l].join(qm);return e.runtime!=="browser"?(m&&(s[Jd]=s[Jd]?`${s[Km]} ${m}`:m),s[Km]=f):s[Jd]=f,t({...o,request:n})},Xd=e=>{let t=e[0].split(Yd).map(i=>i.replace(kI,Jm)).join(Yd),r=e[1]?.replace($I,Jm),o=t.indexOf(Yd),n=t.substring(0,o),s=t.substring(o+1);return n==="api"&&(s=s.toLowerCase()),[n,s,r].filter(i=>i&&i.length>0).reduce((i,a,c)=>{switch(c){case 0:return a;case 1:return`${i}/${a}`;default:return`${i}#${a}`}},"")},DL={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},yr=e=>({applyToStack:t=>{t.add(PL(e),DL)}})});var hn=d(()=>{V_();FI()});var ui,BI=d(()=>{ui=(e,t,r)=>{if(t in e){if(e[t]==="true")return!0;if(e[t]==="false")return!1;throw new Error(`Cannot load ${r} "${t}". Expected "true" or "false", got ${e[t]}.`)}}});var HI=d(()=>{});var gn,VI=d(()=>{(function(e){e.ENV="env",e.CONFIG="shared config entry"})(gn||(gn={}))});var Ym=d(()=>{BI();HI();VI()});var NL,OL,Sr,GI=d(()=>{Ym();NL="AWS_USE_DUALSTACK_ENDPOINT",OL="use_dualstack_endpoint",Sr={environmentVariableSelector:e=>ui(e,NL,gn.ENV),configFileSelector:e=>ui(e,OL,gn.CONFIG),default:!1}});var kL,$L,Er,jI=d(()=>{Ym();kL="AWS_USE_FIPS_ENDPOINT",$L="use_fips_endpoint",Er={environmentVariableSelector:e=>ui(e,kL,gn.ENV),configFileSelector:e=>ui(e,$L,gn.CONFIG),default:!1}});var WI=d(()=>{});var zI=d(()=>{});var KI=d(()=>{GI();jI();WI();zI()});var ML,LL,nt,Rt,qI=d(()=>{ML="AWS_REGION",LL="region",nt={environmentVariableSelector:e=>e[ML],configFileSelector:e=>e[LL],default:()=>{throw new Error("Region is missing")}},Rt={preferredFile:"credentials"}});var JI,YI,XI=d(()=>{Wr();JI=new Set,YI=(e,t=ss)=>{if(!JI.has(e)&&!t(e))if(e==="*")console.warn('@smithy/config-resolver WARN - Please use the caller region instead of "*". See "sigv4a" in https://github.com/aws/aws-sdk-js-v3/blob/main/supplemental-docs/CLIENTS.md.');else throw new Error(`Region not accepted: region="${e}" is not a valid hostname component.`);else JI.add(e)}});var Qd,Xm=d(()=>{Qd=e=>typeof e=="string"&&(e.startsWith("fips-")||e.endsWith("-fips"))});var QI,ZI=d(()=>{Xm();QI=e=>Qd(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e});var _r,eT=d(()=>{XI();ZI();Xm();_r=e=>{let{region:t,useFipsEndpoint:r}=e;if(!t)throw new Error("Region is missing");return Object.assign(e,{region:async()=>{let o=typeof t=="function"?await t():t,n=QI(o);return YI(n),n},useFipsEndpoint:async()=>{let o=typeof t=="string"?t:await t();return Qd(o)?!0:typeof r!="function"?Promise.resolve(!!r):r()}})}});var tT=d(()=>{qI();eT()});var rT=d(()=>{});var oT=d(()=>{});var nT=d(()=>{});var sT=d(()=>{rT();oT();nT()});var ut=d(()=>{KI();tT();sT()});function UL(e){return t=>async r=>{let o=r.request;if(le.isInstance(o)){let{body:n,headers:s}=o;if(n&&Object.keys(s).map(i=>i.toLowerCase()).indexOf(iT)===-1)try{let i=e(n);o.headers={...o.headers,[iT]:String(i)}}catch{}}return t({...r,request:o})}}var iT,FL,br,ls=d(()=>{we();iT="content-length";FL={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},br=e=>({applyToStack:t=>{t.add(UL(e.bodyLengthChecker),FL)}})});var aT,BL,HL,VL,GL,jL,cT=d(()=>{aT=async e=>{let t=e?.Bucket||"";if(typeof e.Bucket=="string"&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),jL(t)){if(e.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!GL(t)||t.indexOf(".")!==-1&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)&&(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e},BL=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,HL=/(\d+\.){3}\d+/,VL=/\.\./,GL=e=>BL.test(e)&&!HL.test(e)&&!VL.test(e),jL=e=>{let[t,r,o,,,n]=e.split(":"),s=t==="arn"&&e.split(":").length>=6,i=!!(s&&r&&o&&n);if(s&&!i)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return i}});var dT=d(()=>{cT()});var lT,pT=d(()=>{lT=(e,t,r,o=!1)=>{let n=async()=>{let s;return o?s=r.clientContextParams?.[e]??r[e]??r[t]:s=r[e]??r[t],typeof s=="function"?s():s};return e==="credentialScope"||t==="CredentialScope"?async()=>{let s=typeof r.credentials=="function"?await r.credentials():r.credentials;return s?.credentialScope??s?.CredentialScope}:e==="accountId"||t==="AccountId"?async()=>{let s=typeof r.credentials=="function"?await r.credentials():r.credentials;return s?.accountId??s?.AccountId}:e==="endpoint"||t==="endpoint"?async()=>{if(r.isCustomEndpoint===!1)return;let s=await n();if(s&&typeof s=="object"){if("url"in s)return s.url.href;if("hostname"in s){let{protocol:i,hostname:a,port:c,path:l}=s;return`${i}//${a}${c?":"+c:""}${l}`}}return s}:n}});function Zd(e){try{let t=new Set(Array.from(e.match(/([A-Z_]){3,}/g)??[]));return t.delete("CONFIG"),t.delete("CONFIG_PREFIX_SEPARATOR"),t.delete("ENV"),[...t].join(", ")}catch{return e}}var Qm=d(()=>{});var uT,fT=d(()=>{fe();Qm();uT=(e,t)=>async()=>{try{let r=e(process.env,t);if(r===void 0)throw new Error;return r}catch(r){throw new v(r.message||`Not found in ENV: ${Zd(e.toString())}`,{logger:t?.logger})}}});import{homedir as WL}from"os";import{sep as zL}from"path";var Zm,KL,xn,fi=d(()=>{Zm={},KL=()=>process&&process.geteuid?`${process.geteuid()}`:"DEFAULT",xn=()=>{let{HOME:e,USERPROFILE:t,HOMEPATH:r,HOMEDRIVE:o=`C:${zL}`}=process.env;if(e)return e;if(t)return t;if(r)return`${o}${r}`;let n=KL();return Zm[n]||(Zm[n]=WL()),Zm[n]}});var eh,qL,It,mT=d(()=>{eh="AWS_PROFILE",qL="default",It=e=>e.profile||process.env[eh]||qL});import{createHash as JL}from"crypto";import{join as YL}from"path";var el,th=d(()=>{fi();el=e=>{let r=JL("sha1").update(e).digest("hex");return YL(xn(),".aws","sso","cache",`${r}.json`)}});import{readFile as XL}from"fs/promises";var xa,ya,rh=d(()=>{th();xa={},ya=async e=>{if(xa[e])return xa[e];let t=el(e),r=await XL(t,"utf8");return JSON.parse(r)}});var Lt,tl=d(()=>{Lt="."});var hT,gT=d(()=>{nn();tl();hT=e=>Object.entries(e).filter(([t])=>{let r=t.indexOf(Lt);return r===-1?!1:Object.values(Po).includes(t.substring(0,r))}).reduce((t,[r,o])=>{let n=r.indexOf(Lt),s=r.substring(0,n)===Po.PROFILE?r.substring(n+1):r;return t[s]=o,t},{...e.default&&{default:e.default}})});import{join as QL}from"path";var ZL,rl,oh=d(()=>{fi();ZL="AWS_CONFIG_FILE",rl=()=>process.env[ZL]||QL(xn(),".aws","config")});import{join as e4}from"path";var t4,xT,yT=d(()=>{fi();t4="AWS_SHARED_CREDENTIALS_FILE",xT=()=>process.env[t4]||e4(xn(),".aws","credentials")});var r4,o4,Sa,nh=d(()=>{nn();tl();r4=/^([\w-]+)\s(["'])?([\w-@\+\.%:/]+)\2$/,o4=["__proto__","profile __proto__"],Sa=e=>{let t={},r,o;for(let n of e.split(/\r?\n/)){let s=n.split(/(^|\s)[;#]/)[0].trim();if(s[0]==="["&&s[s.length-1]==="]"){r=void 0,o=void 0;let a=s.substring(1,s.length-1),c=r4.exec(a);if(c){let[,l,,p]=c;Object.values(Po).includes(l)&&(r=[l,p].join(Lt))}else r=a;if(o4.includes(a))throw new Error(`Found invalid profile name "${a}"`)}else if(r){let a=s.indexOf("=");if(![0,-1].includes(a)){let[c,l]=[s.substring(0,a).trim(),s.substring(a+1).trim()];if(l==="")o=c;else{o&&n.trimStart()===n&&(o=void 0),t[r]=t[r]||{};let p=o?[o,c].join(Lt):c;t[r][p]=l}}}}return t}});import{readFile as n4}from"node:fs/promises";var sh,Ea,yn,_a=d(()=>{sh={},Ea={},yn=(e,t)=>Ea[e]!==void 0?Ea[e]:((!sh[e]||t?.ignoreCache)&&(sh[e]=n4(e,"utf8")),sh[e])});import{join as ST}from"path";var ET,ol,nl=d(()=>{gT();oh();yT();fi();nh();_a();tl();ET=()=>({}),ol=async(e={})=>{let{filepath:t=xT(),configFilepath:r=rl()}=e,o=xn(),n="~/",s=t;t.startsWith(n)&&(s=ST(o,t.slice(2)));let i=r;r.startsWith(n)&&(i=ST(o,r.slice(2)));let a=await Promise.all([yn(i,{ignoreCache:e.ignoreCache}).then(Sa).then(hT).catch(ET),yn(s,{ignoreCache:e.ignoreCache}).then(Sa).catch(ET)]);return{configFile:a[0],credentialsFile:a[1]}}});var _T,bT=d(()=>{nn();nl();_T=e=>Object.entries(e).filter(([t])=>t.startsWith(Po.SSO_SESSION+Lt)).reduce((t,[r,o])=>({...t,[r.substring(r.indexOf(Lt)+1)]:o}),{})});var s4,sl,wT=d(()=>{oh();bT();nh();_a();s4=()=>({}),sl=async(e={})=>yn(e.configFilepath??rl()).then(Sa).then(_T).catch(s4)});var RT,IT=d(()=>{RT=(...e)=>{let t={};for(let r of e)for(let[o,n]of Object.entries(r))t[o]!==void 0?Object.assign(t[o],n):t[o]=n;return t}});var po,TT=d(()=>{nl();IT();po=async e=>{let t=await ol(e);return RT(t.configFile,t.credentialsFile)}});var ba,vT=d(()=>{rh();_a();ba={getFileRecord(){return Ea},interceptFile(e,t){Ea[e]=Promise.resolve(t)},getTokenRecord(){return xa},interceptToken(e,t){xa[e]=t}}});var CT=d(()=>{});var ft=d(()=>{fi();mT();th();rh();nl();wT();TT();vT();CT();_a()});var AT,PT=d(()=>{fe();ft();Qm();AT=(e,{preferredFile:t="config",...r}={})=>async()=>{let o=It(r),{configFile:n,credentialsFile:s}=await ol(r),i=s[o]||{},a=n[o]||{},c=t==="config"?{...i,...a}:{...a,...i};try{let p=e(c,t==="config"?n:s);if(p===void 0)throw new Error;return p}catch(l){throw new v(l.message||`Not found in config files w/ profile [${o}]: ${Zd(e.toString())}`,{logger:r.logger})}}});var i4,DT,NT=d(()=>{fe();i4=e=>typeof e=="function",DT=e=>i4(e)?async()=>await e():Iw(e)});var P,OT=d(()=>{fe();fT();PT();NT();P=({environmentVariableSelector:e,configFileSelector:t,default:r},o={})=>{let{signingName:n,logger:s}=o;return Td(ni(uT(e,{signingName:n,logger:s}),AT(t,o),DT(r)))}});var wr=d(()=>{OT()});var kT,$T,MT,LT=d(()=>{ft();kT="AWS_ENDPOINT_URL",$T="endpoint_url",MT=e=>({environmentVariableSelector:t=>{let r=e.split(" ").map(s=>s.toUpperCase()),o=t[[kT,...r].join("_")];if(o)return o;let n=t[kT];if(n)return n},configFileSelector:(t,r)=>{if(r&&t.services){let n=r[["services",t.services].join(Lt)];if(n){let s=e.split(" ").map(a=>a.toLowerCase()),i=n[[s.join("_"),$T].join(Lt)];if(i)return i}}let o=t[$T];if(o)return o},default:void 0})});var il,ih=d(()=>{wr();LT();il=async e=>P(MT(e??""))()});var al,cl=d(()=>{Bo();al=e=>typeof e=="object"?"url"in e?Ve(e.url):e:Ve(e)});var UT,a4,ah=d(()=>{dT();pT();ih();cl();UT=async(e,t,r,o)=>{if(!r.isCustomEndpoint){let i;r.serviceConfiguredEndpoint?i=await r.serviceConfiguredEndpoint():i=await il(r.serviceId),i&&(r.endpoint=()=>Promise.resolve(al(i)),r.isCustomEndpoint=!0)}let n=await a4(e,t,r);if(typeof r.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return r.endpointProvider(n,o)},a4=async(e,t,r)=>{let o={},n=t?.getEndpointParameterInstructions?.()||{};for(let[s,i]of Object.entries(n))switch(i.type){case"staticContextParams":o[s]=i.value;break;case"contextParams":o[s]=e[i.name];break;case"clientContextParams":case"builtInParams":o[s]=await lT(i.name,s,r,i.type!=="builtInParams")();break;case"operationContextParams":o[s]=i.get(e);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(i))}return Object.keys(n).length===0&&Object.assign(o,r),String(r.serviceId).toLowerCase()==="s3"&&await aT(o),o}});var FT=d(()=>{ah();cl()});var BT,ch=d(()=>{Fe();Ze();ah();BT=({config:e,instructions:t})=>(r,o)=>async n=>{e.isCustomEndpoint&&D_(o,"ENDPOINT_OVERRIDE","N");let s=await UT(n.input,{getEndpointParameterInstructions(){return t}},{...e},o);o.endpointV2=s,o.authSchemes=s.properties?.authSchemes;let i=o.authSchemes?.[0];if(i){o.signing_region=i.signingRegion,o.signing_service=i.signingName;let c=ve(o)?.selectedHttpAuthScheme?.httpAuthOption;c&&(c.signingProperties=Object.assign(c.signingProperties||{},{signing_region:i.signingRegion,signingRegion:i.signingRegion,signing_service:i.signingName,signingName:i.signingName,signingRegionSet:i.signingRegionSet},i.properties))}return r({...n})}});var c4,oe,HT=d(()=>{Rf();ch();c4={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:rd.name},oe=(e,t)=>({applyToStack:r=>{r.addRelativeTo(BT({config:e,instructions:t}),c4)}})});var Rr,VT=d(()=>{Ze();ih();cl();Rr=e=>{let t=e.tls??!0,{endpoint:r,useDualstackEndpoint:o,useFipsEndpoint:n}=e,s=r!=null?async()=>al(await de(r)()):void 0,a=Object.assign(e,{endpoint:s,tls:t,isCustomEndpoint:!!r,useDualstackEndpoint:de(o??!1),useFipsEndpoint:de(n??!1)}),c;return a.serviceConfiguredEndpoint=async()=>(e.serviceId&&!c&&(c=il(e.serviceId)),c),a}});var GT=d(()=>{});var jT=d(()=>{});var Te=d(()=>{FT();ch();HT();VT();GT();jT()});var Vo,mi,Tt,dl=d(()=>{(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(Vo||(Vo={}));mi=3,Tt=Vo.STANDARD});var WT,zT,KT,qT,JT,YT=d(()=>{WT=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],zT=["TimeoutError","RequestTimeout","RequestTimeoutException"],KT=[500,502,503,504],qT=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],JT=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"]});var d4,l4,p4,ll,pl,XT,dh=d(()=>{YT();d4=e=>e?.$retryable!==void 0,l4=e=>e.$metadata?.clockSkewCorrected,p4=e=>{let t=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return e&&e instanceof TypeError?t.has(e.message):!1},ll=e=>e.$metadata?.httpStatusCode===429||WT.includes(e.name)||e.$retryable?.throttling==!0,pl=(e,t=0)=>d4(e)||l4(e)||zT.includes(e.name)||qT.includes(e?.code||"")||JT.includes(e?.code||"")||KT.includes(e.$metadata?.httpStatusCode||0)||p4(e)||e.cause!==void 0&&t<=10&&pl(e.cause,t+1),XT=e=>{if(e.$metadata?.httpStatusCode!==void 0){let t=e.$metadata.httpStatusCode;return 500<=t&&t<=599&&!pl(e)}return!1}});var ul,lh=d(()=>{dh();ul=class e{static setTimeoutFn=setTimeout;beta;minCapacity;minFillRate;scaleConstant;smooth;currentCapacity=0;enabled=!1;lastMaxRate=0;measuredTxRate=0;requestCount=0;fillRate;lastThrottleTime;lastTimestamp=0;lastTxRateBucket;maxCapacity;timeWindow=0;constructor(t){this.beta=t?.beta??.7,this.minCapacity=t?.minCapacity??1,this.minFillRate=t?.minFillRate??.5,this.scaleConstant=t?.scaleConstant??.4,this.smooth=t?.smooth??.8;let r=this.getCurrentTimeInSeconds();this.lastThrottleTime=r,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(t){if(this.enabled){if(this.refillTokenBucket(),t>this.currentCapacity){let r=(t-this.currentCapacity)/this.fillRate*1e3;await new Promise(o=>e.setTimeoutFn(o,r))}this.currentCapacity=this.currentCapacity-t}}refillTokenBucket(){let t=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=t;return}let r=(t-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+r),this.lastTimestamp=t}updateClientSendingRate(t){let r;if(this.updateMeasuredRate(),ll(t)){let n=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=n,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),r=this.cubicThrottle(n),this.enableTokenBucket()}else this.calculateTimeWindow(),r=this.cubicSuccess(this.getCurrentTimeInSeconds());let o=Math.min(r,2*this.measuredTxRate);this.updateTokenBucketRate(o)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(t){return this.getPrecise(t*this.beta)}cubicSuccess(t){return this.getPrecise(this.scaleConstant*Math.pow(t-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(t){this.refillTokenBucket(),this.fillRate=Math.max(t,this.minFillRate),this.maxCapacity=Math.max(t,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){let t=this.getCurrentTimeInSeconds(),r=Math.floor(t*2)/2;if(this.requestCount++,r>this.lastTxRateBucket){let o=this.requestCount/(r-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(o*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=r}}getPrecise(t){return parseFloat(t.toFixed(8))}}});var QT,ZT,ev=d(()=>{QT="amz-sdk-invocation-id",ZT="amz-sdk-request"});var rv,ov=d(()=>{rv=()=>{let e=100;return{computeNextBackoffDelay:o=>Math.floor(Math.min(2e4,Math.random()*2**o*e)),setDelayBase:o=>{e=o}}}});var ph,nv=d(()=>{ph=({retryDelay:e,retryCount:t,retryCost:r})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(2e4,e),getRetryCost:()=>r})});var hi,uh=d(()=>{dl();ov();nv();hi=class{maxAttempts;mode=Vo.STANDARD;capacity=500;retryBackoffStrategy=rv();maxAttemptsProvider;constructor(t){this.maxAttempts=t,this.maxAttemptsProvider=typeof t=="function"?t:async()=>t}async acquireInitialRetryToken(t){return ph({retryDelay:100,retryCount:0})}async refreshRetryTokenForRetry(t,r){let o=await this.getMaxAttempts();if(this.shouldRetry(t,r,o)){let n=r.errorType;this.retryBackoffStrategy.setDelayBase(n==="THROTTLING"?500:100);let s=this.retryBackoffStrategy.computeNextBackoffDelay(t.getRetryCount()),i=r.retryAfterHint?Math.max(r.retryAfterHint.getTime()-Date.now()||0,s):s,a=this.getCapacityCost(n);return this.capacity-=a,ph({retryDelay:i,retryCount:t.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(t){this.capacity=Math.max(500,this.capacity+(t.getRetryCost()??1))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${mi}`),mi}}shouldRetry(t,r,o){return t.getRetryCount()+1<o&&this.capacity>=this.getCapacityCost(r.errorType)&&this.isRetryableError(r.errorType)}getCapacityCost(t){return t==="TRANSIENT"?10:5}isRetryableError(t){return t==="THROTTLING"||t==="TRANSIENT"}}});var fl,sv=d(()=>{dl();lh();uh();fl=class{maxAttemptsProvider;rateLimiter;standardRetryStrategy;mode=Vo.ADAPTIVE;constructor(t,r){this.maxAttemptsProvider=t;let{rateLimiter:o}=r??{};this.rateLimiter=o??new ul,this.standardRetryStrategy=new hi(t)}async acquireInitialRetryToken(t){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(t)}async refreshRetryTokenForRetry(t,r){return this.rateLimiter.updateClientSendingRate(r),this.standardRetryStrategy.refreshRetryTokenForRetry(t,r)}recordSuccess(t){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(t)}}});var iv=d(()=>{});var av=d(()=>{});var Go=d(()=>{sv();iv();lh();uh();dl();ev();av()});var cv=d(()=>{});var dv=d(()=>{});var lv,pv=d(()=>{lv=e=>e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):typeof e=="string"?new Error(e):new Error(`AWS SDK error wrapper for ${e}`)});var uv=d(()=>{});var fv=d(()=>{});var mv,hv,Ir,Tr,m4,h4,vr,gv=d(()=>{Ze();Go();mv="AWS_MAX_ATTEMPTS",hv="max_attempts",Ir={environmentVariableSelector:e=>{let t=e[mv];if(!t)return;let r=parseInt(t);if(Number.isNaN(r))throw new Error(`Environment variable ${mv} mast be a number, got "${t}"`);return r},configFileSelector:e=>{let t=e[hv];if(!t)return;let r=parseInt(t);if(Number.isNaN(r))throw new Error(`Shared config file entry ${hv} mast be a number, got "${t}"`);return r},default:mi},Tr=e=>{let{retryStrategy:t,retryMode:r,maxAttempts:o}=e,n=de(o??mi);return Object.assign(e,{maxAttempts:n,retryStrategy:async()=>t||(await de(r)()===Vo.ADAPTIVE?new fl(n):new hi(n))})},m4="AWS_RETRY_MODE",h4="retry_mode",vr={environmentVariableSelector:e=>e[m4],configFileSelector:e=>e[h4],default:Tt}});var xv=d(()=>{});import{Readable as g4}from"stream";var yv,Sv=d(()=>{yv=e=>e?.body instanceof g4||typeof ReadableStream<"u"&&e?.body instanceof ReadableStream});var x4,y4,S4,E4,_4,Cr,b4,Ev=d(()=>{we();dh();N();Go();zf();Sv();pv();x4=e=>(t,r)=>async o=>{let n=await e.retryStrategy(),s=await e.maxAttempts();if(y4(n)){n=n;let i=await n.acquireInitialRetryToken(r.partition_id),a=new Error,c=0,l=0,{request:p}=o,u=le.isInstance(p);for(u&&(p.headers[QT]=Mo());;)try{u&&(p.headers[ZT]=`attempt=${c+1}; max=${s}`);let{response:f,output:m}=await t(o);return n.recordSuccess(i),m.$metadata.attempts=c+1,m.$metadata.totalRetryDelay=l,{response:f,output:m}}catch(f){let m=S4(f);if(a=lv(f),u&&yv(p))throw(r.logger instanceof ot?console:r.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{i=await n.refreshRetryTokenForRetry(i,m)}catch{throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=c+1,a.$metadata.totalRetryDelay=l,a}c=i.getRetryCount();let h=i.getRetryDelay();l+=h,await new Promise(g=>setTimeout(g,h))}}else return n=n,n?.mode&&(r.userAgent=[...r.userAgent||[],["cfg/retry-mode",n.mode]]),n.retry(t,o)},y4=e=>typeof e.acquireInitialRetryToken<"u"&&typeof e.refreshRetryTokenForRetry<"u"&&typeof e.recordSuccess<"u",S4=e=>{let t={error:e,errorType:E4(e)},r=b4(e.$response);return r&&(t.retryAfterHint=r),t},E4=e=>ll(e)?"THROTTLING":pl(e)?"TRANSIENT":XT(e)?"SERVER_ERROR":"CLIENT_ERROR",_4={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},Cr=e=>({applyToStack:t=>{t.add(x4(e),_4)}}),b4=e=>{if(!Jt.isInstance(e))return;let t=Object.keys(e.headers).find(s=>s.toLowerCase()==="retry-after");if(!t)return;let r=e.headers[t],o=Number(r);return Number.isNaN(o)?new Date(r):new Date(o*1e3)}});var Ut=d(()=>{fv();uv();gv();cv();xv();dv();Ev()});var Zl,ep,sC,iC,aC,cC,Th,dC=d(()=>{Ke();fe();Zl="AWS_ACCESS_KEY_ID",ep="AWS_SECRET_ACCESS_KEY",sC="AWS_SESSION_TOKEN",iC="AWS_CREDENTIAL_EXPIRATION",aC="AWS_CREDENTIAL_SCOPE",cC="AWS_ACCOUNT_ID",Th=e=>async()=>{e?.logger?.debug("@aws-sdk/credential-provider-env - fromEnv");let t=process.env[Zl],r=process.env[ep],o=process.env[sC],n=process.env[iC],s=process.env[aC],i=process.env[cC];if(t&&r){let a={accessKeyId:t,secretAccessKey:r,...o&&{sessionToken:o},...n&&{expiration:new Date(n)},...s&&{credentialScope:s},...i&&{accountId:i}};return q(a,"CREDENTIALS_ENV_VARS","g"),a}throw new v("Unable to find environment variable credentials.",{logger:e?.logger})}});var lC={};Nt(lC,{ENV_ACCOUNT_ID:()=>cC,ENV_CREDENTIAL_SCOPE:()=>aC,ENV_EXPIRATION:()=>iC,ENV_KEY:()=>Zl,ENV_SECRET:()=>ep,ENV_SESSION:()=>sC,fromEnv:()=>Th});var vh=d(()=>{dC()});import{Buffer as V6}from"buffer";import{request as G6}from"http";function Sn(e){return new Promise((t,r)=>{let o=G6({method:"GET",...e,hostname:e.hostname?.replace(/^\[(.+)\]$/,"$1")});o.on("error",n=>{r(Object.assign(new lr("Unable to connect to instance metadata service"),n)),o.destroy()}),o.on("timeout",()=>{r(new lr("TimeoutError from instance metadata service")),o.destroy()}),o.on("response",n=>{let{statusCode:s=400}=n;(s<200||300<=s)&&(r(Object.assign(new lr("Error response received from instance metadata service"),{statusCode:s})),o.destroy());let i=[];n.on("data",a=>{i.push(a)}),n.on("end",()=>{t(V6.concat(i)),o.destroy()})}),o.end()})}var tp=d(()=>{fe()});var rp,op,Ch=d(()=>{rp=e=>!!e&&typeof e=="object"&&typeof e.AccessKeyId=="string"&&typeof e.SecretAccessKey=="string"&&typeof e.Token=="string"&&typeof e.Expiration=="string",op=e=>({accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:new Date(e.Expiration),...e.AccountId&&{accountId:e.AccountId}})});var gfe,xfe,va,np=d(()=>{gfe=1e3,xfe=0,va=({maxRetries:e=0,timeout:t=1e3})=>({maxRetries:e,timeout:t})});var Ca,Ah=d(()=>{Ca=(e,t)=>{let r=e();for(let o=0;o<t;o++)r=r.catch(e);return r}});import{parse as j6}from"url";var sp,ip,Ph,W6,z6,K6,q6,J6,Y6,pC=d(()=>{fe();tp();Ch();np();Ah();sp="AWS_CONTAINER_CREDENTIALS_FULL_URI",ip="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",Ph="AWS_CONTAINER_AUTHORIZATION_TOKEN",W6=(e={})=>{let{timeout:t,maxRetries:r}=va(e);return()=>Ca(async()=>{let o=await Y6({logger:e.logger}),n=JSON.parse(await z6(t,o));if(!rp(n))throw new v("Invalid response received from instance metadata service.",{logger:e.logger});return op(n)},r)},z6=async(e,t)=>(process.env[Ph]&&(t.headers={...t.headers,Authorization:process.env[Ph]}),(await Sn({...t,timeout:e})).toString()),K6="169.254.170.2",q6={localhost:!0,"127.0.0.1":!0},J6={"http:":!0,"https:":!0},Y6=async({logger:e})=>{if(process.env[ip])return{hostname:K6,path:process.env[ip]};if(process.env[sp]){let t=j6(process.env[sp]);if(!t.hostname||!(t.hostname in q6))throw new v(`${t.hostname} is not a valid container metadata service hostname`,{tryNextLink:!1,logger:e});if(!t.protocol||!(t.protocol in J6))throw new v(`${t.protocol} is not a valid container metadata service protocol`,{tryNextLink:!1,logger:e});return{...t,port:t.port?parseInt(t.port,10):void 0}}throw new v(`The container metadata credential provider cannot be used unless the ${ip} or ${sp} environment variable is set`,{tryNextLink:!1,logger:e})}});var ap,uC=d(()=>{fe();ap=class e extends v{tryNextLink;name="InstanceMetadataV1FallbackError";constructor(t,r=!0){super(t,r),this.tryNextLink=r,Object.setPrototypeOf(this,e.prototype)}}});var hs,Dh=d(()=>{(function(e){e.IPv4="http://169.254.169.254",e.IPv6="http://[fd00:ec2::254]"})(hs||(hs={}))});var X6,Q6,fC,mC=d(()=>{X6="AWS_EC2_METADATA_SERVICE_ENDPOINT",Q6="ec2_metadata_service_endpoint",fC={environmentVariableSelector:e=>e[X6],configFileSelector:e=>e[Q6],default:void 0}});var En,Nh=d(()=>{(function(e){e.IPv4="IPv4",e.IPv6="IPv6"})(En||(En={}))});var Z6,eB,hC,gC=d(()=>{Nh();Z6="AWS_EC2_METADATA_SERVICE_ENDPOINT_MODE",eB="ec2_metadata_service_endpoint_mode",hC={environmentVariableSelector:e=>e[Z6],configFileSelector:e=>e[eB],default:En.IPv4}});var cp,tB,rB,Oh=d(()=>{wr();Bo();Dh();mC();Nh();gC();cp=async()=>Ve(await tB()||await rB()),tB=async()=>P(fC)(),rB=async()=>{let e=await P(hC)();switch(e){case En.IPv4:return hs.IPv4;case En.IPv6:return hs.IPv6;default:throw new Error(`Unsupported endpoint mode: ${e}. Select from ${Object.values(En)}`)}}});var oB,kh,xC=d(()=>{oB="https://docs.aws.amazon.com/sdkref/latest/guide/feature-static-credentials.html",kh=(e,t)=>{let r=300+Math.floor(Math.random()*300),o=new Date(Date.now()+r*1e3);t.warn(`Attempting credential expiration extension due to a credential service availability issue. A refresh of these credentials will be attempted after ${new Date(o)}.
For more information, please visit: `+oB);let n=e.originalExpiration??e.expiration;return{...e,...n?{originalExpiration:n}:{},expiration:o}}});var yC,SC=d(()=>{xC();yC=(e,t={})=>{let r=t?.logger||console,o;return async()=>{let n;try{n=await e(),n.expiration&&n.expiration.getTime()<Date.now()&&(n=kh(n,r))}catch(s){if(o)r.warn("Credential renew failed: ",s),n=kh(o,r);else throw s}return o=n,n}}});var bC,nB,$h,EC,_C,sB,iB,aB,cB,dB,wC=d(()=>{wr();fe();uC();tp();Ch();np();Ah();Oh();SC();bC="/latest/meta-data/iam/security-credentials/",nB="/latest/api/token",$h="AWS_EC2_METADATA_V1_DISABLED",EC="ec2_metadata_v1_disabled",_C="x-aws-ec2-metadata-token",sB=(e={})=>yC(iB(e),{logger:e.logger}),iB=(e={})=>{let t=!1,{logger:r,profile:o}=e,{timeout:n,maxRetries:s}=va(e),i=async(a,c)=>{if(t||c.headers?.[_C]==null){let u=!1,f=!1,m=await P({environmentVariableSelector:h=>{let g=h[$h];if(f=!!g&&g!=="false",g===void 0)throw new v(`${$h} not set in env, checking config file next.`,{logger:e.logger});return f},configFileSelector:h=>{let g=h[EC];return u=!!g&&g!=="false",u},default:!1},{profile:o})();if(e.ec2MetadataV1Disabled||m){let h=[];throw e.ec2MetadataV1Disabled&&h.push("credential provider initialization (runtime option ec2MetadataV1Disabled)"),u&&h.push(`config file profile (${EC})`),f&&h.push(`process environment variable (${$h})`),new ap(`AWS EC2 Metadata v1 fallback has been blocked by AWS SDK configuration in the following: [${h.join(", ")}].`)}}let p=(await Ca(async()=>{let u;try{u=await cB(c)}catch(f){throw f.statusCode===401&&(t=!1),f}return u},a)).trim();return Ca(async()=>{let u;try{u=await dB(p,c,e)}catch(f){throw f.statusCode===401&&(t=!1),f}return u},a)};return async()=>{let a=await cp();if(t)return r?.debug("AWS SDK Instance Metadata","using v1 fallback (no token fetch)"),i(s,{...a,timeout:n});{let c;try{c=(await aB({...a,timeout:n})).toString()}catch(l){if(l?.statusCode===400)throw Object.assign(l,{message:"EC2 Metadata token request returned error"});return(l.message==="TimeoutError"||[403,404,405].includes(l.statusCode))&&(t=!0),r?.debug("AWS SDK Instance Metadata","using v1 fallback (initial)"),i(s,{...a,timeout:n})}return i(s,{...a,headers:{[_C]:c},timeout:n})}}},aB=async e=>Sn({...e,path:nB,method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"21600"}}),cB=async e=>(await Sn({...e,path:bC})).toString(),dB=async(e,t,r)=>{let o=JSON.parse((await Sn({...t,path:bC+e})).toString());if(!rp(o))throw new v("Invalid response received from instance metadata service.",{logger:r.logger});return op(o)}});var RC=d(()=>{});var Aa={};Nt(Aa,{DEFAULT_MAX_RETRIES:()=>xfe,DEFAULT_TIMEOUT:()=>gfe,ENV_CMDS_AUTH_TOKEN:()=>Ph,ENV_CMDS_FULL_URI:()=>sp,ENV_CMDS_RELATIVE_URI:()=>ip,Endpoint:()=>hs,fromContainerMetadata:()=>W6,fromInstanceMetadata:()=>sB,getInstanceMetadataEndpoint:()=>cp,httpRequest:()=>Sn,providerConfigFromInit:()=>va});var Pa=d(()=>{pC();wC();np();RC();tp();Oh();Dh()});var lB,pB,uB,IC,TC=d(()=>{fe();lB="169.254.170.2",pB="169.254.170.23",uB="[fd00:ec2::23]",IC=(e,t)=>{if(e.protocol!=="https:"&&!(e.hostname===lB||e.hostname===pB||e.hostname===uB)){if(e.hostname.includes("[")){if(e.hostname==="[::1]"||e.hostname==="[0000:0000:0000:0000:0000:0000:0000:0001]")return}else{if(e.hostname==="localhost")return;let r=e.hostname.split("."),o=n=>{let s=parseInt(n,10);return 0<=s&&s<=255};if(r[0]==="127"&&o(r[1])&&o(r[2])&&o(r[3])&&r.length===4)return}throw new v(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:t})}}});function vC(e){return new le({protocol:e.protocol,hostname:e.hostname,port:Number(e.port),path:e.pathname,query:Array.from(e.searchParams.entries()).reduce((t,[r,o])=>(t[r]=o,t),{}),fragment:e.hash})}async function CC(e,t){let o=await id(e.body).transformToString();if(e.statusCode===200){let n=JSON.parse(o);if(typeof n.AccessKeyId!="string"||typeof n.SecretAccessKey!="string"||typeof n.Token!="string"||typeof n.Expiration!="string")throw new v("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:t});return{accessKeyId:n.AccessKeyId,secretAccessKey:n.SecretAccessKey,sessionToken:n.Token,expiration:QE(n.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let n={};try{n=JSON.parse(o)}catch{}throw Object.assign(new v(`Server responded with status: ${e.statusCode}`,{logger:t}),{Code:n.Code,Message:n.Message})}throw new v(`Server responded with status: ${e.statusCode}`,{logger:t})}var AC=d(()=>{fe();we();N();ad()});var PC,DC=d(()=>{PC=(e,t,r)=>async()=>{for(let o=0;o<t;++o)try{return await e()}catch{await new Promise(s=>setTimeout(s,r))}return await e()}});import fB from"fs/promises";var mB,hB,gB,xB,yB,NC,OC=d(()=>{Ke();ko();fe();TC();AC();DC();mB="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",hB="http://169.254.170.2",gB="AWS_CONTAINER_CREDENTIALS_FULL_URI",xB="AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE",yB="AWS_CONTAINER_AUTHORIZATION_TOKEN",NC=(e={})=>{e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let t,r=e.awsContainerCredentialsRelativeUri??process.env[mB],o=e.awsContainerCredentialsFullUri??process.env[gB],n=e.awsContainerAuthorizationToken??process.env[yB],s=e.awsContainerAuthorizationTokenFile??process.env[xB],i=e.logger?.constructor?.name==="NoOpLogger"||!e.logger?.warn?console.warn:e.logger.warn.bind(e.logger);if(r&&o&&(i("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),i("awsContainerCredentialsFullUri will take precedence.")),n&&s&&(i("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),i("awsContainerAuthorizationToken will take precedence.")),o)t=o;else if(r)t=`${hB}${r}`;else throw new v(`No HTTP credential provider host provided.
Set AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`,{logger:e.logger});let a=new URL(t);IC(a,e.logger);let c=tt.create({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return PC(async()=>{let l=vC(a);n?l.headers.Authorization=n:s&&(l.headers.Authorization=(await fB.readFile(s)).toString());try{let p=await c.handle(l);return CC(p.response).then(u=>q(u,"CREDENTIALS_HTTP","z"))}catch(p){throw new v(String(p),{logger:e.logger})}},e.maxRetries??3,e.timeout??1e3)}});var Mh={};Nt(Mh,{fromHttp:()=>NC});var Lh=d(()=>{OC()});var Uh,Fh=d(()=>{Uh=e=>e&&(typeof e.sso_start_url=="string"||typeof e.sso_account_id=="string"||typeof e.sso_session=="string"||typeof e.sso_region=="string"||typeof e.sso_role_name=="string")});var LC=d(()=>{});var Si,dp=d(()=>{Si="To refresh this SSO session run 'aws sso login' with the corresponding profile."});function EB(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"sso-oauth",region:e.region},propertiesExtractor:(t,r)=>({signingProperties:{config:t,context:r}})}}function _B(e){return{schemeId:"smithy.api#noAuth"}}var UC,FC,BC,Bh=d(()=>{Ne();Ze();UC=async(e,t,r)=>({operation:ve(t).operation,region:await de(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});FC=e=>{let t=[];switch(e.operation){case"CreateToken":{t.push(_B(e));break}default:t.push(EB(e))}return t},BC=e=>{let t=ur(e);return Object.assign(t,{authSchemePreference:de(e.authSchemePreference??[])})}});var HC,VC,Hh=d(()=>{HC=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"sso-oauth"}),VC={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}});var Ei,lp=d(()=>{Ei={name:"@aws-sdk/nested-clients",version:"3.958.0",description:"Nested clients for AWS SDK packages.",main:"./dist-cjs/index.js",module:"./dist-es/index.js",types:"./dist-types/index.d.ts",scripts:{build:"yarn lint && concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline nested-clients","build:es":"tsc -p tsconfig.es.json","build:include:deps":'yarn g:turbo run build -F="$npm_package_name"',"build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo",lint:"node ../../scripts/validation/submodules-linter.js --pkg nested-clients",test:"yarn g:vitest run","test:watch":"yarn g:vitest watch"},engines:{node:">=18.0.0"},sideEffects:!1,author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.957.0","@aws-sdk/middleware-host-header":"3.957.0","@aws-sdk/middleware-logger":"3.957.0","@aws-sdk/middleware-recursion-detection":"3.957.0","@aws-sdk/middleware-user-agent":"3.957.0","@aws-sdk/region-config-resolver":"3.957.0","@aws-sdk/types":"3.957.0","@aws-sdk/util-endpoints":"3.957.0","@aws-sdk/util-user-agent-browser":"3.957.0","@aws-sdk/util-user-agent-node":"3.957.0","@smithy/config-resolver":"^4.4.5","@smithy/core":"^3.20.0","@smithy/fetch-http-handler":"^5.3.8","@smithy/hash-node":"^4.2.7","@smithy/invalid-dependency":"^4.2.7","@smithy/middleware-content-length":"^4.2.7","@smithy/middleware-endpoint":"^4.4.1","@smithy/middleware-retry":"^4.4.17","@smithy/middleware-serde":"^4.2.8","@smithy/middleware-stack":"^4.2.7","@smithy/node-config-provider":"^4.3.7","@smithy/node-http-handler":"^4.4.7","@smithy/protocol-http":"^5.3.7","@smithy/smithy-client":"^4.10.2","@smithy/types":"^4.11.0","@smithy/url-parser":"^4.2.7","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.16","@smithy/util-defaults-mode-node":"^4.2.19","@smithy/util-endpoints":"^3.2.7","@smithy/util-middleware":"^4.2.7","@smithy/util-retry":"^4.2.7","@smithy/util-utf8":"^4.2.0",tslib:"^2.6.2"},devDependencies:{concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["./signin.d.ts","./signin.js","./sso-oidc.d.ts","./sso-oidc.js","./sts.d.ts","./sts.js","dist-*/**"],browser:{"./dist-es/submodules/signin/runtimeConfig":"./dist-es/submodules/signin/runtimeConfig.browser","./dist-es/submodules/sso-oidc/runtimeConfig":"./dist-es/submodules/sso-oidc/runtimeConfig.browser","./dist-es/submodules/sts/runtimeConfig":"./dist-es/submodules/sts/runtimeConfig.browser"},"react-native":{},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/packages/nested-clients",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"packages/nested-clients"},exports:{"./package.json":"./package.json","./sso-oidc":{types:"./dist-types/submodules/sso-oidc/index.d.ts",module:"./dist-es/submodules/sso-oidc/index.js",node:"./dist-cjs/submodules/sso-oidc/index.js",import:"./dist-es/submodules/sso-oidc/index.js",require:"./dist-cjs/submodules/sso-oidc/index.js"},"./sts":{types:"./dist-types/submodules/sts/index.d.ts",module:"./dist-es/submodules/sts/index.js",node:"./dist-cjs/submodules/sts/index.js",import:"./dist-es/submodules/sts/index.js",require:"./dist-cjs/submodules/sts/index.js"},"./signin":{types:"./dist-types/submodules/signin/index.d.ts",module:"./dist-es/submodules/signin/index.js",node:"./dist-cjs/submodules/signin/index.js",import:"./dist-es/submodules/signin/index.js",require:"./dist-cjs/submodules/signin/index.js"}}}});var GC,jC=d(()=>{GC={isCrtAvailable:!1}});var WC,zC=d(()=>{jC();WC=()=>GC.isCrtAvailable?["md/crt-avail"]:null});import{platform as wB,release as RB}from"os";import{env as KC,versions as IB}from"process";var Ar,qC=d(()=>{zC();Ar=({serviceId:e,clientVersion:t})=>async r=>{let o=[["aws-sdk-js",t],["ua","2.1"],[`os/${wB()}`,RB()],["lang/js"],["md/nodejs",`${IB.node}`]],n=WC();n&&o.push(n),e&&o.push([`api/${e}`,t]),KC.AWS_EXECUTION_ENV&&o.push([`exec-env/${KC.AWS_EXECUTION_ENV}`]);let s=await r?.userAgentAppId?.();return s?[...o,[`app/${s}`]]:[...o]}});var TB,vB,CB,Pr,JC=d(()=>{hn();TB="AWS_SDK_UA_APP_ID",vB="sdk_ua_app_id",CB="sdk-ua-app-id",Pr={environmentVariableSelector:e=>e[TB],configFileSelector:e=>e[vB]??e[CB],default:em}});var gs=d(()=>{qC();JC()});import{Buffer as AB}from"buffer";import{createHash as PB,createHmac as DB}from"crypto";function YC(e,t){return AB.isBuffer(e)?e:typeof e=="string"?Ks(e,t):ArrayBuffer.isView(e)?Oo(e.buffer,e.byteOffset,e.byteLength):Oo(e)}var Ct,xs=d(()=>{ts();Ae();Ct=class{algorithmIdentifier;secret;hash;constructor(t,r){this.algorithmIdentifier=t,this.secret=r,this.reset()}update(t,r){this.hash.update(jr(YC(t,r)))}digest(){return Promise.resolve(this.hash.digest())}reset(){this.hash=this.secret?DB(this.algorithmIdentifier,YC(this.secret)):PB(this.algorithmIdentifier)}}});import{fstatSync as NB,lstatSync as OB,ReadStream as kB}from"node:fs";var Dr,XC=d(()=>{Dr=e=>{if(!e)return 0;if(typeof e=="string")return Buffer.byteLength(e);if(typeof e.byteLength=="number")return e.byteLength;if(typeof e.size=="number")return e.size;if(typeof e.start=="number"&&typeof e.end=="number")return e.end+1-e.start;if(e instanceof kB){if(e.path!=null)return OB(e.path).size;if(typeof e.fd=="number")return NB(e.fd).size}throw new Error(`Body Length computation failed for ${e}`)}});var ys=d(()=>{XC()});var QC,Vh,Gh,ZC,eA,tA,rA=d(()=>{QC="AWS_EXECUTION_ENV",Vh="AWS_REGION",Gh="AWS_DEFAULT_REGION",ZC="AWS_EC2_METADATA_DISABLED",eA=["in-region","cross-region","mobile","standard","legacy"],tA="/latest/meta-data/placement/region"});var $B,MB,oA,nA=d(()=>{$B="AWS_DEFAULTS_MODE",MB="defaults_mode",oA={environmentVariableSelector:e=>e[$B],configFileSelector:e=>e[MB],default:"legacy"}});var Nr,LB,UB,sA=d(()=>{ut();wr();fe();rA();nA();Nr=({region:e=P(nt),defaultsMode:t=P(oA)}={})=>Td(async()=>{let r=typeof t=="function"?await t():t;switch(r?.toLowerCase()){case"auto":return LB(e);case"in-region":case"cross-region":case"mobile":case"standard":case"legacy":return Promise.resolve(r?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${eA.join(", ")}, got ${r}`)}}),LB=async e=>{if(e){let t=typeof e=="function"?await e():e,r=await UB();return r?t===r?"in-region":"cross-region":"standard"}return"standard"},UB=async()=>{if(process.env[QC]&&(process.env[Vh]||process.env[Gh]))return process.env[Vh]??process.env[Gh];if(!process.env[ZC])try{let{getInstanceMetadataEndpoint:e,httpRequest:t}=await Promise.resolve().then(()=>(Pa(),Aa)),r=await e();return(await t({...r,path:tA})).toString()}catch{}}});var Ss=d(()=>{sA()});var hA,kr,$r,wi,iA,Da,_i,bi,jo,jh,Wh,aA,cA,dA,gA,xA,Or,lA,yA,pA,uA,fA,mA,FB,SA,EA=d(()=>{hA="required",kr="fn",$r="argv",wi="ref",iA="isSet",Da="booleanEquals",_i="error",bi="endpoint",jo="tree",jh="PartitionResult",Wh="getAttr",aA={[hA]:!1,type:"string"},cA={[hA]:!0,default:!1,type:"boolean"},dA={[wi]:"Endpoint"},gA={[kr]:Da,[$r]:[{[wi]:"UseFIPS"},!0]},xA={[kr]:Da,[$r]:[{[wi]:"UseDualStack"},!0]},Or={},lA={[kr]:Wh,[$r]:[{[wi]:jh},"supportsFIPS"]},yA={[wi]:jh},pA={[kr]:Da,[$r]:[!0,{[kr]:Wh,[$r]:[yA,"supportsDualStack"]}]},uA=[gA],fA=[xA],mA=[{[wi]:"Region"}],FB={version:"1.0",parameters:{Region:aA,UseDualStack:cA,UseFIPS:cA,Endpoint:aA},rules:[{conditions:[{[kr]:iA,[$r]:[dA]}],rules:[{conditions:uA,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:_i},{conditions:fA,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:_i},{endpoint:{url:dA,properties:Or,headers:Or},type:bi}],type:jo},{conditions:[{[kr]:iA,[$r]:mA}],rules:[{conditions:[{[kr]:"aws.partition",[$r]:mA,assign:jh}],rules:[{conditions:[gA,xA],rules:[{conditions:[{[kr]:Da,[$r]:[!0,lA]},pA],rules:[{endpoint:{url:"https://oidc-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Or,headers:Or},type:bi}],type:jo},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:_i}],type:jo},{conditions:uA,rules:[{conditions:[{[kr]:Da,[$r]:[lA,!0]}],rules:[{conditions:[{[kr]:"stringEquals",[$r]:[{[kr]:Wh,[$r]:[yA,"name"]},"aws-us-gov"]}],endpoint:{url:"https://oidc.{Region}.amazonaws.com",properties:Or,headers:Or},type:bi},{endpoint:{url:"https://oidc-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Or,headers:Or},type:bi}],type:jo},{error:"FIPS is enabled but this partition does not support FIPS",type:_i}],type:jo},{conditions:fA,rules:[{conditions:[pA],rules:[{endpoint:{url:"https://oidc.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Or,headers:Or},type:bi}],type:jo},{error:"DualStack is enabled but this partition does not support DualStack",type:_i}],type:jo},{endpoint:{url:"https://oidc.{Region}.{PartitionResult#dnsSuffix}",properties:Or,headers:Or},type:bi}],type:jo}],type:jo},{error:"Invalid Configuration: Missing Region",type:_i}]},SA=FB});var BB,_A,bA=d(()=>{an();Wr();EA();BB=new bt({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),_A=(e,t={})=>BB.get(e,()=>ar(SA,{endpointParams:e,logger:t.logger}));ze.aws=kt});var wA,RA=d(()=>{Ne();Ho();Fe();N();Bo();et();Ae();Bh();bA();wA=e=>({apiVersion:"2019-06-10",base64Decoder:e?.base64Decoder??Ie,base64Encoder:e?.base64Encoder??Ee,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??_A,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??FC,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new qe},{schemeId:"smithy.api#noAuth",identityProvider:t=>t.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new or}],logger:e?.logger??new ot,protocol:e?.protocol??fn,protocolSettings:e?.protocolSettings??{defaultNamespace:"com.amazonaws.ssooidc",version:"2019-06-10",serviceTarget:"AWSSSOOIDCService"},serviceId:e?.serviceId??"SSO OIDC",urlParser:e?.urlParser??Ve,utf8Decoder:e?.utf8Decoder??_e,utf8Encoder:e?.utf8Encoder??Se})});var IA,TA=d(()=>{lp();Ne();gs();ut();xs();Ut();wr();ko();N();ys();Ss();Go();RA();IA=e=>{mr(process.version);let t=Nr(e),r=()=>t().then(fr),o=wA(e);cr(process.version);let n={profile:e?.profile,logger:o.logger};return{...o,...e,runtime:"node",defaultsMode:t,authSchemePreference:e?.authSchemePreference??P(dr,n),bodyLengthChecker:e?.bodyLengthChecker??Dr,defaultUserAgentProvider:e?.defaultUserAgentProvider??Ar({serviceId:o.serviceId,clientVersion:Ei.version}),maxAttempts:e?.maxAttempts??P(Ir,e),region:e?.region??P(nt,{...Rt,...n}),requestHandler:tt.create(e?.requestHandler??r),retryMode:e?.retryMode??P({...vr,default:async()=>(await r()).retryMode||Tt},e),sha256:e?.sha256??Ct.bind(null,"sha256"),streamCollector:e?.streamCollector??xt,useDualstackEndpoint:e?.useDualstackEndpoint??P(Sr,n),useFipsEndpoint:e?.useFipsEndpoint??P(Er,n),userAgentAppId:e?.userAgentAppId??P(Pr,n)}}});var Mr,Lr,vA=d(()=>{Mr=e=>({setRegion(t){e.region=t},region(){return e.region}}),Lr=e=>({region:e.region()})});var CA=d(()=>{});function AA(e={}){return P({...nt,async default(){return HB.silence||console.warn("@aws-sdk - WARN - default STS region of us-east-1 used. See @aws-sdk/credential-providers README and set a region explicitly."),"us-east-1"}},{...Rt,...e})}var HB,PA=d(()=>{ut();wr();HB={silence:!1}});var _n=d(()=>{vA();CA();PA()});var DA,NA,OA=d(()=>{DA=e=>{let t=e.httpAuthSchemes,r=e.httpAuthSchemeProvider,o=e.credentials;return{setHttpAuthScheme(n){let s=t.findIndex(i=>i.schemeId===n.schemeId);s===-1?t.push(n):t.splice(s,1,n)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(n){r=n},httpAuthSchemeProvider(){return r},setCredentials(n){o=n},credentials(){return o}}},NA=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()})});var kA,$A=d(()=>{_n();we();N();OA();kA=(e,t)=>{let r=Object.assign(Mr(e),hr(e),Kt(e),DA(e));return t.forEach(o=>o.configure(r)),Object.assign(e,Lr(r),gr(r),qt(r),NA(r))}});var Na,zh=d(()=>{Xn();Qn();Zn();hn();ut();Fe();ae();ls();Te();Ut();N();Bh();Hh();TA();$A();Na=class extends Be{config;constructor(...[t]){let r=IA(t||{});super(r),this.initConfig=r;let o=HC(r),n=nr(o),s=Tr(n),i=_r(s),a=i,c=Rr(a),l=BC(c),p=kA(l,t?.extensions||[]);this.config=p,this.middlewareStack.use(tr(this.config)),this.middlewareStack.use(yr(this.config)),this.middlewareStack.use(Cr(this.config)),this.middlewareStack.use(br(this.config)),this.middlewareStack.use(Yt(this.config)),this.middlewareStack.use(Xt(this.config)),this.middlewareStack.use(Qt(this.config)),this.middlewareStack.use(Zt(this.config,{httpAuthSchemeParametersProvider:UC,identityProviderConfigProvider:async u=>new _t({"aws.auth#sigv4":u.credentials})})),this.middlewareStack.use(er(this.config))}destroy(){super.destroy()}}});var Ge,pp=d(()=>{N();Ge=class e extends wt{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}}});var ka,$a,Ma,La,Ua,Fa,Ba,Ha,Va,Ga,ja,Kh=d(()=>{pp();ka=class e extends Ge{name="AccessDeniedException";$fault="client";error;reason;error_description;constructor(t){super({name:"AccessDeniedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.reason=t.reason,this.error_description=t.error_description}},$a=class e extends Ge{name="AuthorizationPendingException";$fault="client";error;error_description;constructor(t){super({name:"AuthorizationPendingException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Ma=class e extends Ge{name="ExpiredTokenException";$fault="client";error;error_description;constructor(t){super({name:"ExpiredTokenException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},La=class e extends Ge{name="InternalServerException";$fault="server";error;error_description;constructor(t){super({name:"InternalServerException",$fault:"server",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Ua=class e extends Ge{name="InvalidClientException";$fault="client";error;error_description;constructor(t){super({name:"InvalidClientException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Fa=class e extends Ge{name="InvalidGrantException";$fault="client";error;error_description;constructor(t){super({name:"InvalidGrantException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Ba=class e extends Ge{name="InvalidRequestException";$fault="client";error;reason;error_description;constructor(t){super({name:"InvalidRequestException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.reason=t.reason,this.error_description=t.error_description}},Ha=class e extends Ge{name="InvalidScopeException";$fault="client";error;error_description;constructor(t){super({name:"InvalidScopeException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Va=class e extends Ge{name="SlowDownException";$fault="client";error;error_description;constructor(t){super({name:"SlowDownException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},Ga=class e extends Ge{name="UnauthorizedClientException";$fault="client";error;error_description;constructor(t){super({name:"UnauthorizedClientException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}},ja=class e extends Ge{name="UnsupportedGrantTypeException";$fault="client";error;error_description;constructor(t){super({name:"UnsupportedGrantTypeException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error,this.error_description=t.error_description}}});var VB,GB,jB,WB,zB,KB,qB,JB,YB,XB,QB,ZB,e5,t5,r5,o5,n5,s5,i5,a5,fo,c5,d5,l5,p5,u5,Ce,f5,zr,m5,h5,Kr,g5,MA,LA,x5,y5,S5,UA,E5,pe,_5,b5,w5,R5,FA,BA,HA,VA,GA,jA,WA,zA,KA,qA,JA,YA,XA,QA,ZA,qh,Jh=d(()=>{ae();Kh();pp();VB="AccessDeniedException",GB="AuthorizationPendingException",jB="AccessToken",WB="ClientSecret",zB="CreateToken",KB="CreateTokenRequest",qB="CreateTokenResponse",JB="CodeVerifier",YB="ExpiredTokenException",XB="InvalidClientException",QB="InvalidGrantException",ZB="InvalidRequestException",e5="InternalServerException",t5="InvalidScopeException",r5="IdToken",o5="RefreshToken",n5="SlowDownException",s5="UnauthorizedClientException",i5="UnsupportedGrantTypeException",a5="accessToken",fo="client",c5="clientId",d5="clientSecret",l5="codeVerifier",p5="code",u5="deviceCode",Ce="error",f5="expiresIn",zr="error_description",m5="grantType",h5="http",Kr="httpError",g5="idToken",MA="reason",LA="refreshToken",x5="redirectUri",y5="scope",S5="server",UA="smithy.ts.sdk.synthetic.com.amazonaws.ssooidc",E5="tokenType",pe="com.amazonaws.ssooidc",_5=[0,pe,jB,8,0],b5=[0,pe,WB,8,0],w5=[0,pe,JB,8,0],R5=[0,pe,r5,8,0],FA=[0,pe,o5,8,0],BA=[-3,pe,VB,{[Ce]:fo,[Kr]:400},[Ce,MA,zr],[0,0,0]];S.for(pe).registerError(BA,ka);HA=[-3,pe,GB,{[Ce]:fo,[Kr]:400},[Ce,zr],[0,0]];S.for(pe).registerError(HA,$a);VA=[3,pe,KB,0,[c5,d5,m5,u5,p5,LA,y5,x5,l5],[0,[()=>b5,0],0,0,0,[()=>FA,0],64,0,[()=>w5,0]]],GA=[3,pe,qB,0,[a5,E5,f5,LA,g5],[[()=>_5,0],0,1,[()=>FA,0],[()=>R5,0]]],jA=[-3,pe,YB,{[Ce]:fo,[Kr]:400},[Ce,zr],[0,0]];S.for(pe).registerError(jA,Ma);WA=[-3,pe,e5,{[Ce]:S5,[Kr]:500},[Ce,zr],[0,0]];S.for(pe).registerError(WA,La);zA=[-3,pe,XB,{[Ce]:fo,[Kr]:401},[Ce,zr],[0,0]];S.for(pe).registerError(zA,Ua);KA=[-3,pe,QB,{[Ce]:fo,[Kr]:400},[Ce,zr],[0,0]];S.for(pe).registerError(KA,Fa);qA=[-3,pe,ZB,{[Ce]:fo,[Kr]:400},[Ce,MA,zr],[0,0,0]];S.for(pe).registerError(qA,Ba);JA=[-3,pe,t5,{[Ce]:fo,[Kr]:400},[Ce,zr],[0,0]];S.for(pe).registerError(JA,Ha);YA=[-3,pe,n5,{[Ce]:fo,[Kr]:400},[Ce,zr],[0,0]];S.for(pe).registerError(YA,Va);XA=[-3,pe,s5,{[Ce]:fo,[Kr]:400},[Ce,zr],[0,0]];S.for(pe).registerError(XA,Ga);QA=[-3,pe,i5,{[Ce]:fo,[Kr]:400},[Ce,zr],[0,0]];S.for(pe).registerError(QA,ja);ZA=[-3,UA,"SSOOIDCServiceException",0,[],[]];S.for(UA).registerError(ZA,Ge);qh=[9,pe,zB,{[h5]:["POST","/token",200]},()=>VA,()=>GA]});var Wa,Yh=d(()=>{Te();N();Hh();Jh();Wa=class extends V.classBuilder().ep(VC).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("AWSSSOOIDCService","CreateToken",{}).n("SSOOIDCClient","CreateTokenCommand").sc(qh).build(){}});var I5,up,eP=d(()=>{N();Yh();zh();I5={CreateTokenCommand:Wa},up=class extends Na{};ln(I5,up)});var tP=d(()=>{Yh()});var T5,v5,rP=d(()=>{T5={KMS_ACCESS_DENIED:"KMS_AccessDeniedException"},v5={KMS_DISABLED_KEY:"KMS_DisabledException",KMS_INVALID_KEY_USAGE:"KMS_InvalidKeyUsageException",KMS_INVALID_STATE:"KMS_InvalidStateException",KMS_KEY_NOT_FOUND:"KMS_NotFoundException"}});var oP=d(()=>{});var Xh={};Nt(Xh,{$Command:()=>V,AccessDeniedException:()=>ka,AccessDeniedException$:()=>BA,AccessDeniedExceptionReason:()=>T5,AuthorizationPendingException:()=>$a,AuthorizationPendingException$:()=>HA,CreateToken$:()=>qh,CreateTokenCommand:()=>Wa,CreateTokenRequest$:()=>VA,CreateTokenResponse$:()=>GA,ExpiredTokenException:()=>Ma,ExpiredTokenException$:()=>jA,InternalServerException:()=>La,InternalServerException$:()=>WA,InvalidClientException:()=>Ua,InvalidClientException$:()=>zA,InvalidGrantException:()=>Fa,InvalidGrantException$:()=>KA,InvalidRequestException:()=>Ba,InvalidRequestException$:()=>qA,InvalidRequestExceptionReason:()=>v5,InvalidScopeException:()=>Ha,InvalidScopeException$:()=>JA,SSOOIDC:()=>up,SSOOIDCClient:()=>Na,SSOOIDCServiceException:()=>Ge,SSOOIDCServiceException$:()=>ZA,SlowDownException:()=>Va,SlowDownException$:()=>YA,UnauthorizedClientException:()=>Ga,UnauthorizedClientException$:()=>XA,UnsupportedGrantTypeException:()=>ja,UnsupportedGrantTypeException$:()=>QA,__Client:()=>Be});var Qh=d(()=>{zh();eP();tP();Jh();rP();Kh();oP();pp()});var nP,sP=d(()=>{nP=async(e,t={},r)=>{let{SSOOIDCClient:o}=await Promise.resolve().then(()=>(Qh(),Xh)),n=i=>t.clientConfig?.[i]??t.parentClientConfig?.[i]??r?.[i];return new o(Object.assign({},t.clientConfig??{},{region:e??t.clientConfig?.region,logger:n("logger"),userAgentAppId:n("userAgentAppId")}))}});var iP,aP=d(()=>{sP();iP=async(e,t,r={},o)=>{let{CreateTokenCommand:n}=await Promise.resolve().then(()=>(Qh(),Xh));return(await nP(t,r,o)).send(new n({clientId:e.clientId,clientSecret:e.clientSecret,refreshToken:e.refreshToken,grantType:"refresh_token"}))}});var Zh,cP=d(()=>{fe();dp();Zh=e=>{if(e.expiration&&e.expiration.getTime()<Date.now())throw new pr(`Token is expired. ${Si}`,!1)}});var bn,dP=d(()=>{fe();dp();bn=(e,t,r=!1)=>{if(typeof t>"u")throw new pr(`Value not present for '${e}' in SSO Token${r?". Cannot refresh":""}. ${Si}`,!1)}});import{promises as C5}from"fs";var A5,lP,pP=d(()=>{ft();({writeFile:A5}=C5),lP=(e,t)=>{let r=el(e),o=JSON.stringify(t,null,2);return A5(r,o)}});var uP,fP,mP=d(()=>{fe();ft();dp();aP();cP();dP();pP();uP=new Date(0),fP=(e={})=>async({callerClientConfig:t}={})=>{e.logger?.debug("@aws-sdk/token-providers - fromSso");let r=await po(e),o=It({profile:e.profile??t?.profile}),n=r[o];if(n){if(!n.sso_session)throw new pr(`Profile '${o}' is missing required property 'sso_session'.`)}else throw new pr(`Profile '${o}' could not be found in shared credentials file.`,!1);let s=n.sso_session,a=(await sl(e))[s];if(!a)throw new pr(`Sso session '${s}' could not be found in shared credentials file.`,!1);for(let h of["sso_start_url","sso_region"])if(!a[h])throw new pr(`Sso session '${s}' is missing required property '${h}'.`,!1);let c=a.sso_start_url,l=a.sso_region,p;try{p=await ya(s)}catch{throw new pr(`The SSO session token associated with profile=${o} was not found or is invalid. ${Si}`,!1)}bn("accessToken",p.accessToken),bn("expiresAt",p.expiresAt);let{accessToken:u,expiresAt:f}=p,m={token:u,expiration:new Date(f)};if(m.expiration.getTime()-Date.now()>3e5)return m;if(Date.now()-uP.getTime()<30*1e3)return Zh(m),m;bn("clientId",p.clientId,!0),bn("clientSecret",p.clientSecret,!0),bn("refreshToken",p.refreshToken,!0);try{uP.setTime(Date.now());let h=await iP(p,l,e,t);bn("accessToken",h.accessToken),bn("expiresIn",h.expiresIn);let g=new Date(Date.now()+h.expiresIn*1e3);try{await lP(s,{...p,accessToken:h.accessToken,expiresAt:g.toISOString(),refreshToken:h.refreshToken})}catch{}return{token:h.accessToken,expiration:g}}catch{return Zh(m),m}}});var hP=d(()=>{});var gP=d(()=>{});var xP=d(()=>{LC();mP();hP();gP()});function D5(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"awsssoportal",region:e.region},propertiesExtractor:(t,r)=>({signingProperties:{config:t,context:r}})}}function fp(e){return{schemeId:"smithy.api#noAuth"}}var yP,SP,EP,eg=d(()=>{Ne();Ze();yP=async(e,t,r)=>({operation:ve(t).operation,region:await de(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});SP=e=>{let t=[];switch(e.operation){case"GetRoleCredentials":{t.push(fp(e));break}case"ListAccountRoles":{t.push(fp(e));break}case"ListAccounts":{t.push(fp(e));break}case"Logout":{t.push(fp(e));break}default:t.push(D5(e))}return t},EP=e=>{let t=ur(e);return Object.assign(t,{authSchemePreference:de(e.authSchemePreference??[])})}});var _P,wn,Ri=d(()=>{_P=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"awsssoportal"}),wn={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}});var wP,bP=d(()=>{wP={name:"@aws-sdk/client-sso",description:"AWS SDK for JavaScript Sso Client for Node.js, Browser and React Native",version:"3.958.0",scripts:{build:"concurrently 'yarn:build:types' 'yarn:build:es' && yarn build:cjs","build:cjs":"node ../../scripts/compilation/inline client-sso","build:es":"tsc -p tsconfig.es.json","build:include:deps":'yarn g:turbo run build -F="$npm_package_name"',"build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo sso","test:index":"tsc --noEmit ./test/index-types.ts && node ./test/index-objects.spec.mjs"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.957.0","@aws-sdk/middleware-host-header":"3.957.0","@aws-sdk/middleware-logger":"3.957.0","@aws-sdk/middleware-recursion-detection":"3.957.0","@aws-sdk/middleware-user-agent":"3.957.0","@aws-sdk/region-config-resolver":"3.957.0","@aws-sdk/types":"3.957.0","@aws-sdk/util-endpoints":"3.957.0","@aws-sdk/util-user-agent-browser":"3.957.0","@aws-sdk/util-user-agent-node":"3.957.0","@smithy/config-resolver":"^4.4.5","@smithy/core":"^3.20.0","@smithy/fetch-http-handler":"^5.3.8","@smithy/hash-node":"^4.2.7","@smithy/invalid-dependency":"^4.2.7","@smithy/middleware-content-length":"^4.2.7","@smithy/middleware-endpoint":"^4.4.1","@smithy/middleware-retry":"^4.4.17","@smithy/middleware-serde":"^4.2.8","@smithy/middleware-stack":"^4.2.7","@smithy/node-config-provider":"^4.3.7","@smithy/node-http-handler":"^4.4.7","@smithy/protocol-http":"^5.3.7","@smithy/smithy-client":"^4.10.2","@smithy/types":"^4.11.0","@smithy/url-parser":"^4.2.7","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.16","@smithy/util-defaults-mode-node":"^4.2.19","@smithy/util-endpoints":"^3.2.7","@smithy/util-middleware":"^4.2.7","@smithy/util-retry":"^4.2.7","@smithy/util-utf8":"^4.2.0",tslib:"^2.6.2"},devDependencies:{"@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-sso",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-sso"}}});var OP,Fr,Br,vi,RP,za,Ii,Ti,Wo,tg,rg,IP,TP,vP,kP,$P,Ur,CP,MP,AP,PP,DP,NP,O5,LP,UP=d(()=>{OP="required",Fr="fn",Br="argv",vi="ref",RP="isSet",za="booleanEquals",Ii="error",Ti="endpoint",Wo="tree",tg="PartitionResult",rg="getAttr",IP={[OP]:!1,type:"string"},TP={[OP]:!0,default:!1,type:"boolean"},vP={[vi]:"Endpoint"},kP={[Fr]:za,[Br]:[{[vi]:"UseFIPS"},!0]},$P={[Fr]:za,[Br]:[{[vi]:"UseDualStack"},!0]},Ur={},CP={[Fr]:rg,[Br]:[{[vi]:tg},"supportsFIPS"]},MP={[vi]:tg},AP={[Fr]:za,[Br]:[!0,{[Fr]:rg,[Br]:[MP,"supportsDualStack"]}]},PP=[kP],DP=[$P],NP=[{[vi]:"Region"}],O5={version:"1.0",parameters:{Region:IP,UseDualStack:TP,UseFIPS:TP,Endpoint:IP},rules:[{conditions:[{[Fr]:RP,[Br]:[vP]}],rules:[{conditions:PP,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Ii},{conditions:DP,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Ii},{endpoint:{url:vP,properties:Ur,headers:Ur},type:Ti}],type:Wo},{conditions:[{[Fr]:RP,[Br]:NP}],rules:[{conditions:[{[Fr]:"aws.partition",[Br]:NP,assign:tg}],rules:[{conditions:[kP,$P],rules:[{conditions:[{[Fr]:za,[Br]:[!0,CP]},AP],rules:[{endpoint:{url:"https://portal.sso-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Ur,headers:Ur},type:Ti}],type:Wo},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Ii}],type:Wo},{conditions:PP,rules:[{conditions:[{[Fr]:za,[Br]:[CP,!0]}],rules:[{conditions:[{[Fr]:"stringEquals",[Br]:[{[Fr]:rg,[Br]:[MP,"name"]},"aws-us-gov"]}],endpoint:{url:"https://portal.sso.{Region}.amazonaws.com",properties:Ur,headers:Ur},type:Ti},{endpoint:{url:"https://portal.sso-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Ur,headers:Ur},type:Ti}],type:Wo},{error:"FIPS is enabled but this partition does not support FIPS",type:Ii}],type:Wo},{conditions:DP,rules:[{conditions:[AP],rules:[{endpoint:{url:"https://portal.sso.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Ur,headers:Ur},type:Ti}],type:Wo},{error:"DualStack is enabled but this partition does not support DualStack",type:Ii}],type:Wo},{endpoint:{url:"https://portal.sso.{Region}.{PartitionResult#dnsSuffix}",properties:Ur,headers:Ur},type:Ti}],type:Wo}],type:Wo},{error:"Invalid Configuration: Missing Region",type:Ii}]},LP=O5});var k5,FP,BP=d(()=>{an();Wr();UP();k5=new bt({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),FP=(e,t={})=>k5.get(e,()=>ar(LP,{endpointParams:e,logger:t.logger}));ze.aws=kt});var HP,VP=d(()=>{Ne();Ho();Fe();N();Bo();et();Ae();eg();BP();HP=e=>({apiVersion:"2019-06-10",base64Decoder:e?.base64Decoder??Ie,base64Encoder:e?.base64Encoder??Ee,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??FP,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??SP,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new qe},{schemeId:"smithy.api#noAuth",identityProvider:t=>t.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new or}],logger:e?.logger??new ot,protocol:e?.protocol??fn,protocolSettings:e?.protocolSettings??{defaultNamespace:"com.amazonaws.sso",version:"2019-06-10",serviceTarget:"SWBPortalService"},serviceId:e?.serviceId??"SSO",urlParser:e?.urlParser??Ve,utf8Decoder:e?.utf8Decoder??_e,utf8Encoder:e?.utf8Encoder??Se})});var GP,jP=d(()=>{bP();Ne();gs();ut();xs();Ut();wr();ko();N();ys();Ss();Go();VP();GP=e=>{mr(process.version);let t=Nr(e),r=()=>t().then(fr),o=HP(e);cr(process.version);let n={profile:e?.profile,logger:o.logger};return{...o,...e,runtime:"node",defaultsMode:t,authSchemePreference:e?.authSchemePreference??P(dr,n),bodyLengthChecker:e?.bodyLengthChecker??Dr,defaultUserAgentProvider:e?.defaultUserAgentProvider??Ar({serviceId:o.serviceId,clientVersion:wP.version}),maxAttempts:e?.maxAttempts??P(Ir,e),region:e?.region??P(nt,{...Rt,...n}),requestHandler:tt.create(e?.requestHandler??r),retryMode:e?.retryMode??P({...vr,default:async()=>(await r()).retryMode||Tt},e),sha256:e?.sha256??Ct.bind(null,"sha256"),streamCollector:e?.streamCollector??xt,useDualstackEndpoint:e?.useDualstackEndpoint??P(Sr,n),useFipsEndpoint:e?.useFipsEndpoint??P(Er,n),userAgentAppId:e?.userAgentAppId??P(Pr,n)}}});var WP,zP,KP=d(()=>{WP=e=>{let t=e.httpAuthSchemes,r=e.httpAuthSchemeProvider,o=e.credentials;return{setHttpAuthScheme(n){let s=t.findIndex(i=>i.schemeId===n.schemeId);s===-1?t.push(n):t.splice(s,1,n)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(n){r=n},httpAuthSchemeProvider(){return r},setCredentials(n){o=n},credentials(){return o}}},zP=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()})});var qP,JP=d(()=>{_n();we();N();KP();qP=(e,t)=>{let r=Object.assign(Mr(e),hr(e),Kt(e),WP(e));return t.forEach(o=>o.configure(r)),Object.assign(e,Lr(r),gr(r),qt(r),zP(r))}});var mo,Ka=d(()=>{Xn();Qn();Zn();hn();ut();Fe();ae();ls();Te();Ut();N();eg();Ri();jP();JP();mo=class extends Be{config;constructor(...[t]){let r=GP(t||{});super(r),this.initConfig=r;let o=_P(r),n=nr(o),s=Tr(n),i=_r(s),a=i,c=Rr(a),l=EP(c),p=qP(l,t?.extensions||[]);this.config=p,this.middlewareStack.use(tr(this.config)),this.middlewareStack.use(yr(this.config)),this.middlewareStack.use(Cr(this.config)),this.middlewareStack.use(br(this.config)),this.middlewareStack.use(Yt(this.config)),this.middlewareStack.use(Xt(this.config)),this.middlewareStack.use(Qt(this.config)),this.middlewareStack.use(Zt(this.config,{httpAuthSchemeParametersProvider:yP,identityProviderConfigProvider:async u=>new _t({"aws.auth#sigv4":u.credentials})})),this.middlewareStack.use(er(this.config))}destroy(){super.destroy()}}});var zo,og=d(()=>{N();zo=class e extends wt{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}}});var mp,hp,gp,xp,ng=d(()=>{og();mp=class e extends zo{name="InvalidRequestException";$fault="client";constructor(t){super({name:"InvalidRequestException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},hp=class e extends zo{name="ResourceNotFoundException";$fault="client";constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},gp=class e extends zo{name="TooManyRequestsException";$fault="client";constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},xp=class e extends zo{name="UnauthorizedException";$fault="client";constructor(t){super({name:"UnauthorizedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}}});var $5,M5,L5,U5,F5,B5,H5,V5,G5,j5,W5,z5,K5,q5,J5,Y5,X5,Q5,Z5,e9,t9,r9,o9,yp,n9,s9,i9,Sp,YP,Ep,_p,a9,c9,bp,wp,Rp,Es,Ip,XP,QP,Tp,ZP,d9,l9,eD,p9,tD,u9,f9,vp,xe,Cp,m9,h9,g9,x9,y9,S9,E9,_9,b9,w9,R9,I9,T9,v9,C9,A9,P9,D9,N9,O9,rD,oD,nD,sD,Ci=d(()=>{ae();ng();og();$5="AccountInfo",M5="AccountListType",L5="AccessTokenType",U5="GetRoleCredentials",F5="GetRoleCredentialsRequest",B5="GetRoleCredentialsResponse",H5="InvalidRequestException",V5="Logout",G5="ListAccounts",j5="ListAccountsRequest",W5="ListAccountRolesRequest",z5="ListAccountRolesResponse",K5="ListAccountsResponse",q5="ListAccountRoles",J5="LogoutRequest",Y5="RoleCredentials",X5="RoleInfo",Q5="RoleListType",Z5="ResourceNotFoundException",e9="SecretAccessKeyType",t9="SessionTokenType",r9="TooManyRequestsException",o9="UnauthorizedException",yp="accountId",n9="accessKeyId",s9="accountList",i9="accountName",Sp="accessToken",YP="account_id",Ep="client",_p="error",a9="emailAddress",c9="expiration",bp="http",wp="httpError",Rp="httpHeader",Es="httpQuery",Ip="message",XP="maxResults",QP="max_result",Tp="nextToken",ZP="next_token",d9="roleCredentials",l9="roleList",eD="roleName",p9="role_name",tD="smithy.ts.sdk.synthetic.com.amazonaws.sso",u9="secretAccessKey",f9="sessionToken",vp="x-amz-sso_bearer_token",xe="com.amazonaws.sso",Cp=[0,xe,L5,8,0],m9=[0,xe,e9,8,0],h9=[0,xe,t9,8,0],g9=[3,xe,$5,0,[yp,i9,a9],[0,0,0]],x9=[3,xe,F5,0,[eD,yp,Sp],[[0,{[Es]:p9}],[0,{[Es]:YP}],[()=>Cp,{[Rp]:vp}]]],y9=[3,xe,B5,0,[d9],[[()=>T9,0]]],S9=[-3,xe,H5,{[_p]:Ep,[wp]:400},[Ip],[0]];S.for(xe).registerError(S9,mp);E9=[3,xe,W5,0,[Tp,XP,Sp,yp],[[0,{[Es]:ZP}],[1,{[Es]:QP}],[()=>Cp,{[Rp]:vp}],[0,{[Es]:YP}]]],_9=[3,xe,z5,0,[Tp,l9],[0,()=>O9]],b9=[3,xe,j5,0,[Tp,XP,Sp],[[0,{[Es]:ZP}],[1,{[Es]:QP}],[()=>Cp,{[Rp]:vp}]]],w9=[3,xe,K5,0,[Tp,s9],[0,()=>N9]],R9=[3,xe,J5,0,[Sp],[[()=>Cp,{[Rp]:vp}]]],I9=[-3,xe,Z5,{[_p]:Ep,[wp]:404},[Ip],[0]];S.for(xe).registerError(I9,hp);T9=[3,xe,Y5,0,[n9,u9,f9,c9],[0,[()=>m9,0],[()=>h9,0],1]],v9=[3,xe,X5,0,[eD,yp],[0,0]],C9=[-3,xe,r9,{[_p]:Ep,[wp]:429},[Ip],[0]];S.for(xe).registerError(C9,gp);A9=[-3,xe,o9,{[_p]:Ep,[wp]:401},[Ip],[0]];S.for(xe).registerError(A9,xp);P9="unit",D9=[-3,tD,"SSOServiceException",0,[],[]];S.for(tD).registerError(D9,zo);N9=[1,xe,M5,0,()=>g9],O9=[1,xe,Q5,0,()=>v9],rD=[9,xe,U5,{[bp]:["GET","/federation/credentials",200]},()=>x9,()=>y9],oD=[9,xe,q5,{[bp]:["GET","/assignment/roles",200]},()=>E9,()=>_9],nD=[9,xe,G5,{[bp]:["GET","/assignment/accounts",200]},()=>b9,()=>w9],sD=[9,xe,V5,{[bp]:["POST","/logout",200]},()=>R9,()=>P9]});var Ai,sg=d(()=>{Te();N();Ri();Ci();Ai=class extends V.classBuilder().ep(wn).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("SWBPortalService","GetRoleCredentials",{}).n("SSOClient","GetRoleCredentialsCommand").sc(rD).build(){}});var Pi,Ap=d(()=>{Te();N();Ri();Ci();Pi=class extends V.classBuilder().ep(wn).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("SWBPortalService","ListAccountRoles",{}).n("SSOClient","ListAccountRolesCommand").sc(oD).build(){}});var Di,Pp=d(()=>{Te();N();Ri();Ci();Di=class extends V.classBuilder().ep(wn).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("SWBPortalService","ListAccounts",{}).n("SSOClient","ListAccountsCommand").sc(nD).build(){}});var Dp,ig=d(()=>{Te();N();Ri();Ci();Dp=class extends V.classBuilder().ep(wn).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("SWBPortalService","Logout",{}).n("SSOClient","LogoutCommand").sc(sD).build(){}});var k9,ag,iD=d(()=>{N();sg();Ap();Pp();ig();Ka();k9={GetRoleCredentialsCommand:Ai,ListAccountRolesCommand:Pi,ListAccountsCommand:Di,LogoutCommand:Dp},ag=class extends mo{};ln(k9,ag)});var aD=d(()=>{sg();Ap();Pp();ig()});var cD=d(()=>{});var l0e,dD=d(()=>{Fe();Ap();Ka();l0e=No(mo,Pi,"nextToken","nextToken","maxResults")});var h0e,lD=d(()=>{Fe();Pp();Ka();h0e=No(mo,Di,"nextToken","nextToken","maxResults")});var pD=d(()=>{cD();dD();lD()});var uD=d(()=>{});var fD=d(()=>{Ka();iD();aD();Ci();pD();ng();uD()});var mD={};Nt(mD,{GetRoleCredentialsCommand:()=>Ai,SSOClient:()=>mo});var hD=d(()=>{fD()});var qa,cg,gD=d(()=>{Ke();xP();fe();ft();qa=!1,cg=async({ssoStartUrl:e,ssoSession:t,ssoAccountId:r,ssoRegion:o,ssoRoleName:n,ssoClient:s,clientConfig:i,parentClientConfig:a,callerClientConfig:c,profile:l,filepath:p,configFilepath:u,ignoreCache:f,logger:m})=>{let h,g="To refresh this SSO session run aws sso login with the corresponding profile.";if(t)try{let Nn=await fP({profile:l,filepath:p,configFilepath:u,ignoreCache:f})();h={accessToken:Nn.token,expiresAt:new Date(Nn.expiration).toISOString()}}catch(Nn){throw new v(Nn.message,{tryNextLink:qa,logger:m})}else try{h=await ya(e)}catch{throw new v(`The SSO session associated with this profile is invalid. ${g}`,{tryNextLink:qa,logger:m})}if(new Date(h.expiresAt).getTime()-Date.now()<=0)throw new v(`The SSO session associated with this profile has expired. ${g}`,{tryNextLink:qa,logger:m});let{accessToken:E}=h,{SSOClient:w,GetRoleCredentialsCommand:C}=await Promise.resolve().then(()=>(hD(),mD)),ie=s||new w(Object.assign({},i??{},{logger:i?.logger??c?.logger??a?.logger,region:i?.region??o,userAgentAppId:i?.userAgentAppId??c?.userAgentAppId??a?.userAgentAppId})),he;try{he=await ie.send(new C({accountId:r,roleName:n,accessToken:E}))}catch(Nn){throw new v(Nn,{tryNextLink:qa,logger:m})}let{roleCredentials:{accessKeyId:Me,secretAccessKey:je,sessionToken:Dn,expiration:ye,credentialScope:Ht,accountId:Px}={}}=he;if(!Me||!je||!Dn||!ye)throw new v("SSO returns an invalid temporary credential.",{tryNextLink:qa,logger:m});let Wu={accessKeyId:Me,secretAccessKey:je,sessionToken:Dn,expiration:new Date(ye),...Ht&&{credentialScope:Ht},...Px&&{accountId:Px}};return t?q(Wu,"CREDENTIALS_SSO","s"):q(Wu,"CREDENTIALS_SSO_LEGACY","u"),Wu}});var dg,lg=d(()=>{fe();dg=(e,t)=>{let{sso_start_url:r,sso_account_id:o,sso_region:n,sso_role_name:s}=e;if(!r||!o||!n||!s)throw new v(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,{tryNextLink:!1,logger:t});return e}});var $9,xD=d(()=>{fe();ft();Fh();gD();lg();$9=(e={})=>async({callerClientConfig:t}={})=>{e.logger?.debug("@aws-sdk/credential-provider-sso - fromSSO");let{ssoStartUrl:r,ssoAccountId:o,ssoRegion:n,ssoRoleName:s,ssoSession:i}=e,{ssoClient:a}=e,c=It({profile:e.profile??t?.profile});if(!r&&!o&&!n&&!s&&!i){let p=(await po(e))[c];if(!p)throw new v(`Profile ${c} was not found.`,{logger:e.logger});if(!Uh(p))throw new v(`Profile ${c} is not configured with SSO credentials.`,{logger:e.logger});if(p?.sso_session){let w=(await sl(e))[p.sso_session],C=` configurations in profile ${c} and sso-session ${p.sso_session}`;if(n&&n!==w.sso_region)throw new v("Conflicting SSO region"+C,{tryNextLink:!1,logger:e.logger});if(r&&r!==w.sso_start_url)throw new v("Conflicting SSO start_url"+C,{tryNextLink:!1,logger:e.logger});p.sso_region=w.sso_region,p.sso_start_url=w.sso_start_url}let{sso_start_url:u,sso_account_id:f,sso_region:m,sso_role_name:h,sso_session:g}=dg(p,e.logger);return cg({ssoStartUrl:u,ssoSession:g,ssoAccountId:f,ssoRegion:m,ssoRoleName:h,ssoClient:a,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,callerClientConfig:e.callerClientConfig,profile:c,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}else{if(!r||!o||!n||!s)throw new v('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"',{tryNextLink:!1,logger:e.logger});return cg({ssoStartUrl:r,ssoSession:i,ssoAccountId:o,ssoRegion:n,ssoRoleName:s,ssoClient:a,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,callerClientConfig:e.callerClientConfig,profile:c,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}}});var yD=d(()=>{});var pg={};Nt(pg,{fromSSO:()=>$9,isSsoProfile:()=>Uh,validateSsoProfile:()=>dg});var ug=d(()=>{xD();Fh();yD();lg()});var SD,fg,ED=d(()=>{Ke();fe();SD=(e,t,r)=>{let o={EcsContainer:async n=>{let{fromHttp:s}=await Promise.resolve().then(()=>(Lh(),Mh)),{fromContainerMetadata:i}=await Promise.resolve().then(()=>(Pa(),Aa));return r?.debug("@aws-sdk/credential-provider-ini - credential_source is EcsContainer"),async()=>ni(s(n??{}),i(n))().then(fg)},Ec2InstanceMetadata:async n=>{r?.debug("@aws-sdk/credential-provider-ini - credential_source is Ec2InstanceMetadata");let{fromInstanceMetadata:s}=await Promise.resolve().then(()=>(Pa(),Aa));return async()=>s(n)().then(fg)},Environment:async n=>{r?.debug("@aws-sdk/credential-provider-ini - credential_source is Environment");let{fromEnv:s}=await Promise.resolve().then(()=>(vh(),lC));return async()=>s(n)().then(fg)}};if(e in o)return o[e];throw new v(`Unsupported credential source in profile ${t}. Got ${e}, expected EcsContainer or Ec2InstanceMetadata or Environment.`,{logger:r})},fg=e=>q(e,"CREDENTIALS_PROFILE_NAMED_PROVIDER","p")});function M9(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"sts",region:e.region},propertiesExtractor:(t,r)=>({signingProperties:{config:t,context:r}})}}function L9(e){return{schemeId:"smithy.api#noAuth"}}var _D,bD,U9,wD,mg=d(()=>{Ne();Ze();Ja();_D=async(e,t,r)=>({operation:ve(t).operation,region:await de(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});bD=e=>{let t=[];switch(e.operation){case"AssumeRoleWithWebIdentity":{t.push(L9(e));break}default:t.push(M9(e))}return t},U9=e=>Object.assign(e,{stsClientCtor:ho}),wD=e=>{let t=U9(e),r=ur(t);return Object.assign(r,{authSchemePreference:de(e.authSchemePreference??[])})}});var RD,Np,Op=d(()=>{RD=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,useGlobalEndpoint:e.useGlobalEndpoint??!1,defaultSigningName:"sts"}),Np={UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}});var $D,B,ne,se,In,Rn,Je,MD,LD,UD,Re,ID,go,Ni,gg,TD,hg,FD,vD,Ye,CD,BD,HD,st,Ft,AD,VD,GD,PD,jD,DD,ND,OD,kD,F9,WD,zD=d(()=>{$D="required",B="type",ne="fn",se="argv",In="ref",Rn="booleanEquals",Je="stringEquals",MD="sigv4",LD="sts",UD="us-east-1",Re="endpoint",ID="https://sts.{Region}.{PartitionResult#dnsSuffix}",go="tree",Ni="error",gg="getAttr",TD={[$D]:!1,[B]:"string"},hg={[$D]:!0,default:!1,[B]:"boolean"},FD={[In]:"Endpoint"},vD={[ne]:"isSet",[se]:[{[In]:"Region"}]},Ye={[In]:"Region"},CD={[ne]:"aws.partition",[se]:[Ye],assign:"PartitionResult"},BD={[In]:"UseFIPS"},HD={[In]:"UseDualStack"},st={url:"https://sts.amazonaws.com",properties:{authSchemes:[{name:MD,signingName:LD,signingRegion:UD}]},headers:{}},Ft={},AD={conditions:[{[ne]:Je,[se]:[Ye,"aws-global"]}],[Re]:st,[B]:Re},VD={[ne]:Rn,[se]:[BD,!0]},GD={[ne]:Rn,[se]:[HD,!0]},PD={[ne]:gg,[se]:[{[In]:"PartitionResult"},"supportsFIPS"]},jD={[In]:"PartitionResult"},DD={[ne]:Rn,[se]:[!0,{[ne]:gg,[se]:[jD,"supportsDualStack"]}]},ND=[{[ne]:"isSet",[se]:[FD]}],OD=[VD],kD=[GD],F9={version:"1.0",parameters:{Region:TD,UseDualStack:hg,UseFIPS:hg,Endpoint:TD,UseGlobalEndpoint:hg},rules:[{conditions:[{[ne]:Rn,[se]:[{[In]:"UseGlobalEndpoint"},!0]},{[ne]:"not",[se]:ND},vD,CD,{[ne]:Rn,[se]:[BD,!1]},{[ne]:Rn,[se]:[HD,!1]}],rules:[{conditions:[{[ne]:Je,[se]:[Ye,"ap-northeast-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"ap-south-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"ap-southeast-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"ap-southeast-2"]}],endpoint:st,[B]:Re},AD,{conditions:[{[ne]:Je,[se]:[Ye,"ca-central-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"eu-central-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"eu-north-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"eu-west-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"eu-west-2"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"eu-west-3"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"sa-east-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,UD]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"us-east-2"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"us-west-1"]}],endpoint:st,[B]:Re},{conditions:[{[ne]:Je,[se]:[Ye,"us-west-2"]}],endpoint:st,[B]:Re},{endpoint:{url:ID,properties:{authSchemes:[{name:MD,signingName:LD,signingRegion:"{Region}"}]},headers:Ft},[B]:Re}],[B]:go},{conditions:ND,rules:[{conditions:OD,error:"Invalid Configuration: FIPS and custom endpoint are not supported",[B]:Ni},{conditions:kD,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",[B]:Ni},{endpoint:{url:FD,properties:Ft,headers:Ft},[B]:Re}],[B]:go},{conditions:[vD],rules:[{conditions:[CD],rules:[{conditions:[VD,GD],rules:[{conditions:[{[ne]:Rn,[se]:[!0,PD]},DD],rules:[{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Ft,headers:Ft},[B]:Re}],[B]:go},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[B]:Ni}],[B]:go},{conditions:OD,rules:[{conditions:[{[ne]:Rn,[se]:[PD,!0]}],rules:[{conditions:[{[ne]:Je,[se]:[{[ne]:gg,[se]:[jD,"name"]},"aws-us-gov"]}],endpoint:{url:"https://sts.{Region}.amazonaws.com",properties:Ft,headers:Ft},[B]:Re},{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Ft,headers:Ft},[B]:Re}],[B]:go},{error:"FIPS is enabled but this partition does not support FIPS",[B]:Ni}],[B]:go},{conditions:kD,rules:[{conditions:[DD],rules:[{endpoint:{url:"https://sts.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Ft,headers:Ft},[B]:Re}],[B]:go},{error:"DualStack is enabled but this partition does not support DualStack",[B]:Ni}],[B]:go},AD,{endpoint:{url:ID,properties:Ft,headers:Ft},[B]:Re}],[B]:go}],[B]:go},{error:"Invalid Configuration: Missing Region",[B]:Ni}]},WD=F9});var B9,KD,qD=d(()=>{an();Wr();zD();B9=new bt({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS","UseGlobalEndpoint"]}),KD=(e,t={})=>B9.get(e,()=>ar(WD,{endpointParams:e,logger:t.logger}));ze.aws=kt});var JD,YD=d(()=>{Ne();Ho();Fe();N();Bo();et();Ae();mg();qD();JD=e=>({apiVersion:"2011-06-15",base64Decoder:e?.base64Decoder??Ie,base64Encoder:e?.base64Encoder??Ee,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??KD,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??bD,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new qe},{schemeId:"smithy.api#noAuth",identityProvider:t=>t.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new or}],logger:e?.logger??new ot,protocol:e?.protocol??pi,protocolSettings:e?.protocolSettings??{defaultNamespace:"com.amazonaws.sts",xmlNamespace:"https://sts.amazonaws.com/doc/2011-06-15/",version:"2011-06-15",serviceTarget:"AWSSecurityTokenServiceV20110615"},serviceId:e?.serviceId??"STS",urlParser:e?.urlParser??Ve,utf8Decoder:e?.utf8Decoder??_e,utf8Encoder:e?.utf8Encoder??Se})});var XD,QD=d(()=>{lp();Ne();gs();ut();Fe();xs();Ut();wr();ko();N();ys();Ss();Go();YD();XD=e=>{mr(process.version);let t=Nr(e),r=()=>t().then(fr),o=JD(e);cr(process.version);let n={profile:e?.profile,logger:o.logger};return{...o,...e,runtime:"node",defaultsMode:t,authSchemePreference:e?.authSchemePreference??P(dr,n),bodyLengthChecker:e?.bodyLengthChecker??Dr,defaultUserAgentProvider:e?.defaultUserAgentProvider??Ar({serviceId:o.serviceId,clientVersion:Ei.version}),httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:s=>s.getIdentityProvider("aws.auth#sigv4")||(async i=>await e.credentialDefaultProvider(i?.__config||{})()),signer:new qe},{schemeId:"smithy.api#noAuth",identityProvider:s=>s.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new or}],maxAttempts:e?.maxAttempts??P(Ir,e),region:e?.region??P(nt,{...Rt,...n}),requestHandler:tt.create(e?.requestHandler??r),retryMode:e?.retryMode??P({...vr,default:async()=>(await r()).retryMode||Tt},e),sha256:e?.sha256??Ct.bind(null,"sha256"),streamCollector:e?.streamCollector??xt,useDualstackEndpoint:e?.useDualstackEndpoint??P(Sr,n),useFipsEndpoint:e?.useFipsEndpoint??P(Er,n),userAgentAppId:e?.userAgentAppId??P(Pr,n)}}});var ZD,eN,tN=d(()=>{ZD=e=>{let t=e.httpAuthSchemes,r=e.httpAuthSchemeProvider,o=e.credentials;return{setHttpAuthScheme(n){let s=t.findIndex(i=>i.schemeId===n.schemeId);s===-1?t.push(n):t.splice(s,1,n)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(n){r=n},httpAuthSchemeProvider(){return r},setCredentials(n){o=n},credentials(){return o}}},eN=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()})});var rN,oN=d(()=>{_n();we();N();tN();rN=(e,t)=>{let r=Object.assign(Mr(e),hr(e),Kt(e),ZD(e));return t.forEach(o=>o.configure(r)),Object.assign(e,Lr(r),gr(r),qt(r),eN(r))}});var ho,Ja=d(()=>{Xn();Qn();Zn();hn();ut();Fe();ae();ls();Te();Ut();N();mg();Op();QD();oN();ho=class extends Be{config;constructor(...[t]){let r=XD(t||{});super(r),this.initConfig=r;let o=RD(r),n=nr(o),s=Tr(n),i=_r(s),a=i,c=Rr(a),l=wD(c),p=rN(l,t?.extensions||[]);this.config=p,this.middlewareStack.use(tr(this.config)),this.middlewareStack.use(yr(this.config)),this.middlewareStack.use(Cr(this.config)),this.middlewareStack.use(br(this.config)),this.middlewareStack.use(Yt(this.config)),this.middlewareStack.use(Xt(this.config)),this.middlewareStack.use(Qt(this.config)),this.middlewareStack.use(Zt(this.config,{httpAuthSchemeParametersProvider:_D,identityProviderConfigProvider:async u=>new _t({"aws.auth#sigv4":u.credentials})})),this.middlewareStack.use(er(this.config))}destroy(){super.destroy()}}});var At,kp=d(()=>{N();At=class e extends wt{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}}});var Ya,Xa,Qa,Za,ec,tc,rc,xg=d(()=>{kp();Ya=class e extends At{name="ExpiredTokenException";$fault="client";constructor(t){super({name:"ExpiredTokenException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Xa=class e extends At{name="MalformedPolicyDocumentException";$fault="client";constructor(t){super({name:"MalformedPolicyDocumentException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Qa=class e extends At{name="PackedPolicyTooLargeException";$fault="client";constructor(t){super({name:"PackedPolicyTooLargeException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Za=class e extends At{name="RegionDisabledException";$fault="client";constructor(t){super({name:"RegionDisabledException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},ec=class e extends At{name="IDPRejectedClaimException";$fault="client";constructor(t){super({name:"IDPRejectedClaimException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},tc=class e extends At{name="InvalidIdentityTokenException";$fault="client";constructor(t){super({name:"InvalidIdentityTokenException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},rc=class e extends At{name="IDPCommunicationErrorException";$fault="client";constructor(t){super({name:"IDPCommunicationErrorException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}}});var H9,V9,G9,j9,W9,z9,yg,K9,q9,J9,Y9,Sg,X9,nN,Q9,Z9,e8,t8,r8,o8,n8,s8,sN,iN,i8,a8,c8,d8,l8,p8,aN,u8,f8,cN,m8,dN,h8,g8,Eg,x8,y8,S8,E8,_8,b8,w8,R8,I8,T8,_s,bs,v8,ws,Rs,Is,C8,lN,A8,ue,P8,D8,_g,pN,uN,fN,mN,bg,hN,gN,xN,yN,SN,EN,_N,bN,wN,RN,IN,TN,N8,O8,wg,Rg,$p=d(()=>{ae();xg();kp();H9="Arn",V9="AccessKeyId",G9="AssumeRole",j9="AssumedRoleId",W9="AssumeRoleRequest",z9="AssumeRoleResponse",yg="AssumedRoleUser",K9="AssumeRoleWithWebIdentity",q9="AssumeRoleWithWebIdentityRequest",J9="AssumeRoleWithWebIdentityResponse",Y9="Audience",Sg="Credentials",X9="ContextAssertion",nN="DurationSeconds",Q9="Expiration",Z9="ExternalId",e8="ExpiredTokenException",t8="IDPCommunicationErrorException",r8="IDPRejectedClaimException",o8="InvalidIdentityTokenException",n8="Key",s8="MalformedPolicyDocumentException",sN="Policy",iN="PolicyArns",i8="ProviderArn",a8="ProvidedContexts",c8="ProvidedContextsListType",d8="ProvidedContext",l8="PolicyDescriptorType",p8="ProviderId",aN="PackedPolicySize",u8="PackedPolicyTooLargeException",f8="Provider",cN="RoleArn",m8="RegionDisabledException",dN="RoleSessionName",h8="SecretAccessKey",g8="SubjectFromWebIdentityToken",Eg="SourceIdentity",x8="SerialNumber",y8="SessionToken",S8="Tags",E8="TokenCode",_8="TransitiveTagKeys",b8="Tag",w8="Value",R8="WebIdentityToken",I8="arn",T8="accessKeySecretType",_s="awsQueryError",bs="client",v8="clientTokenType",ws="error",Rs="httpError",Is="message",C8="policyDescriptorListType",lN="smithy.ts.sdk.synthetic.com.amazonaws.sts",A8="tagListType",ue="com.amazonaws.sts",P8=[0,ue,T8,8,0],D8=[0,ue,v8,8,0],_g=[3,ue,yg,0,[j9,H9],[0,0]],pN=[3,ue,W9,0,[cN,dN,iN,sN,nN,S8,_8,Z9,x8,E8,Eg,a8],[0,0,()=>TN,0,1,()=>O8,64,0,0,0,0,()=>N8]],uN=[3,ue,z9,0,[Sg,yg,aN,Eg],[[()=>bg,0],()=>_g,1,0]],fN=[3,ue,q9,0,[cN,dN,R8,p8,iN,sN,nN],[0,0,[()=>D8,0],0,()=>TN,0,1]],mN=[3,ue,J9,0,[Sg,g8,yg,aN,f8,Y9,Eg],[[()=>bg,0],0,()=>_g,1,0,0,0]],bg=[3,ue,Sg,0,[V9,h8,y8,Q9],[0,[()=>P8,0],0,4]],hN=[-3,ue,e8,{[_s]:["ExpiredTokenException",400],[ws]:bs,[Rs]:400},[Is],[0]];S.for(ue).registerError(hN,Ya);gN=[-3,ue,t8,{[_s]:["IDPCommunicationError",400],[ws]:bs,[Rs]:400},[Is],[0]];S.for(ue).registerError(gN,rc);xN=[-3,ue,r8,{[_s]:["IDPRejectedClaim",403],[ws]:bs,[Rs]:403},[Is],[0]];S.for(ue).registerError(xN,ec);yN=[-3,ue,o8,{[_s]:["InvalidIdentityToken",400],[ws]:bs,[Rs]:400},[Is],[0]];S.for(ue).registerError(yN,tc);SN=[-3,ue,s8,{[_s]:["MalformedPolicyDocument",400],[ws]:bs,[Rs]:400},[Is],[0]];S.for(ue).registerError(SN,Xa);EN=[-3,ue,u8,{[_s]:["PackedPolicyTooLarge",400],[ws]:bs,[Rs]:400},[Is],[0]];S.for(ue).registerError(EN,Qa);_N=[3,ue,l8,0,[I8],[0]],bN=[3,ue,d8,0,[i8,X9],[0,0]],wN=[-3,ue,m8,{[_s]:["RegionDisabledException",403],[ws]:bs,[Rs]:403},[Is],[0]];S.for(ue).registerError(wN,Za);RN=[3,ue,b8,0,[n8,w8],[0,0]],IN=[-3,lN,"STSServiceException",0,[],[]];S.for(lN).registerError(IN,At);TN=[1,ue,C8,0,()=>_N],N8=[1,ue,c8,0,()=>bN],O8=[1,ue,A8,0,()=>RN],wg=[9,ue,G9,0,()=>pN,()=>uN],Rg=[9,ue,K9,0,()=>fN,()=>mN]});var Ts,Mp=d(()=>{Te();N();Op();$p();Ts=class extends V.classBuilder().ep(Np).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRole",{}).n("STSClient","AssumeRoleCommand").sc(wg).build(){}});var vs,Lp=d(()=>{Te();N();Op();$p();vs=class extends V.classBuilder().ep(Np).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRoleWithWebIdentity",{}).n("STSClient","AssumeRoleWithWebIdentityCommand").sc(Rg).build(){}});var k8,Up,vN=d(()=>{N();Mp();Lp();Ja();k8={AssumeRoleCommand:Ts,AssumeRoleWithWebIdentityCommand:vs},Up=class extends ho{};ln(k8,Up)});var CN=d(()=>{Mp();Lp()});var AN=d(()=>{});var PN,DN,NN,ON,kN,$N=d(()=>{Ke();_n();Mp();Lp();PN=e=>{if(typeof e?.Arn=="string"){let t=e.Arn.split(":");if(t.length>4&&t[4]!=="")return t[4]}},DN=async(e,t,r,o={})=>{let n=typeof e=="function"?await e():e,s=typeof t=="function"?await t():t,i="",a=n??s??(i=await AA(o)());return r?.debug?.("@aws-sdk/client-sts::resolveRegion","accepting first of:",`${n} (credential provider clientConfig)`,`${s} (contextual client)`,`${i} (STS default: AWS_REGION, profile region, or us-east-1)`),a},NN=(e,t)=>{let r,o;return async(n,s)=>{if(o=n,!r){let{logger:p=e?.parentClientConfig?.logger,profile:u=e?.parentClientConfig?.profile,region:f,requestHandler:m=e?.parentClientConfig?.requestHandler,credentialProviderLogger:h,userAgentAppId:g=e?.parentClientConfig?.userAgentAppId}=e,E=await DN(f,e?.parentClientConfig?.region,h,{logger:p,profile:u}),w=!kN(m);r=new t({...e,userAgentAppId:g,profile:u,credentialDefaultProvider:()=>async()=>o,region:E,requestHandler:w?m:void 0,logger:p})}let{Credentials:i,AssumedRoleUser:a}=await r.send(new Ts(s));if(!i||!i.AccessKeyId||!i.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRole call with role ${s.RoleArn}`);let c=PN(a),l={accessKeyId:i.AccessKeyId,secretAccessKey:i.SecretAccessKey,sessionToken:i.SessionToken,expiration:i.Expiration,...i.CredentialScope&&{credentialScope:i.CredentialScope},...c&&{accountId:c}};return q(l,"CREDENTIALS_STS_ASSUME_ROLE","i"),l}},ON=(e,t)=>{let r;return async o=>{if(!r){let{logger:c=e?.parentClientConfig?.logger,profile:l=e?.parentClientConfig?.profile,region:p,requestHandler:u=e?.parentClientConfig?.requestHandler,credentialProviderLogger:f,userAgentAppId:m=e?.parentClientConfig?.userAgentAppId}=e,h=await DN(p,e?.parentClientConfig?.region,f,{logger:c,profile:l}),g=!kN(u);r=new t({...e,userAgentAppId:m,profile:l,region:h,requestHandler:g?u:void 0,logger:c})}let{Credentials:n,AssumedRoleUser:s}=await r.send(new vs(o));if(!n||!n.AccessKeyId||!n.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${o.RoleArn}`);let i=PN(s),a={accessKeyId:n.AccessKeyId,secretAccessKey:n.SecretAccessKey,sessionToken:n.SessionToken,expiration:n.Expiration,...n.CredentialScope&&{credentialScope:n.CredentialScope},...i&&{accountId:i}};return i&&q(a,"RESOLVED_ACCOUNT_ID","T"),q(a,"CREDENTIALS_STS_ASSUME_ROLE_WEB_ID","k"),a}},kN=e=>e?.metadata?.handlerProtocol==="h2"});var MN,LN,UN,$8,FN=d(()=>{$N();Ja();MN=(e,t)=>t?class extends e{constructor(o){super(o);for(let n of t)this.middlewareStack.use(n)}}:e,LN=(e={},t)=>NN(e,MN(ho,t)),UN=(e={},t)=>ON(e,MN(ho,t)),$8=e=>t=>e({roleAssumer:LN(t),roleAssumerWithWebIdentity:UN(t),...t})});var Ig={};Nt(Ig,{$Command:()=>V,AssumeRole$:()=>wg,AssumeRoleCommand:()=>Ts,AssumeRoleRequest$:()=>pN,AssumeRoleResponse$:()=>uN,AssumeRoleWithWebIdentity$:()=>Rg,AssumeRoleWithWebIdentityCommand:()=>vs,AssumeRoleWithWebIdentityRequest$:()=>fN,AssumeRoleWithWebIdentityResponse$:()=>mN,AssumedRoleUser$:()=>_g,Credentials$:()=>bg,ExpiredTokenException:()=>Ya,ExpiredTokenException$:()=>hN,IDPCommunicationErrorException:()=>rc,IDPCommunicationErrorException$:()=>gN,IDPRejectedClaimException:()=>ec,IDPRejectedClaimException$:()=>xN,InvalidIdentityTokenException:()=>tc,InvalidIdentityTokenException$:()=>yN,MalformedPolicyDocumentException:()=>Xa,MalformedPolicyDocumentException$:()=>SN,PackedPolicyTooLargeException:()=>Qa,PackedPolicyTooLargeException$:()=>EN,PolicyDescriptorType$:()=>_N,ProvidedContext$:()=>bN,RegionDisabledException:()=>Za,RegionDisabledException$:()=>wN,STS:()=>Up,STSClient:()=>ho,STSServiceException:()=>At,STSServiceException$:()=>IN,Tag$:()=>RN,__Client:()=>Be,decorateDefaultCredentialProvider:()=>$8,getDefaultRoleAssumer:()=>LN,getDefaultRoleAssumerWithWebIdentity:()=>UN});var Tg=d(()=>{Ja();vN();CN();$p();xg();AN();FN();kp()});var HN,M8,L8,VN,BN,GN=d(()=>{Ke();fe();ft();ED();HN=(e,{profile:t="default",logger:r}={})=>!!e&&typeof e=="object"&&typeof e.role_arn=="string"&&["undefined","string"].indexOf(typeof e.role_session_name)>-1&&["undefined","string"].indexOf(typeof e.external_id)>-1&&["undefined","string"].indexOf(typeof e.mfa_serial)>-1&&(M8(e,{profile:t,logger:r})||L8(e,{profile:t,logger:r})),M8=(e,{profile:t,logger:r})=>{let o=typeof e.source_profile=="string"&&typeof e.credential_source>"u";return o&&r?.debug?.(`    ${t} isAssumeRoleWithSourceProfile source_profile=${e.source_profile}`),o},L8=(e,{profile:t,logger:r})=>{let o=typeof e.credential_source=="string"&&typeof e.source_profile>"u";return o&&r?.debug?.(`    ${t} isCredentialSourceProfile credential_source=${e.credential_source}`),o},VN=async(e,t,r,o,n={},s)=>{r.logger?.debug("@aws-sdk/credential-provider-ini - resolveAssumeRoleCredentials (STS)");let i=t[e],{source_profile:a,region:c}=i;if(!r.roleAssumer){let{getDefaultRoleAssumer:p}=await Promise.resolve().then(()=>(Tg(),Ig));r.roleAssumer=p({...r.clientConfig,credentialProviderLogger:r.logger,parentClientConfig:{...o,...r?.parentClientConfig,region:c??r?.parentClientConfig?.region??o?.region}},r.clientPlugins)}if(a&&a in n)throw new v(`Detected a cycle attempting to resolve credentials for profile ${It(r)}. Profiles visited: `+Object.keys(n).join(", "),{logger:r.logger});r.logger?.debug(`@aws-sdk/credential-provider-ini - finding credential resolver using ${a?`source_profile=[${a}]`:`profile=[${e}]`}`);let l=a?s(a,t,r,o,{...n,[a]:!0},BN(t[a]??{})):(await SD(i.credential_source,e,r.logger)(r))();if(BN(i))return l.then(p=>q(p,"CREDENTIALS_PROFILE_SOURCE_PROFILE","o"));{let p={RoleArn:i.role_arn,RoleSessionName:i.role_session_name||`aws-sdk-js-${Date.now()}`,ExternalId:i.external_id,DurationSeconds:parseInt(i.duration_seconds||"3600",10)},{mfa_serial:u}=i;if(u){if(!r.mfaCodeProvider)throw new v(`Profile ${e} requires multi-factor authentication, but no MFA code callback was provided.`,{logger:r.logger,tryNextLink:!1});p.SerialNumber=u,p.TokenCode=await r.mfaCodeProvider(u)}let f=await l;return r.roleAssumer(f,p).then(m=>q(m,"CREDENTIALS_PROFILE_SOURCE_PROFILE","o"))}},BN=e=>!e.role_arn&&!!e.credential_source});function U8(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"signin",region:e.region},propertiesExtractor:(t,r)=>({signingProperties:{config:t,context:r}})}}function F8(e){return{schemeId:"smithy.api#noAuth"}}var jN,WN,zN,vg=d(()=>{Ne();Ze();jN=async(e,t,r)=>({operation:ve(t).operation,region:await de(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});WN=e=>{let t=[];switch(e.operation){case"CreateOAuth2Token":{t.push(F8(e));break}default:t.push(U8(e))}return t},zN=e=>{let t=ur(e);return Object.assign(t,{authSchemePreference:de(e.authSchemePreference??[])})}});var KN,qN,Cg=d(()=>{KN=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"signin"}),qN={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}});var rO,at,ct,Ko,JN,Cs,Oi,Tn,qr,Hp,Ag,YN,XN,QN,Pg,Dg,it,Ng,Fp,Bp,ZN,eO,tO,B8,oO,nO=d(()=>{rO="required",at="fn",ct="argv",Ko="ref",JN="isSet",Cs="booleanEquals",Oi="error",Tn="endpoint",qr="tree",Hp="PartitionResult",Ag="stringEquals",YN={[rO]:!0,default:!1,type:"boolean"},XN={[rO]:!1,type:"string"},QN={[Ko]:"Endpoint"},Pg={[at]:Cs,[ct]:[{[Ko]:"UseFIPS"},!0]},Dg={[at]:Cs,[ct]:[{[Ko]:"UseDualStack"},!0]},it={},Ng={[at]:"getAttr",[ct]:[{[Ko]:Hp},"name"]},Fp={[at]:Cs,[ct]:[{[Ko]:"UseFIPS"},!1]},Bp={[at]:Cs,[ct]:[{[Ko]:"UseDualStack"},!1]},ZN={[at]:"getAttr",[ct]:[{[Ko]:Hp},"supportsFIPS"]},eO={[at]:Cs,[ct]:[!0,{[at]:"getAttr",[ct]:[{[Ko]:Hp},"supportsDualStack"]}]},tO=[{[Ko]:"Region"}],B8={version:"1.0",parameters:{UseDualStack:YN,UseFIPS:YN,Endpoint:XN,Region:XN},rules:[{conditions:[{[at]:JN,[ct]:[QN]}],rules:[{conditions:[Pg],error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Oi},{rules:[{conditions:[Dg],error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Oi},{endpoint:{url:QN,properties:it,headers:it},type:Tn}],type:qr}],type:qr},{rules:[{conditions:[{[at]:JN,[ct]:tO}],rules:[{conditions:[{[at]:"aws.partition",[ct]:tO,assign:Hp}],rules:[{conditions:[{[at]:Ag,[ct]:[Ng,"aws"]},Fp,Bp],endpoint:{url:"https://{Region}.signin.aws.amazon.com",properties:it,headers:it},type:Tn},{conditions:[{[at]:Ag,[ct]:[Ng,"aws-cn"]},Fp,Bp],endpoint:{url:"https://{Region}.signin.amazonaws.cn",properties:it,headers:it},type:Tn},{conditions:[{[at]:Ag,[ct]:[Ng,"aws-us-gov"]},Fp,Bp],endpoint:{url:"https://{Region}.signin.amazonaws-us-gov.com",properties:it,headers:it},type:Tn},{conditions:[Pg,Dg],rules:[{conditions:[{[at]:Cs,[ct]:[!0,ZN]},eO],rules:[{endpoint:{url:"https://signin-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:it,headers:it},type:Tn}],type:qr},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Oi}],type:qr},{conditions:[Pg,Bp],rules:[{conditions:[{[at]:Cs,[ct]:[ZN,!0]}],rules:[{endpoint:{url:"https://signin-fips.{Region}.{PartitionResult#dnsSuffix}",properties:it,headers:it},type:Tn}],type:qr},{error:"FIPS is enabled but this partition does not support FIPS",type:Oi}],type:qr},{conditions:[Fp,Dg],rules:[{conditions:[eO],rules:[{endpoint:{url:"https://signin.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:it,headers:it},type:Tn}],type:qr},{error:"DualStack is enabled but this partition does not support DualStack",type:Oi}],type:qr},{endpoint:{url:"https://signin.{Region}.{PartitionResult#dnsSuffix}",properties:it,headers:it},type:Tn}],type:qr}],type:qr},{error:"Invalid Configuration: Missing Region",type:Oi}],type:qr}]},oO=B8});var H8,sO,iO=d(()=>{an();Wr();nO();H8=new bt({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),sO=(e,t={})=>H8.get(e,()=>ar(oO,{endpointParams:e,logger:t.logger}));ze.aws=kt});var aO,cO=d(()=>{Ne();Ho();Fe();N();Bo();et();Ae();vg();iO();aO=e=>({apiVersion:"2023-01-01",base64Decoder:e?.base64Decoder??Ie,base64Encoder:e?.base64Encoder??Ee,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??sO,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??WN,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new qe},{schemeId:"smithy.api#noAuth",identityProvider:t=>t.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new or}],logger:e?.logger??new ot,protocol:e?.protocol??fn,protocolSettings:e?.protocolSettings??{defaultNamespace:"com.amazonaws.signin",version:"2023-01-01",serviceTarget:"Signin"},serviceId:e?.serviceId??"Signin",urlParser:e?.urlParser??Ve,utf8Decoder:e?.utf8Decoder??_e,utf8Encoder:e?.utf8Encoder??Se})});var dO,lO=d(()=>{lp();Ne();gs();ut();xs();Ut();wr();ko();N();ys();Ss();Go();cO();dO=e=>{mr(process.version);let t=Nr(e),r=()=>t().then(fr),o=aO(e);cr(process.version);let n={profile:e?.profile,logger:o.logger};return{...o,...e,runtime:"node",defaultsMode:t,authSchemePreference:e?.authSchemePreference??P(dr,n),bodyLengthChecker:e?.bodyLengthChecker??Dr,defaultUserAgentProvider:e?.defaultUserAgentProvider??Ar({serviceId:o.serviceId,clientVersion:Ei.version}),maxAttempts:e?.maxAttempts??P(Ir,e),region:e?.region??P(nt,{...Rt,...n}),requestHandler:tt.create(e?.requestHandler??r),retryMode:e?.retryMode??P({...vr,default:async()=>(await r()).retryMode||Tt},e),sha256:e?.sha256??Ct.bind(null,"sha256"),streamCollector:e?.streamCollector??xt,useDualstackEndpoint:e?.useDualstackEndpoint??P(Sr,n),useFipsEndpoint:e?.useFipsEndpoint??P(Er,n),userAgentAppId:e?.userAgentAppId??P(Pr,n)}}});var pO,uO,fO=d(()=>{pO=e=>{let t=e.httpAuthSchemes,r=e.httpAuthSchemeProvider,o=e.credentials;return{setHttpAuthScheme(n){let s=t.findIndex(i=>i.schemeId===n.schemeId);s===-1?t.push(n):t.splice(s,1,n)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(n){r=n},httpAuthSchemeProvider(){return r},setCredentials(n){o=n},credentials(){return o}}},uO=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()})});var mO,hO=d(()=>{_n();we();N();fO();mO=(e,t)=>{let r=Object.assign(Mr(e),hr(e),Kt(e),pO(e));return t.forEach(o=>o.configure(r)),Object.assign(e,Lr(r),gr(r),qt(r),uO(r))}});var oc,Og=d(()=>{Xn();Qn();Zn();hn();ut();Fe();ae();ls();Te();Ut();N();vg();Cg();lO();hO();oc=class extends Be{config;constructor(...[t]){let r=dO(t||{});super(r),this.initConfig=r;let o=KN(r),n=nr(o),s=Tr(n),i=_r(s),a=i,c=Rr(a),l=zN(c),p=mO(l,t?.extensions||[]);this.config=p,this.middlewareStack.use(tr(this.config)),this.middlewareStack.use(yr(this.config)),this.middlewareStack.use(Cr(this.config)),this.middlewareStack.use(br(this.config)),this.middlewareStack.use(Yt(this.config)),this.middlewareStack.use(Xt(this.config)),this.middlewareStack.use(Qt(this.config)),this.middlewareStack.use(Zt(this.config,{httpAuthSchemeParametersProvider:jN,identityProviderConfigProvider:async u=>new _t({"aws.auth#sigv4":u.credentials})})),this.middlewareStack.use(er(this.config))}destroy(){super.destroy()}}});var Jr,Vp=d(()=>{N();Jr=class e extends wt{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}}});var nc,sc,ic,ac,kg=d(()=>{Vp();nc=class e extends Jr{name="AccessDeniedException";$fault="client";error;constructor(t){super({name:"AccessDeniedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error}},sc=class e extends Jr{name="InternalServerException";$fault="server";error;constructor(t){super({name:"InternalServerException",$fault:"server",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error}},ic=class e extends Jr{name="TooManyRequestsError";$fault="client";error;constructor(t){super({name:"TooManyRequestsError",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error}},ac=class e extends Jr{name="ValidationException";$fault="client";error;constructor(t){super({name:"ValidationException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.error=t.error}}});var V8,G8,j8,W8,z8,K8,q8,J8,Y8,X8,Q8,gO,xO,$g,yO,SO,Z8,vn,EO,_O,eH,Mg,bO,Bt,jp,Gp,wO,tH,RO,IO,vO,rH,oH,TO,mt,CO,AO,PO,DO,NO,OO,kO,$O,MO,LO,UO,Lg,Ug=d(()=>{ae();kg();Vp();V8="AccessDeniedException",G8="AccessToken",j8="CreateOAuth2Token",W8="CreateOAuth2TokenRequest",z8="CreateOAuth2TokenRequestBody",K8="CreateOAuth2TokenResponseBody",q8="CreateOAuth2TokenResponse",J8="InternalServerException",Y8="RefreshToken",X8="TooManyRequestsError",Q8="ValidationException",gO="accessKeyId",xO="accessToken",$g="client",yO="clientId",SO="codeVerifier",Z8="code",vn="error",EO="expiresIn",_O="grantType",eH="http",Mg="httpError",bO="idToken",Bt="jsonName",jp="message",Gp="refreshToken",wO="redirectUri",tH="server",RO="secretAccessKey",IO="sessionToken",vO="smithy.ts.sdk.synthetic.com.amazonaws.signin",rH="tokenInput",oH="tokenOutput",TO="tokenType",mt="com.amazonaws.signin",CO=[0,mt,Y8,8,0],AO=[-3,mt,V8,{[vn]:$g},[vn,jp],[0,0]];S.for(mt).registerError(AO,nc);PO=[3,mt,G8,8,[gO,RO,IO],[[0,{[Bt]:gO}],[0,{[Bt]:RO}],[0,{[Bt]:IO}]]],DO=[3,mt,W8,0,[rH],[[()=>NO,16]]],NO=[3,mt,z8,0,[yO,_O,Z8,wO,SO,Gp],[[0,{[Bt]:yO}],[0,{[Bt]:_O}],0,[0,{[Bt]:wO}],[0,{[Bt]:SO}],[()=>CO,{[Bt]:Gp}]]],OO=[3,mt,q8,0,[oH],[[()=>kO,16]]],kO=[3,mt,K8,0,[xO,TO,EO,Gp,bO],[[()=>PO,{[Bt]:xO}],[0,{[Bt]:TO}],[1,{[Bt]:EO}],[()=>CO,{[Bt]:Gp}],[0,{[Bt]:bO}]]],$O=[-3,mt,J8,{[vn]:tH,[Mg]:500},[vn,jp],[0,0]];S.for(mt).registerError($O,sc);MO=[-3,mt,X8,{[vn]:$g,[Mg]:429},[vn,jp],[0,0]];S.for(mt).registerError(MO,ic);LO=[-3,mt,Q8,{[vn]:$g,[Mg]:400},[vn,jp],[0,0]];S.for(mt).registerError(LO,ac);UO=[-3,vO,"SigninServiceException",0,[],[]];S.for(vO).registerError(UO,Jr);Lg=[9,mt,j8,{[eH]:["POST","/v1/token",200]},()=>DO,()=>OO]});var cc,Fg=d(()=>{Te();N();Cg();Ug();cc=class extends V.classBuilder().ep(qN).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("Signin","CreateOAuth2Token",{}).n("SigninClient","CreateOAuth2TokenCommand").sc(Lg).build(){}});var nH,Wp,FO=d(()=>{N();Fg();Og();nH={CreateOAuth2TokenCommand:cc},Wp=class extends oc{};ln(nH,Wp)});var BO=d(()=>{Fg()});var sH,HO=d(()=>{sH={AUTHCODE_EXPIRED:"AUTHCODE_EXPIRED",INSUFFICIENT_PERMISSIONS:"INSUFFICIENT_PERMISSIONS",INVALID_REQUEST:"INVALID_REQUEST",SERVER_ERROR:"server_error",TOKEN_EXPIRED:"TOKEN_EXPIRED",USER_CREDENTIALS_CHANGED:"USER_CREDENTIALS_CHANGED"}});var VO=d(()=>{});var GO={};Nt(GO,{$Command:()=>V,AccessDeniedException:()=>nc,AccessDeniedException$:()=>AO,AccessToken$:()=>PO,CreateOAuth2Token$:()=>Lg,CreateOAuth2TokenCommand:()=>cc,CreateOAuth2TokenRequest$:()=>DO,CreateOAuth2TokenRequestBody$:()=>NO,CreateOAuth2TokenResponse$:()=>OO,CreateOAuth2TokenResponseBody$:()=>kO,InternalServerException:()=>sc,InternalServerException$:()=>$O,OAuth2ErrorCode:()=>sH,Signin:()=>Wp,SigninClient:()=>oc,SigninServiceException:()=>Jr,SigninServiceException$:()=>UO,TooManyRequestsError:()=>ic,TooManyRequestsError$:()=>MO,ValidationException:()=>ac,ValidationException$:()=>LO,__Client:()=>Be});var jO=d(()=>{Og();FO();BO();Ug();HO();kg();VO();Vp()});import{createHash as iH,createPrivateKey as aH,createPublicKey as cH,sign as dH}from"node:crypto";import{promises as Bg}from"node:fs";import{homedir as lH}from"node:os";import{dirname as pH,join as WO}from"node:path";var zp,zO=d(()=>{fe();we();ft();zp=class e{profileData;init;callerClientConfig;static REFRESH_THRESHOLD=5*60*1e3;constructor(t,r,o){this.profileData=t,this.init=r,this.callerClientConfig=o}async loadCredentials(){let t=await this.loadToken();if(!t)throw new v(`Failed to load a token for session ${this.loginSession}, please re-authenticate using aws login`,{tryNextLink:!1,logger:this.logger});let r=t.accessToken,o=Date.now();return new Date(r.expiresAt).getTime()-o<=e.REFRESH_THRESHOLD?this.refresh(t):{accessKeyId:r.accessKeyId,secretAccessKey:r.secretAccessKey,sessionToken:r.sessionToken,accountId:r.accountId,expiration:new Date(r.expiresAt)}}get logger(){return this.init?.logger}get loginSession(){return this.profileData.login_session}async refresh(t){let{SigninClient:r,CreateOAuth2TokenCommand:o}=await Promise.resolve().then(()=>(jO(),GO)),{logger:n,userAgentAppId:s}=this.callerClientConfig??{},a=(u=>u?.metadata?.handlerProtocol==="h2")(this.callerClientConfig?.requestHandler)?void 0:this.callerClientConfig?.requestHandler,c=this.profileData.region??await this.callerClientConfig?.region?.()??process.env.AWS_REGION,l=new r({credentials:{accessKeyId:"",secretAccessKey:""},region:c,requestHandler:a,logger:n,userAgentAppId:s,...this.init?.clientConfig});this.createDPoPInterceptor(l.middlewareStack);let p={tokenInput:{clientId:t.clientId,refreshToken:t.refreshToken,grantType:"refresh_token"}};try{let u=await l.send(new o(p)),{accessKeyId:f,secretAccessKey:m,sessionToken:h}=u.tokenOutput?.accessToken??{},{refreshToken:g,expiresIn:E}=u.tokenOutput??{};if(!f||!m||!h||!g)throw new v("Token refresh response missing required fields",{logger:this.logger,tryNextLink:!1});let w=(E??900)*1e3,C=new Date(Date.now()+w),ie={...t,accessToken:{...t.accessToken,accessKeyId:f,secretAccessKey:m,sessionToken:h,expiresAt:C.toISOString()},refreshToken:g};await this.saveToken(ie);let he=ie.accessToken;return{accessKeyId:he.accessKeyId,secretAccessKey:he.secretAccessKey,sessionToken:he.sessionToken,accountId:he.accountId,expiration:C}}catch(u){if(u.name==="AccessDeniedException"){let f=u.error,m;switch(f){case"TOKEN_EXPIRED":m="Your session has expired. Please reauthenticate.";break;case"USER_CREDENTIALS_CHANGED":m="Unable to refresh credentials because of a change in your password. Please reauthenticate with your new password.";break;case"INSUFFICIENT_PERMISSIONS":m="Unable to refresh credentials due to insufficient permissions. You may be missing permission for the 'CreateOAuth2Token' action.";break;default:m=`Failed to refresh token: ${String(u)}. Please re-authenticate using \`aws login\``}throw new v(m,{logger:this.logger,tryNextLink:!1})}throw new v(`Failed to refresh token: ${String(u)}. Please re-authenticate using aws login`,{logger:this.logger})}}async loadToken(){let t=this.getTokenFilePath();try{let r;try{r=await yn(t,{ignoreCache:this.init?.ignoreCache})}catch{r=await Bg.readFile(t,"utf8")}let o=JSON.parse(r),n=["accessToken","clientId","refreshToken","dpopKey"].filter(s=>!o[s]);if(o.accessToken?.accountId||n.push("accountId"),n.length>0)throw new v(`Token validation failed, missing fields: ${n.join(", ")}`,{logger:this.logger,tryNextLink:!1});return o}catch(r){throw new v(`Failed to load token from ${t}: ${String(r)}`,{logger:this.logger,tryNextLink:!1})}}async saveToken(t){let r=this.getTokenFilePath(),o=pH(r);try{await Bg.mkdir(o,{recursive:!0})}catch{}await Bg.writeFile(r,JSON.stringify(t,null,2),"utf8")}getTokenFilePath(){let t=process.env.AWS_LOGIN_CACHE_DIRECTORY??WO(lH(),".aws","login","cache"),r=Buffer.from(this.loginSession,"utf8"),o=iH("sha256").update(r).digest("hex");return WO(t,`${o}.json`)}derToRawSignature(t){let r=2;if(t[r]!==2)throw new Error("Invalid DER signature");r++;let o=t[r++],n=t.subarray(r,r+o);if(r+=o,t[r]!==2)throw new Error("Invalid DER signature");r++;let s=t[r++],i=t.subarray(r,r+s);n=n[0]===0?n.subarray(1):n,i=i[0]===0?i.subarray(1):i;let a=Buffer.concat([Buffer.alloc(32-n.length),n]),c=Buffer.concat([Buffer.alloc(32-i.length),i]);return Buffer.concat([a,c])}createDPoPInterceptor(t){t.add(r=>async o=>{if(le.isInstance(o.request)){let n=o.request,s=`${n.protocol}//${n.hostname}${n.port?`:${n.port}`:""}${n.path}`,i=await this.generateDpop(n.method,s);n.headers={...n.headers,DPoP:i}}return r(o)},{step:"finalizeRequest",name:"dpopInterceptor",override:!0})}async generateDpop(t="POST",r){let o=await this.loadToken();try{let n=aH({key:o.dpopKey,format:"pem",type:"sec1"}),i=cH(n).export({format:"der",type:"spki"}),a=-1;for(let C=0;C<i.length;C++)if(i[C]===4){a=C;break}let c=i.slice(a+1,a+33),l=i.slice(a+33,a+65),p={alg:"ES256",typ:"dpop+jwt",jwk:{kty:"EC",crv:"P-256",x:c.toString("base64url"),y:l.toString("base64url")}},u={jti:crypto.randomUUID(),htm:t,htu:r,iat:Math.floor(Date.now()/1e3)},f=Buffer.from(JSON.stringify(p)).toString("base64url"),m=Buffer.from(JSON.stringify(u)).toString("base64url"),h=`${f}.${m}`,g=dH("sha256",Buffer.from(h),n),w=this.derToRawSignature(g).toString("base64url");return`${h}.${w}`}catch(n){throw new v(`Failed to generate Dpop proof: ${n instanceof Error?n.message:String(n)}`,{logger:this.logger,tryNextLink:!1})}}}});var KO,qO=d(()=>{Ke();fe();ft();zO();KO=e=>async({callerClientConfig:t}={})=>{e?.logger?.debug?.("@aws-sdk/credential-providers - fromLoginCredentials");let r=await po(e||{}),o=It({profile:e?.profile??t?.profile}),n=r[o];if(!n?.login_session)throw new v(`Profile ${o} does not contain login_session.`,{tryNextLink:!0,logger:e?.logger});let i=await new zp(n,e,t).loadCredentials();return q(i,"CREDENTIALS_LOGIN","AD")}});var JO=d(()=>{});var YO=d(()=>{qO();JO()});var XO,QO,ZO=d(()=>{Ke();YO();XO=e=>!!(e&&e.login_session),QO=async(e,t,r)=>{let o=await KO({...t,profile:e})({callerClientConfig:r});return q(o,"CREDENTIALS_PROFILE_LOGIN","AC")}});var ek,tk=d(()=>{Ke();ek=(e,t,r)=>{if(t.Version!==1)throw Error(`Profile ${e} credential_process did not return Version 1.`);if(t.AccessKeyId===void 0||t.SecretAccessKey===void 0)throw Error(`Profile ${e} credential_process returned invalid credentials.`);if(t.Expiration){let s=new Date;if(new Date(t.Expiration)<s)throw Error(`Profile ${e} credential_process returned expired credentials.`)}let o=t.AccountId;!o&&r?.[e]?.aws_account_id&&(o=r[e].aws_account_id);let n={accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretAccessKey,...t.SessionToken&&{sessionToken:t.SessionToken},...t.Expiration&&{expiration:new Date(t.Expiration)},...t.CredentialScope&&{credentialScope:t.CredentialScope},...o&&{accountId:o}};return q(n,"CREDENTIALS_PROCESS","w"),n}});import{exec as uH}from"child_process";import{promisify as fH}from"util";var rk,ok=d(()=>{fe();ft();tk();rk=async(e,t,r)=>{let o=t[e];if(t[e]){let n=o.credential_process;if(n!==void 0){let s=fH(ba?.getTokenRecord?.().exec??uH);try{let{stdout:i}=await s(n),a;try{a=JSON.parse(i.trim())}catch{throw Error(`Profile ${e} credential_process returned invalid JSON.`)}return ek(e,a,t)}catch(i){throw new v(i.message,{logger:r})}}else throw new v(`Profile ${e} did not contain credential_process.`,{logger:r})}else throw new v(`Profile ${e} could not be found in shared credentials file.`,{logger:r})}});var mH,nk=d(()=>{ft();ok();mH=(e={})=>async({callerClientConfig:t}={})=>{e.logger?.debug("@aws-sdk/credential-provider-process - fromProcess");let r=await po(e);return rk(It({profile:e.profile??t?.profile}),r,e.logger)}});var Hg={};Nt(Hg,{fromProcess:()=>mH});var Vg=d(()=>{nk()});var sk,ik,ak=d(()=>{Ke();sk=e=>!!e&&typeof e=="object"&&typeof e.credential_process=="string",ik=async(e,t)=>Promise.resolve().then(()=>(Vg(),Hg)).then(({fromProcess:r})=>r({...e,profile:t})().then(o=>q(o,"CREDENTIALS_PROFILE_PROCESS","v")))});var ck,dk,lk=d(()=>{Ke();ck=async(e,t,r={},o)=>{let{fromSSO:n}=await Promise.resolve().then(()=>(ug(),pg));return n({profile:e,logger:r.logger,parentClientConfig:r.parentClientConfig,clientConfig:r.clientConfig})({callerClientConfig:o}).then(s=>t.sso_session?q(s,"CREDENTIALS_PROFILE_SSO","r"):q(s,"CREDENTIALS_PROFILE_SSO_LEGACY","t"))},dk=e=>e&&(typeof e.sso_start_url=="string"||typeof e.sso_account_id=="string"||typeof e.sso_session=="string"||typeof e.sso_region=="string"||typeof e.sso_role_name=="string")});var Gg,jg,pk=d(()=>{Ke();Gg=e=>!!e&&typeof e=="object"&&typeof e.aws_access_key_id=="string"&&typeof e.aws_secret_access_key=="string"&&["undefined","string"].indexOf(typeof e.aws_session_token)>-1&&["undefined","string"].indexOf(typeof e.aws_account_id)>-1,jg=async(e,t)=>{t?.logger?.debug("@aws-sdk/credential-provider-ini - resolveStaticCredentials");let r={accessKeyId:e.aws_access_key_id,secretAccessKey:e.aws_secret_access_key,sessionToken:e.aws_session_token,...e.aws_credential_scope&&{credentialScope:e.aws_credential_scope},...e.aws_account_id&&{accountId:e.aws_account_id}};return q(r,"CREDENTIALS_PROFILE","n")}});var Wg,zg=d(()=>{Wg=e=>async t=>{e.logger?.debug("@aws-sdk/credential-provider-web-identity - fromWebToken");let{roleArn:r,roleSessionName:o,webIdentityToken:n,providerId:s,policyArns:i,policy:a,durationSeconds:c}=e,{roleAssumerWithWebIdentity:l}=e;if(!l){let{getDefaultRoleAssumerWithWebIdentity:p}=await Promise.resolve().then(()=>(Tg(),Ig));l=p({...e.clientConfig,credentialProviderLogger:e.logger,parentClientConfig:{...t?.callerClientConfig,...e.parentClientConfig}},e.clientPlugins)}return l({RoleArn:r,RoleSessionName:o??`aws-sdk-js-session-${Date.now()}`,WebIdentityToken:n,ProviderId:s,PolicyArns:i,Policy:a,DurationSeconds:c})}});import{readFileSync as hH}from"fs";var uk,gH,xH,yH,fk=d(()=>{Ke();fe();ft();zg();uk="AWS_WEB_IDENTITY_TOKEN_FILE",gH="AWS_ROLE_ARN",xH="AWS_ROLE_SESSION_NAME",yH=(e={})=>async t=>{e.logger?.debug("@aws-sdk/credential-provider-web-identity - fromTokenFile");let r=e?.webIdentityTokenFile??process.env[uk],o=e?.roleArn??process.env[gH],n=e?.roleSessionName??process.env[xH];if(!r||!o)throw new v("Web identity configuration not specified",{logger:e.logger});let s=await Wg({...e,webIdentityToken:ba?.getTokenRecord?.()[r]??hH(r,{encoding:"ascii"}),roleArn:o,roleSessionName:n})(t);return r===process.env[uk]&&q(s,"CREDENTIALS_ENV_VARS_STS_WEB_ID_TOKEN","h"),s}});var Kg={};Nt(Kg,{fromTokenFile:()=>yH,fromWebToken:()=>Wg});var qg=d(()=>{fk();zg()});var mk,hk,gk=d(()=>{Ke();mk=e=>!!e&&typeof e=="object"&&typeof e.web_identity_token_file=="string"&&typeof e.role_arn=="string"&&["undefined","string"].indexOf(typeof e.role_session_name)>-1,hk=async(e,t,r)=>Promise.resolve().then(()=>(qg(),Kg)).then(({fromTokenFile:o})=>o({webIdentityTokenFile:e.web_identity_token_file,roleArn:e.role_arn,roleSessionName:e.role_session_name,roleAssumerWithWebIdentity:t.roleAssumerWithWebIdentity,logger:t.logger,parentClientConfig:t.parentClientConfig})({callerClientConfig:r}).then(n=>q(n,"CREDENTIALS_PROFILE_STS_WEB_ID_TOKEN","q")))});var Jg,xk=d(()=>{fe();GN();ZO();ak();lk();pk();gk();Jg=async(e,t,r,o,n={},s=!1)=>{let i=t[e];if(Object.keys(n).length>0&&Gg(i))return jg(i,r);if(s||HN(i,{profile:e,logger:r.logger}))return VN(e,t,r,o,n,Jg);if(Gg(i))return jg(i,r);if(mk(i))return hk(i,r,o);if(sk(i))return ik(r,e);if(dk(i))return await ck(e,i,r,o);if(XO(i))return QO(e,r,o);throw new v(`Could not resolve credentials using profile: [${e}] in configuration/credentials file(s).`,{logger:r.logger})}});var SH,yk=d(()=>{ft();xk();SH=(e={})=>async({callerClientConfig:t}={})=>{e.logger?.debug("@aws-sdk/credential-provider-ini - fromIni");let r=await po(e);return Jg(It({profile:e.profile??t?.profile}),r,e,t)}});var Sk={};Nt(Sk,{fromIni:()=>SH});var Ek=d(()=>{yk()});import{randomUUID as g$}from"crypto";function x$(e){if(!e.body)return{};try{return JSON.parse(e.body)}catch{return e.body}}function y$(e){let t={},r=e.queryStringParameters;if(r)for(let[o,n]of Object.entries(r))n!==void 0&&(t[o]=n);return t}function S$(e){let t={};if(e.headers)for(let[r,o]of Object.entries(e.headers))t[r.toLowerCase()]=o||"";return t}function Dx(e,t){let r={},o=t.split("/"),n=e.split("/");if(o.length!==n.length)return r;for(let s=0;s<o.length;s++){let i=o[s],a=n[s];if(i?.startsWith(":")){let c=i.slice(1);a&&(r[c]=decodeURIComponent(a))}}return r}function Nx(e,t,r={}){let o=(e.httpMethod||e.requestContext?.http?.method)?.toUpperCase()||"GET",n=e.path||e.rawPath||"/",s=e.headers?.["x-correlation-id"]||e.requestContext?.requestId||g$(),i={authenticated:!1};return{method:o,path:n,headers:S$(e),body:x$(e),query:y$(e),params:r,context:i,correlationId:s,rawEvent:e,lambdaContext:t}}var _={};Nt(_,{BRAND:()=>W$,DIRTY:()=>On,EMPTY_PATH:()=>w$,INVALID:()=>$,NEVER:()=>A3,OK:()=>Qe,ParseStatus:()=>We,Schema:()=>H,ZodAny:()=>en,ZodArray:()=>To,ZodBigInt:()=>$n,ZodBoolean:()=>Mn,ZodBranded:()=>Hi,ZodCatch:()=>Kn,ZodDate:()=>Ln,ZodDefault:()=>zn,ZodDiscriminatedUnion:()=>Tc,ZodEffects:()=>jt,ZodEnum:()=>jn,ZodError:()=>ht,ZodFirstPartyTypeKind:()=>L,ZodFunction:()=>Cc,ZodIntersection:()=>Hn,ZodIssueCode:()=>b,ZodLazy:()=>Vn,ZodLiteral:()=>Gn,ZodMap:()=>Ms,ZodNaN:()=>Us,ZodNativeEnum:()=>Wn,ZodNever:()=>Hr,ZodNull:()=>Fn,ZodNullable:()=>eo,ZodNumber:()=>kn,ZodObject:()=>gt,ZodOptional:()=>Vt,ZodParsedType:()=>T,ZodPipeline:()=>Vi,ZodPromise:()=>tn,ZodReadonly:()=>qn,ZodRecord:()=>vc,ZodSchema:()=>H,ZodSet:()=>Ls,ZodString:()=>Zo,ZodSymbol:()=>ks,ZodTransformer:()=>jt,ZodTuple:()=>Zr,ZodType:()=>H,ZodUndefined:()=>Un,ZodUnion:()=>Bn,ZodUnknown:()=>Io,ZodVoid:()=>$s,addIssueToContext:()=>I,any:()=>e3,array:()=>n3,bigint:()=>J$,boolean:()=>Gx,coerce:()=>C3,custom:()=>Bx,date:()=>Y$,datetimeRegex:()=>Ux,defaultErrorMap:()=>wo,discriminatedUnion:()=>c3,effect:()=>E3,enum:()=>x3,function:()=>m3,getErrorMap:()=>Ds,getParsedType:()=>Qr,instanceof:()=>K$,intersection:()=>d3,isAborted:()=>Rc,isAsync:()=>Ns,isDirty:()=>Ic,isValid:()=>Qo,late:()=>z$,lazy:()=>h3,literal:()=>g3,makeIssue:()=>Bi,map:()=>u3,nan:()=>q$,nativeEnum:()=>y3,never:()=>r3,null:()=>Z$,nullable:()=>b3,number:()=>Vx,object:()=>s3,objectUtil:()=>Ku,oboolean:()=>v3,onumber:()=>T3,optional:()=>_3,ostring:()=>I3,pipeline:()=>R3,preprocess:()=>w3,promise:()=>S3,quotelessJson:()=>E$,record:()=>p3,set:()=>f3,setErrorMap:()=>b$,strictObject:()=>i3,string:()=>Hx,symbol:()=>X$,transformer:()=>E3,tuple:()=>l3,undefined:()=>Q$,union:()=>a3,unknown:()=>t3,util:()=>z,void:()=>o3});var z;(function(e){e.assertEqual=n=>{};function t(n){}e.assertIs=t;function r(n){throw new Error}e.assertNever=r,e.arrayToEnum=n=>{let s={};for(let i of n)s[i]=i;return s},e.getValidEnumValues=n=>{let s=e.objectKeys(n).filter(a=>typeof n[n[a]]!="number"),i={};for(let a of s)i[a]=n[a];return e.objectValues(i)},e.objectValues=n=>e.objectKeys(n).map(function(s){return n[s]}),e.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let s=[];for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&s.push(i);return s},e.find=(n,s)=>{for(let i of n)if(s(i))return i},e.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function o(n,s=" | "){return n.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}e.joinValues=o,e.jsonStringifyReplacer=(n,s)=>typeof s=="bigint"?s.toString():s})(z||(z={}));var Ku;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(Ku||(Ku={}));var T=z.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Qr=e=>{switch(typeof e){case"undefined":return T.undefined;case"string":return T.string;case"number":return Number.isNaN(e)?T.nan:T.number;case"boolean":return T.boolean;case"function":return T.function;case"bigint":return T.bigint;case"symbol":return T.symbol;case"object":return Array.isArray(e)?T.array:e===null?T.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?T.promise:typeof Map<"u"&&e instanceof Map?T.map:typeof Set<"u"&&e instanceof Set?T.set:typeof Date<"u"&&e instanceof Date?T.date:T.object;default:return T.unknown}};var b=z.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),E$=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ht=class e extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=o=>{this.issues=[...this.issues,o]},this.addIssues=(o=[])=>{this.issues=[...this.issues,...o]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){let r=t||function(s){return s.message},o={_errors:[]},n=s=>{for(let i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(n);else if(i.code==="invalid_return_type")n(i.returnTypeError);else if(i.code==="invalid_arguments")n(i.argumentsError);else if(i.path.length===0)o._errors.push(r(i));else{let a=o,c=0;for(;c<i.path.length;){let l=i.path[c];c===i.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(r(i))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return n(this),o}static assert(t){if(!(t instanceof e))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,z.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){let r={},o=[];for(let n of this.issues)if(n.path.length>0){let s=n.path[0];r[s]=r[s]||[],r[s].push(t(n))}else o.push(t(n));return{formErrors:o,fieldErrors:r}}get formErrors(){return this.flatten()}};ht.create=e=>new ht(e);var _$=(e,t)=>{let r;switch(e.code){case b.invalid_type:e.received===T.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case b.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,z.jsonStringifyReplacer)}`;break;case b.unrecognized_keys:r=`Unrecognized key(s) in object: ${z.joinValues(e.keys,", ")}`;break;case b.invalid_union:r="Invalid input";break;case b.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${z.joinValues(e.options)}`;break;case b.invalid_enum_value:r=`Invalid enum value. Expected ${z.joinValues(e.options)}, received '${e.received}'`;break;case b.invalid_arguments:r="Invalid function arguments";break;case b.invalid_return_type:r="Invalid function return type";break;case b.invalid_date:r="Invalid date";break;case b.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:z.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case b.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case b.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case b.custom:r="Invalid input";break;case b.invalid_intersection_types:r="Intersection results could not be merged";break;case b.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case b.not_finite:r="Number must be finite";break;default:r=t.defaultError,z.assertNever(e)}return{message:r}},wo=_$;var Ox=wo;function b$(e){Ox=e}function Ds(){return Ox}var Bi=e=>{let{data:t,path:r,errorMaps:o,issueData:n}=e,s=[...r,...n.path||[]],i={...n,path:s};if(n.message!==void 0)return{...n,path:s,message:n.message};let a="",c=o.filter(l=>!!l).slice().reverse();for(let l of c)a=l(i,{data:t,defaultError:a}).message;return{...n,path:s,message:a}},w$=[];function I(e,t){let r=Ds(),o=Bi({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===wo?void 0:wo].filter(n=>!!n)});e.common.issues.push(o)}var We=class e{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){let o=[];for(let n of r){if(n.status==="aborted")return $;n.status==="dirty"&&t.dirty(),o.push(n.value)}return{status:t.value,value:o}}static async mergeObjectAsync(t,r){let o=[];for(let n of r){let s=await n.key,i=await n.value;o.push({key:s,value:i})}return e.mergeObjectSync(t,o)}static mergeObjectSync(t,r){let o={};for(let n of r){let{key:s,value:i}=n;if(s.status==="aborted"||i.status==="aborted")return $;s.status==="dirty"&&t.dirty(),i.status==="dirty"&&t.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||n.alwaysSet)&&(o[s.value]=i.value)}return{status:t.value,value:o}}},$=Object.freeze({status:"aborted"}),On=e=>({status:"dirty",value:e}),Qe=e=>({status:"valid",value:e}),Rc=e=>e.status==="aborted",Ic=e=>e.status==="dirty",Qo=e=>e.status==="valid",Ns=e=>typeof Promise<"u"&&e instanceof Promise;var D;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(D||(D={}));var Gt=class{constructor(t,r,o,n){this._cachedPath=[],this.parent=t,this.data=r,this._path=o,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},kx=(e,t)=>{if(Qo(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new ht(e.common.issues);return this._error=r,this._error}}};function F(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:o,description:n}=e;if(t&&(r||o))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(i,a)=>{let{message:c}=e;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??o??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:n}}var H=class{get description(){return this._def.description}_getType(t){return Qr(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Qr(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new We,ctx:{common:t.parent.common,data:t.data,parsedType:Qr(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){let r=this._parse(t);if(Ns(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){let r=this._parse(t);return Promise.resolve(r)}parse(t,r){let o=this.safeParse(t,r);if(o.success)return o.data;throw o.error}safeParse(t,r){let o={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qr(t)},n=this._parseSync({data:t,path:o.path,parent:o});return kx(o,n)}"~validate"(t){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qr(t)};if(!this["~standard"].async)try{let o=this._parseSync({data:t,path:[],parent:r});return Qo(o)?{value:o.value}:{issues:r.common.issues}}catch(o){o?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(o=>Qo(o)?{value:o.value}:{issues:r.common.issues})}async parseAsync(t,r){let o=await this.safeParseAsync(t,r);if(o.success)return o.data;throw o.error}async safeParseAsync(t,r){let o={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qr(t)},n=this._parse({data:t,path:o.path,parent:o}),s=await(Ns(n)?n:Promise.resolve(n));return kx(o,s)}refine(t,r){let o=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,s)=>{let i=t(n),a=()=>s.addIssue({code:b.custom,...o(n)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(t,r){return this._refinement((o,n)=>t(o)?!0:(n.addIssue(typeof r=="function"?r(o,n):r),!1))}_refinement(t){return new jt({schema:this,typeName:L.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Vt.create(this,this._def)}nullable(){return eo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return To.create(this)}promise(){return tn.create(this,this._def)}or(t){return Bn.create([this,t],this._def)}and(t){return Hn.create(this,t,this._def)}transform(t){return new jt({...F(this._def),schema:this,typeName:L.ZodEffects,effect:{type:"transform",transform:t}})}default(t){let r=typeof t=="function"?t:()=>t;return new zn({...F(this._def),innerType:this,defaultValue:r,typeName:L.ZodDefault})}brand(){return new Hi({typeName:L.ZodBranded,type:this,...F(this._def)})}catch(t){let r=typeof t=="function"?t:()=>t;return new Kn({...F(this._def),innerType:this,catchValue:r,typeName:L.ZodCatch})}describe(t){let r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Vi.create(this,t)}readonly(){return qn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},R$=/^c[^\s-]{8,}$/i,I$=/^[0-9a-z]+$/,T$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,v$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,C$=/^[a-z0-9_-]{21}$/i,A$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,P$=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,D$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,N$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",qu,O$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,k$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,$$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,M$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,L$=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,U$=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Mx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",F$=new RegExp(`^${Mx}$`);function Lx(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function B$(e){return new RegExp(`^${Lx(e)}$`)}function Ux(e){let t=`${Mx}T${Lx(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function H$(e,t){return!!((t==="v4"||!t)&&O$.test(e)||(t==="v6"||!t)&&$$.test(e))}function V$(e,t){if(!A$.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let o=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(o));return!(typeof n!="object"||n===null||"typ"in n&&n?.typ!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function G$(e,t){return!!((t==="v4"||!t)&&k$.test(e)||(t==="v6"||!t)&&M$.test(e))}var Zo=class e extends H{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==T.string){let s=this._getOrReturnCtx(t);return I(s,{code:b.invalid_type,expected:T.string,received:s.parsedType}),$}let o=new We,n;for(let s of this._def.checks)if(s.kind==="min")t.data.length<s.value&&(n=this._getOrReturnCtx(t,n),I(n,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),o.dirty());else if(s.kind==="max")t.data.length>s.value&&(n=this._getOrReturnCtx(t,n),I(n,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),o.dirty());else if(s.kind==="length"){let i=t.data.length>s.value,a=t.data.length<s.value;(i||a)&&(n=this._getOrReturnCtx(t,n),i?I(n,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&I(n,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),o.dirty())}else if(s.kind==="email")D$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"email",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="emoji")qu||(qu=new RegExp(N$,"u")),qu.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"emoji",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="uuid")v$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"uuid",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="nanoid")C$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"nanoid",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="cuid")R$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"cuid",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="cuid2")I$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"cuid2",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="ulid")T$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"ulid",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),I(n,{validation:"url",code:b.invalid_string,message:s.message}),o.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"regex",code:b.invalid_string,message:s.message}),o.dirty())):s.kind==="trim"?t.data=t.data.trim():s.kind==="includes"?t.data.includes(s.value,s.position)||(n=this._getOrReturnCtx(t,n),I(n,{code:b.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),o.dirty()):s.kind==="toLowerCase"?t.data=t.data.toLowerCase():s.kind==="toUpperCase"?t.data=t.data.toUpperCase():s.kind==="startsWith"?t.data.startsWith(s.value)||(n=this._getOrReturnCtx(t,n),I(n,{code:b.invalid_string,validation:{startsWith:s.value},message:s.message}),o.dirty()):s.kind==="endsWith"?t.data.endsWith(s.value)||(n=this._getOrReturnCtx(t,n),I(n,{code:b.invalid_string,validation:{endsWith:s.value},message:s.message}),o.dirty()):s.kind==="datetime"?Ux(s).test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{code:b.invalid_string,validation:"datetime",message:s.message}),o.dirty()):s.kind==="date"?F$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{code:b.invalid_string,validation:"date",message:s.message}),o.dirty()):s.kind==="time"?B$(s).test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{code:b.invalid_string,validation:"time",message:s.message}),o.dirty()):s.kind==="duration"?P$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"duration",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="ip"?H$(t.data,s.version)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"ip",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="jwt"?V$(t.data,s.alg)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"jwt",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="cidr"?G$(t.data,s.version)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"cidr",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="base64"?L$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"base64",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="base64url"?U$.test(t.data)||(n=this._getOrReturnCtx(t,n),I(n,{validation:"base64url",code:b.invalid_string,message:s.message}),o.dirty()):z.assertNever(s);return{status:o.value,value:t.data}}_regex(t,r,o){return this.refinement(n=>t.test(n),{validation:r,code:b.invalid_string,...D.errToObj(o)})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...D.errToObj(t)})}url(t){return this._addCheck({kind:"url",...D.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...D.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...D.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...D.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...D.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...D.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...D.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...D.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...D.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...D.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...D.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...D.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...D.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...D.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...D.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...D.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r?.position,...D.errToObj(r?.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...D.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...D.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...D.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...D.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...D.errToObj(r)})}nonempty(t){return this.min(1,D.errToObj(t))}trim(){return new e({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};Zo.create=e=>new Zo({checks:[],typeName:L.ZodString,coerce:e?.coerce??!1,...F(e)});function j$(e,t){let r=(e.toString().split(".")[1]||"").length,o=(t.toString().split(".")[1]||"").length,n=r>o?r:o,s=Number.parseInt(e.toFixed(n).replace(".","")),i=Number.parseInt(t.toFixed(n).replace(".",""));return s%i/10**n}var kn=class e extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==T.number){let s=this._getOrReturnCtx(t);return I(s,{code:b.invalid_type,expected:T.number,received:s.parsedType}),$}let o,n=new We;for(let s of this._def.checks)s.kind==="int"?z.isInteger(t.data)||(o=this._getOrReturnCtx(t,o),I(o,{code:b.invalid_type,expected:"integer",received:"float",message:s.message}),n.dirty()):s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(o=this._getOrReturnCtx(t,o),I(o,{code:b.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),n.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(o=this._getOrReturnCtx(t,o),I(o,{code:b.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),n.dirty()):s.kind==="multipleOf"?j$(t.data,s.value)!==0&&(o=this._getOrReturnCtx(t,o),I(o,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),n.dirty()):s.kind==="finite"?Number.isFinite(t.data)||(o=this._getOrReturnCtx(t,o),I(o,{code:b.not_finite,message:s.message}),n.dirty()):z.assertNever(s);return{status:n.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,D.toString(r))}gt(t,r){return this.setLimit("min",t,!1,D.toString(r))}lte(t,r){return this.setLimit("max",t,!0,D.toString(r))}lt(t,r){return this.setLimit("max",t,!1,D.toString(r))}setLimit(t,r,o,n){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:o,message:D.toString(n)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:D.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:D.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:D.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:D.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:D.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:D.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:D.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:D.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:D.toString(t)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&z.isInteger(t.value))}get isFinite(){let t=null,r=null;for(let o of this._def.checks){if(o.kind==="finite"||o.kind==="int"||o.kind==="multipleOf")return!0;o.kind==="min"?(r===null||o.value>r)&&(r=o.value):o.kind==="max"&&(t===null||o.value<t)&&(t=o.value)}return Number.isFinite(r)&&Number.isFinite(t)}};kn.create=e=>new kn({checks:[],typeName:L.ZodNumber,coerce:e?.coerce||!1,...F(e)});var $n=class e extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==T.bigint)return this._getInvalidInput(t);let o,n=new We;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(o=this._getOrReturnCtx(t,o),I(o,{code:b.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),n.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(o=this._getOrReturnCtx(t,o),I(o,{code:b.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),n.dirty()):s.kind==="multipleOf"?t.data%s.value!==BigInt(0)&&(o=this._getOrReturnCtx(t,o),I(o,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),n.dirty()):z.assertNever(s);return{status:n.value,value:t.data}}_getInvalidInput(t){let r=this._getOrReturnCtx(t);return I(r,{code:b.invalid_type,expected:T.bigint,received:r.parsedType}),$}gte(t,r){return this.setLimit("min",t,!0,D.toString(r))}gt(t,r){return this.setLimit("min",t,!1,D.toString(r))}lte(t,r){return this.setLimit("max",t,!0,D.toString(r))}lt(t,r){return this.setLimit("max",t,!1,D.toString(r))}setLimit(t,r,o,n){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:o,message:D.toString(n)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:D.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:D.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:D.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:D.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:D.toString(r)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};$n.create=e=>new $n({checks:[],typeName:L.ZodBigInt,coerce:e?.coerce??!1,...F(e)});var Mn=class extends H{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==T.boolean){let o=this._getOrReturnCtx(t);return I(o,{code:b.invalid_type,expected:T.boolean,received:o.parsedType}),$}return Qe(t.data)}};Mn.create=e=>new Mn({typeName:L.ZodBoolean,coerce:e?.coerce||!1,...F(e)});var Ln=class e extends H{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==T.date){let s=this._getOrReturnCtx(t);return I(s,{code:b.invalid_type,expected:T.date,received:s.parsedType}),$}if(Number.isNaN(t.data.getTime())){let s=this._getOrReturnCtx(t);return I(s,{code:b.invalid_date}),$}let o=new We,n;for(let s of this._def.checks)s.kind==="min"?t.data.getTime()<s.value&&(n=this._getOrReturnCtx(t,n),I(n,{code:b.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),o.dirty()):s.kind==="max"?t.data.getTime()>s.value&&(n=this._getOrReturnCtx(t,n),I(n,{code:b.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),o.dirty()):z.assertNever(s);return{status:o.value,value:new Date(t.data.getTime())}}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:D.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:D.toString(r)})}get minDate(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}};Ln.create=e=>new Ln({checks:[],coerce:e?.coerce||!1,typeName:L.ZodDate,...F(e)});var ks=class extends H{_parse(t){if(this._getType(t)!==T.symbol){let o=this._getOrReturnCtx(t);return I(o,{code:b.invalid_type,expected:T.symbol,received:o.parsedType}),$}return Qe(t.data)}};ks.create=e=>new ks({typeName:L.ZodSymbol,...F(e)});var Un=class extends H{_parse(t){if(this._getType(t)!==T.undefined){let o=this._getOrReturnCtx(t);return I(o,{code:b.invalid_type,expected:T.undefined,received:o.parsedType}),$}return Qe(t.data)}};Un.create=e=>new Un({typeName:L.ZodUndefined,...F(e)});var Fn=class extends H{_parse(t){if(this._getType(t)!==T.null){let o=this._getOrReturnCtx(t);return I(o,{code:b.invalid_type,expected:T.null,received:o.parsedType}),$}return Qe(t.data)}};Fn.create=e=>new Fn({typeName:L.ZodNull,...F(e)});var en=class extends H{constructor(){super(...arguments),this._any=!0}_parse(t){return Qe(t.data)}};en.create=e=>new en({typeName:L.ZodAny,...F(e)});var Io=class extends H{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Qe(t.data)}};Io.create=e=>new Io({typeName:L.ZodUnknown,...F(e)});var Hr=class extends H{_parse(t){let r=this._getOrReturnCtx(t);return I(r,{code:b.invalid_type,expected:T.never,received:r.parsedType}),$}};Hr.create=e=>new Hr({typeName:L.ZodNever,...F(e)});var $s=class extends H{_parse(t){if(this._getType(t)!==T.undefined){let o=this._getOrReturnCtx(t);return I(o,{code:b.invalid_type,expected:T.void,received:o.parsedType}),$}return Qe(t.data)}};$s.create=e=>new $s({typeName:L.ZodVoid,...F(e)});var To=class e extends H{_parse(t){let{ctx:r,status:o}=this._processInputParams(t),n=this._def;if(r.parsedType!==T.array)return I(r,{code:b.invalid_type,expected:T.array,received:r.parsedType}),$;if(n.exactLength!==null){let i=r.data.length>n.exactLength.value,a=r.data.length<n.exactLength.value;(i||a)&&(I(r,{code:i?b.too_big:b.too_small,minimum:a?n.exactLength.value:void 0,maximum:i?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),o.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(I(r,{code:b.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),o.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(I(r,{code:b.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),o.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>n.type._parseAsync(new Gt(r,i,r.path,a)))).then(i=>We.mergeArray(o,i));let s=[...r.data].map((i,a)=>n.type._parseSync(new Gt(r,i,r.path,a)));return We.mergeArray(o,s)}get element(){return this._def.type}min(t,r){return new e({...this._def,minLength:{value:t,message:D.toString(r)}})}max(t,r){return new e({...this._def,maxLength:{value:t,message:D.toString(r)}})}length(t,r){return new e({...this._def,exactLength:{value:t,message:D.toString(r)}})}nonempty(t){return this.min(1,t)}};To.create=(e,t)=>new To({type:e,minLength:null,maxLength:null,exactLength:null,typeName:L.ZodArray,...F(t)});function Os(e){if(e instanceof gt){let t={};for(let r in e.shape){let o=e.shape[r];t[r]=Vt.create(Os(o))}return new gt({...e._def,shape:()=>t})}else return e instanceof To?new To({...e._def,type:Os(e.element)}):e instanceof Vt?Vt.create(Os(e.unwrap())):e instanceof eo?eo.create(Os(e.unwrap())):e instanceof Zr?Zr.create(e.items.map(t=>Os(t))):e}var gt=class e extends H{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let t=this._def.shape(),r=z.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==T.object){let l=this._getOrReturnCtx(t);return I(l,{code:b.invalid_type,expected:T.object,received:l.parsedType}),$}let{status:o,ctx:n}=this._processInputParams(t),{shape:s,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof Hr&&this._def.unknownKeys==="strip"))for(let l in n.data)i.includes(l)||a.push(l);let c=[];for(let l of i){let p=s[l],u=n.data[l];c.push({key:{status:"valid",value:l},value:p._parse(new Gt(n,u,n.path,l)),alwaysSet:l in n.data})}if(this._def.catchall instanceof Hr){let l=this._def.unknownKeys;if(l==="passthrough")for(let p of a)c.push({key:{status:"valid",value:p},value:{status:"valid",value:n.data[p]}});else if(l==="strict")a.length>0&&(I(n,{code:b.unrecognized_keys,keys:a}),o.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let l=this._def.catchall;for(let p of a){let u=n.data[p];c.push({key:{status:"valid",value:p},value:l._parse(new Gt(n,u,n.path,p)),alwaysSet:p in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let l=[];for(let p of c){let u=await p.key,f=await p.value;l.push({key:u,value:f,alwaysSet:p.alwaysSet})}return l}).then(l=>We.mergeObjectSync(o,l)):We.mergeObjectSync(o,c)}get shape(){return this._def.shape()}strict(t){return D.errToObj,new e({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,o)=>{let n=this._def.errorMap?.(r,o).message??o.defaultError;return r.code==="unrecognized_keys"?{message:D.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new e({...this._def,unknownKeys:"strip"})}passthrough(){return new e({...this._def,unknownKeys:"passthrough"})}extend(t){return new e({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:L.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new e({...this._def,catchall:t})}pick(t){let r={};for(let o of z.objectKeys(t))t[o]&&this.shape[o]&&(r[o]=this.shape[o]);return new e({...this._def,shape:()=>r})}omit(t){let r={};for(let o of z.objectKeys(this.shape))t[o]||(r[o]=this.shape[o]);return new e({...this._def,shape:()=>r})}deepPartial(){return Os(this)}partial(t){let r={};for(let o of z.objectKeys(this.shape)){let n=this.shape[o];t&&!t[o]?r[o]=n:r[o]=n.optional()}return new e({...this._def,shape:()=>r})}required(t){let r={};for(let o of z.objectKeys(this.shape))if(t&&!t[o])r[o]=this.shape[o];else{let s=this.shape[o];for(;s instanceof Vt;)s=s._def.innerType;r[o]=s}return new e({...this._def,shape:()=>r})}keyof(){return Fx(z.objectKeys(this.shape))}};gt.create=(e,t)=>new gt({shape:()=>e,unknownKeys:"strip",catchall:Hr.create(),typeName:L.ZodObject,...F(t)});gt.strictCreate=(e,t)=>new gt({shape:()=>e,unknownKeys:"strict",catchall:Hr.create(),typeName:L.ZodObject,...F(t)});gt.lazycreate=(e,t)=>new gt({shape:e,unknownKeys:"strip",catchall:Hr.create(),typeName:L.ZodObject,...F(t)});var Bn=class extends H{_parse(t){let{ctx:r}=this._processInputParams(t),o=this._def.options;function n(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=s.map(a=>new ht(a.ctx.common.issues));return I(r,{code:b.invalid_union,unionErrors:i}),$}if(r.common.async)return Promise.all(o.map(async s=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(n);{let s,i=[];for(let c of o){let l={...r,common:{...r.common,issues:[]},parent:null},p=c._parseSync({data:r.data,path:r.path,parent:l});if(p.status==="valid")return p;p.status==="dirty"&&!s&&(s={result:p,ctx:l}),l.common.issues.length&&i.push(l.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let a=i.map(c=>new ht(c));return I(r,{code:b.invalid_union,unionErrors:a}),$}}get options(){return this._def.options}};Bn.create=(e,t)=>new Bn({options:e,typeName:L.ZodUnion,...F(t)});var Ro=e=>e instanceof Vn?Ro(e.schema):e instanceof jt?Ro(e.innerType()):e instanceof Gn?[e.value]:e instanceof jn?e.options:e instanceof Wn?z.objectValues(e.enum):e instanceof zn?Ro(e._def.innerType):e instanceof Un?[void 0]:e instanceof Fn?[null]:e instanceof Vt?[void 0,...Ro(e.unwrap())]:e instanceof eo?[null,...Ro(e.unwrap())]:e instanceof Hi||e instanceof qn?Ro(e.unwrap()):e instanceof Kn?Ro(e._def.innerType):[],Tc=class e extends H{_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==T.object)return I(r,{code:b.invalid_type,expected:T.object,received:r.parsedType}),$;let o=this.discriminator,n=r.data[o],s=this.optionsMap.get(n);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(I(r,{code:b.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[o]}),$)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,o){let n=new Map;for(let s of r){let i=Ro(s.shape[t]);if(!i.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let a of i){if(n.has(a))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(a)}`);n.set(a,s)}}return new e({typeName:L.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:n,...F(o)})}};function Ju(e,t){let r=Qr(e),o=Qr(t);if(e===t)return{valid:!0,data:e};if(r===T.object&&o===T.object){let n=z.objectKeys(t),s=z.objectKeys(e).filter(a=>n.indexOf(a)!==-1),i={...e,...t};for(let a of s){let c=Ju(e[a],t[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===T.array&&o===T.array){if(e.length!==t.length)return{valid:!1};let n=[];for(let s=0;s<e.length;s++){let i=e[s],a=t[s],c=Ju(i,a);if(!c.valid)return{valid:!1};n.push(c.data)}return{valid:!0,data:n}}else return r===T.date&&o===T.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var Hn=class extends H{_parse(t){let{status:r,ctx:o}=this._processInputParams(t),n=(s,i)=>{if(Rc(s)||Rc(i))return $;let a=Ju(s.value,i.value);return a.valid?((Ic(s)||Ic(i))&&r.dirty(),{status:r.value,value:a.data}):(I(o,{code:b.invalid_intersection_types}),$)};return o.common.async?Promise.all([this._def.left._parseAsync({data:o.data,path:o.path,parent:o}),this._def.right._parseAsync({data:o.data,path:o.path,parent:o})]).then(([s,i])=>n(s,i)):n(this._def.left._parseSync({data:o.data,path:o.path,parent:o}),this._def.right._parseSync({data:o.data,path:o.path,parent:o}))}};Hn.create=(e,t,r)=>new Hn({left:e,right:t,typeName:L.ZodIntersection,...F(r)});var Zr=class e extends H{_parse(t){let{status:r,ctx:o}=this._processInputParams(t);if(o.parsedType!==T.array)return I(o,{code:b.invalid_type,expected:T.array,received:o.parsedType}),$;if(o.data.length<this._def.items.length)return I(o,{code:b.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),$;!this._def.rest&&o.data.length>this._def.items.length&&(I(o,{code:b.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...o.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Gt(o,i,o.path,a)):null}).filter(i=>!!i);return o.common.async?Promise.all(s).then(i=>We.mergeArray(r,i)):We.mergeArray(r,s)}get items(){return this._def.items}rest(t){return new e({...this._def,rest:t})}};Zr.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Zr({items:e,typeName:L.ZodTuple,rest:null,...F(t)})};var vc=class e extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:o}=this._processInputParams(t);if(o.parsedType!==T.object)return I(o,{code:b.invalid_type,expected:T.object,received:o.parsedType}),$;let n=[],s=this._def.keyType,i=this._def.valueType;for(let a in o.data)n.push({key:s._parse(new Gt(o,a,o.path,a)),value:i._parse(new Gt(o,o.data[a],o.path,a)),alwaysSet:a in o.data});return o.common.async?We.mergeObjectAsync(r,n):We.mergeObjectSync(r,n)}get element(){return this._def.valueType}static create(t,r,o){return r instanceof H?new e({keyType:t,valueType:r,typeName:L.ZodRecord,...F(o)}):new e({keyType:Zo.create(),valueType:t,typeName:L.ZodRecord,...F(r)})}},Ms=class extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:o}=this._processInputParams(t);if(o.parsedType!==T.map)return I(o,{code:b.invalid_type,expected:T.map,received:o.parsedType}),$;let n=this._def.keyType,s=this._def.valueType,i=[...o.data.entries()].map(([a,c],l)=>({key:n._parse(new Gt(o,a,o.path,[l,"key"])),value:s._parse(new Gt(o,c,o.path,[l,"value"]))}));if(o.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let l=await c.key,p=await c.value;if(l.status==="aborted"||p.status==="aborted")return $;(l.status==="dirty"||p.status==="dirty")&&r.dirty(),a.set(l.value,p.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let l=c.key,p=c.value;if(l.status==="aborted"||p.status==="aborted")return $;(l.status==="dirty"||p.status==="dirty")&&r.dirty(),a.set(l.value,p.value)}return{status:r.value,value:a}}}};Ms.create=(e,t,r)=>new Ms({valueType:t,keyType:e,typeName:L.ZodMap,...F(r)});var Ls=class e extends H{_parse(t){let{status:r,ctx:o}=this._processInputParams(t);if(o.parsedType!==T.set)return I(o,{code:b.invalid_type,expected:T.set,received:o.parsedType}),$;let n=this._def;n.minSize!==null&&o.data.size<n.minSize.value&&(I(o,{code:b.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&o.data.size>n.maxSize.value&&(I(o,{code:b.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());let s=this._def.valueType;function i(c){let l=new Set;for(let p of c){if(p.status==="aborted")return $;p.status==="dirty"&&r.dirty(),l.add(p.value)}return{status:r.value,value:l}}let a=[...o.data.values()].map((c,l)=>s._parse(new Gt(o,c,o.path,l)));return o.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(t,r){return new e({...this._def,minSize:{value:t,message:D.toString(r)}})}max(t,r){return new e({...this._def,maxSize:{value:t,message:D.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}};Ls.create=(e,t)=>new Ls({valueType:e,minSize:null,maxSize:null,typeName:L.ZodSet,...F(t)});var Cc=class e extends H{constructor(){super(...arguments),this.validate=this.implement}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==T.function)return I(r,{code:b.invalid_type,expected:T.function,received:r.parsedType}),$;function o(a,c){return Bi({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ds(),wo].filter(l=>!!l),issueData:{code:b.invalid_arguments,argumentsError:c}})}function n(a,c){return Bi({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ds(),wo].filter(l=>!!l),issueData:{code:b.invalid_return_type,returnTypeError:c}})}let s={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof tn){let a=this;return Qe(async function(...c){let l=new ht([]),p=await a._def.args.parseAsync(c,s).catch(m=>{throw l.addIssue(o(c,m)),l}),u=await Reflect.apply(i,this,p);return await a._def.returns._def.type.parseAsync(u,s).catch(m=>{throw l.addIssue(n(u,m)),l})})}else{let a=this;return Qe(function(...c){let l=a._def.args.safeParse(c,s);if(!l.success)throw new ht([o(c,l.error)]);let p=Reflect.apply(i,this,l.data),u=a._def.returns.safeParse(p,s);if(!u.success)throw new ht([n(p,u.error)]);return u.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new e({...this._def,args:Zr.create(t).rest(Io.create())})}returns(t){return new e({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,o){return new e({args:t||Zr.create([]).rest(Io.create()),returns:r||Io.create(),typeName:L.ZodFunction,...F(o)})}},Vn=class extends H{get schema(){return this._def.getter()}_parse(t){let{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};Vn.create=(e,t)=>new Vn({getter:e,typeName:L.ZodLazy,...F(t)});var Gn=class extends H{_parse(t){if(t.data!==this._def.value){let r=this._getOrReturnCtx(t);return I(r,{received:r.data,code:b.invalid_literal,expected:this._def.value}),$}return{status:"valid",value:t.data}}get value(){return this._def.value}};Gn.create=(e,t)=>new Gn({value:e,typeName:L.ZodLiteral,...F(t)});function Fx(e,t){return new jn({values:e,typeName:L.ZodEnum,...F(t)})}var jn=class e extends H{_parse(t){if(typeof t.data!="string"){let r=this._getOrReturnCtx(t),o=this._def.values;return I(r,{expected:z.joinValues(o),received:r.parsedType,code:b.invalid_type}),$}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){let r=this._getOrReturnCtx(t),o=this._def.values;return I(r,{received:r.data,code:b.invalid_enum_value,options:o}),$}return Qe(t.data)}get options(){return this._def.values}get enum(){let t={};for(let r of this._def.values)t[r]=r;return t}get Values(){let t={};for(let r of this._def.values)t[r]=r;return t}get Enum(){let t={};for(let r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return e.create(t,{...this._def,...r})}exclude(t,r=this._def){return e.create(this.options.filter(o=>!t.includes(o)),{...this._def,...r})}};jn.create=Fx;var Wn=class extends H{_parse(t){let r=z.getValidEnumValues(this._def.values),o=this._getOrReturnCtx(t);if(o.parsedType!==T.string&&o.parsedType!==T.number){let n=z.objectValues(r);return I(o,{expected:z.joinValues(n),received:o.parsedType,code:b.invalid_type}),$}if(this._cache||(this._cache=new Set(z.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){let n=z.objectValues(r);return I(o,{received:o.data,code:b.invalid_enum_value,options:n}),$}return Qe(t.data)}get enum(){return this._def.values}};Wn.create=(e,t)=>new Wn({values:e,typeName:L.ZodNativeEnum,...F(t)});var tn=class extends H{unwrap(){return this._def.type}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==T.promise&&r.common.async===!1)return I(r,{code:b.invalid_type,expected:T.promise,received:r.parsedType}),$;let o=r.parsedType===T.promise?r.data:Promise.resolve(r.data);return Qe(o.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}};tn.create=(e,t)=>new tn({type:e,typeName:L.ZodPromise,...F(t)});var jt=class extends H{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===L.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){let{status:r,ctx:o}=this._processInputParams(t),n=this._def.effect||null,s={addIssue:i=>{I(o,i),i.fatal?r.abort():r.dirty()},get path(){return o.path}};if(s.addIssue=s.addIssue.bind(s),n.type==="preprocess"){let i=n.transform(o.data,s);if(o.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return $;let c=await this._def.schema._parseAsync({data:a,path:o.path,parent:o});return c.status==="aborted"?$:c.status==="dirty"?On(c.value):r.value==="dirty"?On(c.value):c});{if(r.value==="aborted")return $;let a=this._def.schema._parseSync({data:i,path:o.path,parent:o});return a.status==="aborted"?$:a.status==="dirty"?On(a.value):r.value==="dirty"?On(a.value):a}}if(n.type==="refinement"){let i=a=>{let c=n.refinement(a,s);if(o.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(o.common.async===!1){let a=this._def.schema._parseSync({data:o.data,path:o.path,parent:o});return a.status==="aborted"?$:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:o.data,path:o.path,parent:o}).then(a=>a.status==="aborted"?$:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(n.type==="transform")if(o.common.async===!1){let i=this._def.schema._parseSync({data:o.data,path:o.path,parent:o});if(!Qo(i))return $;let a=n.transform(i.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:o.data,path:o.path,parent:o}).then(i=>Qo(i)?Promise.resolve(n.transform(i.value,s)).then(a=>({status:r.value,value:a})):$);z.assertNever(n)}};jt.create=(e,t,r)=>new jt({schema:e,typeName:L.ZodEffects,effect:t,...F(r)});jt.createWithPreprocess=(e,t,r)=>new jt({schema:t,effect:{type:"preprocess",transform:e},typeName:L.ZodEffects,...F(r)});var Vt=class extends H{_parse(t){return this._getType(t)===T.undefined?Qe(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Vt.create=(e,t)=>new Vt({innerType:e,typeName:L.ZodOptional,...F(t)});var eo=class extends H{_parse(t){return this._getType(t)===T.null?Qe(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};eo.create=(e,t)=>new eo({innerType:e,typeName:L.ZodNullable,...F(t)});var zn=class extends H{_parse(t){let{ctx:r}=this._processInputParams(t),o=r.data;return r.parsedType===T.undefined&&(o=this._def.defaultValue()),this._def.innerType._parse({data:o,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};zn.create=(e,t)=>new zn({innerType:e,typeName:L.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...F(t)});var Kn=class extends H{_parse(t){let{ctx:r}=this._processInputParams(t),o={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:o.data,path:o.path,parent:{...o}});return Ns(n)?n.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ht(o.common.issues)},input:o.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ht(o.common.issues)},input:o.data})}}removeCatch(){return this._def.innerType}};Kn.create=(e,t)=>new Kn({innerType:e,typeName:L.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...F(t)});var Us=class extends H{_parse(t){if(this._getType(t)!==T.nan){let o=this._getOrReturnCtx(t);return I(o,{code:b.invalid_type,expected:T.nan,received:o.parsedType}),$}return{status:"valid",value:t.data}}};Us.create=e=>new Us({typeName:L.ZodNaN,...F(e)});var W$=Symbol("zod_brand"),Hi=class extends H{_parse(t){let{ctx:r}=this._processInputParams(t),o=r.data;return this._def.type._parse({data:o,path:r.path,parent:r})}unwrap(){return this._def.type}},Vi=class e extends H{_parse(t){let{status:r,ctx:o}=this._processInputParams(t);if(o.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:o.data,path:o.path,parent:o});return s.status==="aborted"?$:s.status==="dirty"?(r.dirty(),On(s.value)):this._def.out._parseAsync({data:s.value,path:o.path,parent:o})})();{let n=this._def.in._parseSync({data:o.data,path:o.path,parent:o});return n.status==="aborted"?$:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:o.path,parent:o})}}static create(t,r){return new e({in:t,out:r,typeName:L.ZodPipeline})}},qn=class extends H{_parse(t){let r=this._def.innerType._parse(t),o=n=>(Qo(n)&&(n.value=Object.freeze(n.value)),n);return Ns(r)?r.then(n=>o(n)):o(r)}unwrap(){return this._def.innerType}};qn.create=(e,t)=>new qn({innerType:e,typeName:L.ZodReadonly,...F(t)});function $x(e,t){let r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function Bx(e,t={},r){return e?en.create().superRefine((o,n)=>{let s=e(o);if(s instanceof Promise)return s.then(i=>{if(!i){let a=$x(t,o),c=a.fatal??r??!0;n.addIssue({code:"custom",...a,fatal:c})}});if(!s){let i=$x(t,o),a=i.fatal??r??!0;n.addIssue({code:"custom",...i,fatal:a})}}):en.create()}var z$={object:gt.lazycreate},L;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(L||(L={}));var K$=(e,t={message:`Input not instance of ${e.name}`})=>Bx(r=>r instanceof e,t),Hx=Zo.create,Vx=kn.create,q$=Us.create,J$=$n.create,Gx=Mn.create,Y$=Ln.create,X$=ks.create,Q$=Un.create,Z$=Fn.create,e3=en.create,t3=Io.create,r3=Hr.create,o3=$s.create,n3=To.create,s3=gt.create,i3=gt.strictCreate,a3=Bn.create,c3=Tc.create,d3=Hn.create,l3=Zr.create,p3=vc.create,u3=Ms.create,f3=Ls.create,m3=Cc.create,h3=Vn.create,g3=Gn.create,x3=jn.create,y3=Wn.create,S3=tn.create,E3=jt.create,_3=Vt.create,b3=eo.create,w3=jt.createWithPreprocess,R3=Vi.create,I3=()=>Hx().optional(),T3=()=>Vx().optional(),v3=()=>Gx().optional(),C3={string:e=>Zo.create({...e,coerce:!0}),number:e=>kn.create({...e,coerce:!0}),boolean:e=>Mn.create({...e,coerce:!0}),bigint:e=>$n.create({...e,coerce:!0}),date:e=>Ln.create({...e,coerce:!0})};var A3=$;var P3=_.object({AWS_REGION:_.string().default("us-east-1"),STAGE:_.string().default("dev"),DYNAMODB_STAFF_TABLE:_.string().optional(),DYNAMODB_PASSWORD_RESET_TOKENS_TABLE:_.string().optional(),DYNAMODB_TENANTS_TABLE:_.string().optional(),JWT_SECRET:_.string().min(32,"JWT secret must be at least 32 characters long"),JWT_EXPIRY:_.string().default("24h"),SES_FROM_EMAIL:_.string().email().optional(),SES_REGION:_.string().default("us-east-1"),CORS_ORIGINS:_.string().optional(),APP_BASE_URL:_.string().optional(),LOG_LEVEL:_.enum(["debug","info","warn","error"]).default("info"),ENABLE_XRAY:_.string().transform(e=>e==="true").default("true"),BCRYPT_ROUNDS:_.string().transform(e=>parseInt(e,10)).default("12"),PASSWORD_RESET_TOKEN_EXPIRY_HOURS:_.string().transform(e=>parseInt(e,10)).default("24"),CONNECTION_TIMEOUT:_.string().transform(e=>parseInt(e,10)).default("5000"),REQUEST_TIMEOUT:_.string().transform(e=>parseInt(e,10)).default("30000")}),Ac=null;function D3(){if(Ac)return Ac;try{let e=P3.parse(process.env);return Ac={aws:{region:e.AWS_REGION},stage:e.STAGE,dynamodb:{staffTable:e.DYNAMODB_STAFF_TABLE||`Staff-${e.STAGE}`,passwordResetTokensTable:e.DYNAMODB_PASSWORD_RESET_TOKENS_TABLE||`PasswordResetTokens-${e.STAGE}`,tenantsTable:e.DYNAMODB_TENANTS_TABLE||`Tenants-${e.STAGE}`},jwt:{secret:e.JWT_SECRET,expiry:e.JWT_EXPIRY},ses:{fromEmail:e.SES_FROM_EMAIL||`noreply@${e.STAGE==="prod"?"example.com":"dev.example.com"}`,region:e.SES_REGION},cors:{origins:e.CORS_ORIGINS?e.CORS_ORIGINS.split(",").map(t=>t.trim()):e.STAGE==="prod"?[]:["*"]},app:{baseUrl:e.APP_BASE_URL||`https://${e.STAGE==="prod"?"app.example.com":`${e.STAGE}.example.com`}`},logging:{level:e.LOG_LEVEL,enableXray:e.ENABLE_XRAY},security:{bcryptRounds:e.BCRYPT_ROUNDS,passwordResetTokenExpiryHours:e.PASSWORD_RESET_TOKEN_EXPIRY_HOURS},performance:{connectionTimeout:e.CONNECTION_TIMEOUT,requestTimeout:e.REQUEST_TIMEOUT}},Ac}catch(e){if(e instanceof _.ZodError){let t=e.errors.map(r=>`${r.path.join(".")}: ${r.message}`);throw new Error(`Configuration validation failed:
${t.join(`
`)}`)}throw e}}function vo(){return D3()}var N3={origins:["*"],methods:["GET","POST","PUT","DELETE","OPTIONS"],headers:["Content-Type","Authorization","X-Correlation-ID"],credentials:!1,maxAge:86400};function jx(e,t=N3){let r={};return t.origins.includes("*")?r["Access-Control-Allow-Origin"]="*":e&&t.origins.includes(e)&&(r["Access-Control-Allow-Origin"]=e),r["Access-Control-Allow-Methods"]=t.methods.join(", "),r["Access-Control-Allow-Headers"]=t.headers.join(", "),t.credentials&&(r["Access-Control-Allow-Credentials"]="true"),t.maxAge&&(r["Access-Control-Max-Age"]=t.maxAge.toString()),r}var Pc=class{_statusCode=200;_headers={"Content-Type":"application/json",...jx()};_body="";_ended=!1;status(t){return this._statusCode=t,this}json(t){return this._headers["Content-Type"]="application/json",this._body=JSON.stringify(t),this._ended=!0,this}send(t){return this._body=t,this._ended=!0,this}header(t,r){return this._headers[t]=r,this}end(){this._ended=!0}toApiGatewayResponse(){return{statusCode:this._statusCode,headers:this._headers,body:this._body}}};function Wx(e,t,r,o){return{error:{code:e,message:t,details:o,correlationId:r},timestamp:new Date().toISOString()}}function Yu(e){switch(e){case"ValidationError":return 400;case"Unauthorized":return 401;case"Forbidden":return 403;case"NotFound":return 404;case"Conflict":return 409;case"InternalError":default:return 500}}function A(e,t,r,o,n){let s=Yu(t),i=Wx(t,r,o,n);e.status(s).json(i)}var Gi=class{routes=[];globalMiddlewares=[];constructor(t={}){}use(t){this.globalMiddlewares.push(t)}get(t,...r){this.addRoute("GET",t,...r)}post(t,...r){this.addRoute("POST",t,...r)}put(t,...r){this.addRoute("PUT",t,...r)}delete(t,...r){this.addRoute("DELETE",t,...r)}options(t,...r){this.addRoute("OPTIONS",t,...r)}addRoute(t,r,...o){let n=o[o.length-1],s=o.slice(0,-1);this.routes.push({method:t.toUpperCase(),path:r,handler:n,middlewares:s})}findRoute(t,r){for(let o of this.routes)if(o.method===t.toUpperCase()){if(o.path===r)return{route:o,params:{}};if(this.pathMatches(o.path,r)){let n=Dx(r,o.path);return{route:o,params:n}}}return null}pathMatches(t,r){let o=t.split("/"),n=r.split("/");if(o.length!==n.length)return!1;for(let s=0;s<o.length;s++){let i=o[s],a=n[s];if(!i?.startsWith(":")&&i!==a)return!1}return!0}async executeMiddlewares(t,r,o){let n=0,s=async()=>{if(n>=t.length)return;let i=t[n++];i&&await i(r,o,s)};try{return await s(),!o._ended}catch(i){return console.error("Middleware error:",i),o._ended||A(o,"InternalError","Internal server error",r.correlationId),!1}}async handle(t,r){let o=(t.httpMethod||t.requestContext?.http?.method)?.toUpperCase(),n=t.path||t.rawPath;if(!o)return{statusCode:400,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({error:{code:"BadRequest",message:"Missing HTTP method in request",correlationId:t.requestContext?.requestId||"unknown"},timestamp:new Date().toISOString()})};if(!n)return{statusCode:400,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({error:{code:"BadRequest",message:"Missing path in request",correlationId:t.requestContext?.requestId||"unknown"},timestamp:new Date().toISOString()})};if(o==="OPTIONS")return{statusCode:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Content-Type,Authorization","Access-Control-Allow-Methods":"GET,POST,PUT,DELETE,OPTIONS"},body:""};let s=this.findRoute(o,n);if(!s)return{statusCode:404,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({error:{code:"NotFound",message:`Route ${o} ${n} not found`,correlationId:t.requestContext?.requestId||"unknown"},timestamp:new Date().toISOString()})};let{route:i,params:a}=s,c=Nx(t,r,a),l=new Pc;try{let p=[...this.globalMiddlewares,...i.middlewares||[]];return await this.executeMiddlewares(p,c,l)&&!l._ended&&await i.handler(c,l),l._ended||l.status(500).json({error:{code:"InternalError",message:"Handler did not send a response",correlationId:c.correlationId},timestamp:new Date().toISOString()}),l.toApiGatewayResponse()}catch(p){return console.error("Route handler error:",p),l._ended||A(l,"InternalError","Internal server error",c.correlationId),l.toApiGatewayResponse()}}},Bj=new Gi;function Xu(e={}){let{origins:t=["*"],methods:r=["GET","POST","PUT","DELETE","OPTIONS"],headers:o=["Content-Type","Authorization","X-Correlation-ID"],credentials:n=!1}=e;return async(s,i,a)=>{let c=s.headers.origin||s.headers.Origin,l="*";if(t.length>0&&!t.includes("*")&&(c&&t.includes(c)?l=c:l=t[0]||"*"),i.header("Access-Control-Allow-Origin",l),i.header("Access-Control-Allow-Methods",r.join(", ")),i.header("Access-Control-Allow-Headers",o.join(", ")),n&&i.header("Access-Control-Allow-Credentials","true"),s.method==="OPTIONS"){i.status(200).send("");return}await a()}}function Zu(e={}){let{enableRequestLogging:t=!0,enableResponseLogging:r=!0,logLevel:o="info",sensitiveHeaders:n=["authorization","cookie","x-api-key"]}=e;return async(s,i,a)=>{let c=Date.now();if(t){let f=O3(s.headers,n);console.log(JSON.stringify({level:o,message:"Incoming request",correlationId:s.correlationId,method:s.method,path:s.path,headers:f,query:s.query,timestamp:new Date().toISOString(),requestId:s.rawEvent.requestContext.requestId}))}let l=i.json.bind(i),p=i.send.bind(i),u=i.end.bind(i);r&&(i.json=function(f){return Qu(s.correlationId,i._statusCode,f,c),l(f)},i.send=function(f){return Qu(s.correlationId,i._statusCode,f,c),p(f)},i.end=function(){return Qu(s.correlationId,i._statusCode,i._body,c),u()});try{await a()}catch(f){throw console.error(JSON.stringify({level:"error",message:"Request processing error",correlationId:s.correlationId,error:f instanceof Error?{name:f.name,message:f.message,stack:f.stack}:f,timestamp:new Date().toISOString()})),f}}}function O3(e,t){let r={};for(let[o,n]of Object.entries(e))t.includes(o.toLowerCase())?r[o]="[REDACTED]":r[o]=n;return r}function Qu(e,t,r,o){let n=Date.now()-o;console.log(JSON.stringify({level:"info",message:"Response sent",correlationId:e,statusCode:t,duration:`${n}ms`,bodySize:typeof r=="string"?r.length:JSON.stringify(r).length,timestamp:new Date().toISOString()}))}function Vr(e){return async(t,r,o)=>{try{if(e.body){let n=e.body.safeParse(t.body);if(!n.success){A(r,"ValidationError","Invalid request body",t.correlationId,{field:"body",errors:n.error.errors});return}t.body=n.data}if(e.query){let n=e.query.safeParse(t.query);if(!n.success){A(r,"ValidationError","Invalid query parameters",t.correlationId,{field:"query",errors:n.error.errors});return}t.query=n.data}if(e.params){let n=e.params.safeParse(t.params);if(!n.success){A(r,"ValidationError","Invalid path parameters",t.correlationId,{field:"params",errors:n.error.errors});return}t.params=n.data}if(e.headers){let n=e.headers.safeParse(t.headers);if(!n.success){A(r,"ValidationError","Invalid headers",t.correlationId,{field:"headers",errors:n.error.errors});return}}await o()}catch(n){console.error("Validation middleware error:",n),A(r,"InternalError","Validation error",t.correlationId)}}}var k3={email:_.string().email().transform(e=>e.toLowerCase().trim()),staffId:_.string().uuid(),tenantId:_.string().uuid(),correlationId:_.string().uuid().optional(),pagination:_.object({limit:_.coerce.number().int().min(1).max(100).default(20),offset:_.coerce.number().int().min(0).default(0)}),authHeaders:_.object({authorization:_.string().regex(/^Bearer .+/,"Authorization header must be Bearer token")})};import{Buffer as zx}from"node:buffer";var Wt=new TextEncoder,Gr=new TextDecoder,Kj=2**32;function Dc(...e){let t=e.reduce((n,{length:s})=>n+s,0),r=new Uint8Array(t),o=0;for(let n of e)r.set(n,o),o+=n.length;return r}function $3(e){let t=e;return t instanceof Uint8Array&&(t=Gr.decode(t)),t}var Nc=e=>zx.from(e).toString("base64url");var Fs=e=>new Uint8Array(zx.from($3(e),"base64url"));var Co=class extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(t,r){super(t,r),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}},Ot=class extends Co{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(t,r,o="unspecified",n="unspecified"){super(t,{cause:{claim:o,reason:n,payload:r}}),this.claim=o,this.reason=n,this.payload=r}},ji=class extends Co{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(t,r,o="unspecified",n="unspecified"){super(t,{cause:{claim:o,reason:n,payload:r}}),this.claim=o,this.reason=n,this.payload=r}},Oc=class extends Co{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"},lt=class extends Co{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"};var ge=class extends Co{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"},rn=class extends Co{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"};var kc=class extends Co{static code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";constructor(t="signature verification failed",r){super(t,r)}};import*as Kx from"node:util";var $c=e=>Kx.types.isKeyObject(e);import*as qx from"node:crypto";import*as Jx from"node:util";var L3=qx.webcrypto,Yx=L3,Bs=e=>Jx.types.isCryptoKey(e);function to(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function Wi(e,t){return e.name===t}function ef(e){return parseInt(e.name.slice(4),10)}function U3(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function F3(e,t){if(t.length&&!t.some(r=>e.usages.includes(r))){let r="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let o=t.pop();r+=`one of ${t.join(", ")}, or ${o}.`}else t.length===2?r+=`one of ${t[0]} or ${t[1]}.`:r+=`${t[0]}.`;throw new TypeError(r)}}function Xx(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!Wi(e.algorithm,"HMAC"))throw to("HMAC");let o=parseInt(t.slice(2),10);if(ef(e.algorithm.hash)!==o)throw to(`SHA-${o}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!Wi(e.algorithm,"RSASSA-PKCS1-v1_5"))throw to("RSASSA-PKCS1-v1_5");let o=parseInt(t.slice(2),10);if(ef(e.algorithm.hash)!==o)throw to(`SHA-${o}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!Wi(e.algorithm,"RSA-PSS"))throw to("RSA-PSS");let o=parseInt(t.slice(2),10);if(ef(e.algorithm.hash)!==o)throw to(`SHA-${o}`,"algorithm.hash");break}case"EdDSA":{if(e.algorithm.name!=="Ed25519"&&e.algorithm.name!=="Ed448")throw to("Ed25519 or Ed448");break}case"Ed25519":{if(!Wi(e.algorithm,"Ed25519"))throw to("Ed25519");break}case"ES256":case"ES384":case"ES512":{if(!Wi(e.algorithm,"ECDSA"))throw to("ECDSA");let o=U3(t);if(e.algorithm.namedCurve!==o)throw to(o,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}F3(e,r)}function Qx(e,t,...r){if(r=r.filter(Boolean),r.length>2){let o=r.pop();e+=`one of type ${r.join(", ")}, or ${o}.`}else r.length===2?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return t==null?e+=` Received ${t}`:typeof t=="function"&&t.name?e+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}var zi=(e,...t)=>Qx("Key must be ",e,...t);function tf(e,t,...r){return Qx(`Key for the ${e} algorithm must be `,t,...r)}var rf=e=>$c(e)||Bs(e),Ao=["KeyObject"];(globalThis.CryptoKey||Yx?.CryptoKey)&&Ao.push("CryptoKey");var B3=(...e)=>{let t=e.filter(Boolean);if(t.length===0||t.length===1)return!0;let r;for(let o of t){let n=Object.keys(o);if(!r||r.size===0){r=new Set(n);continue}for(let s of n){if(r.has(s))return!1;r.add(s)}}return!0},Mc=B3;function H3(e){return typeof e=="object"&&e!==null}function zt(e){if(!H3(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}import{KeyObject as V3}from"node:crypto";function ro(e){return zt(e)&&typeof e.kty=="string"}function Zx(e){return e.kty!=="oct"&&typeof e.d=="string"}function ey(e){return e.kty!=="oct"&&typeof e.d>"u"}function ty(e){return ro(e)&&e.kty==="oct"&&typeof e.k=="string"}var G3=e=>{switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new lt("Unsupported key curve for this operation")}},j3=(e,t)=>{let r;if(Bs(e))r=V3.from(e);else if($c(e))r=e;else{if(ro(e))return e.crv;throw new TypeError(zi(e,...Ao))}if(r.type==="secret")throw new TypeError('only "private" or "public" type keys can be used for this operation');switch(r.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${r.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${r.asymmetricKeyType.slice(1)}`;case"ec":{let o=r.asymmetricKeyDetails.namedCurve;return t?o:G3(o)}default:throw new TypeError("Invalid asymmetric key type for this operation")}},oy=j3;import{KeyObject as W3}from"node:crypto";var of=(e,t)=>{let r;try{e instanceof W3?r=e.asymmetricKeyDetails?.modulusLength:r=Buffer.from(e.n,"base64url").byteLength<<3}catch{}if(typeof r!="number"||r<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)};import{createPrivateKey as z3,createPublicKey as K3}from"node:crypto";var q3=e=>e.d?z3({format:"jwk",key:e}):K3({format:"jwk",key:e}),ny=q3;async function sy(e,t){if(!zt(e))throw new TypeError("JWK must be an object");switch(t||=e.alg,e.kty){case"oct":if(typeof e.k!="string"||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return Fs(e.k);case"RSA":if("oth"in e&&e.oth!==void 0)throw new lt('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return ny({...e,alg:t});default:throw new lt('Unsupported "kty" (Key Type) Parameter value')}}var Hs=e=>e?.[Symbol.toStringTag],nf=(e,t,r)=>{if(t.use!==void 0&&t.use!=="sig")throw new TypeError("Invalid key for this operation, when present its use must be sig");if(t.key_ops!==void 0&&t.key_ops.includes?.(r)!==!0)throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(t.alg!==void 0&&t.alg!==e)throw new TypeError(`Invalid key for this operation, when present its alg must be ${e}`);return!0},J3=(e,t,r,o)=>{if(!(t instanceof Uint8Array)){if(o&&ro(t)){if(ty(t)&&nf(e,t,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!rf(t))throw new TypeError(tf(e,t,...Ao,"Uint8Array",o?"JSON Web Key":null));if(t.type!=="secret")throw new TypeError(`${Hs(t)} instances for symmetric algorithms must be of type "secret"`)}},Y3=(e,t,r,o)=>{if(o&&ro(t))switch(r){case"sign":if(Zx(t)&&nf(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(ey(t)&&nf(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!rf(t))throw new TypeError(tf(e,t,...Ao,o?"JSON Web Key":null));if(t.type==="secret")throw new TypeError(`${Hs(t)} instances for asymmetric algorithms must not be of type "secret"`);if(r==="sign"&&t.type==="public")throw new TypeError(`${Hs(t)} instances for asymmetric algorithm signing must be of type "private"`);if(r==="decrypt"&&t.type==="public")throw new TypeError(`${Hs(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&r==="verify"&&t.type==="private")throw new TypeError(`${Hs(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&r==="encrypt"&&t.type==="private")throw new TypeError(`${Hs(t)} instances for asymmetric algorithm encryption must be of type "public"`)};function iy(e,t,r,o){t.startsWith("HS")||t==="dir"||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?J3(t,r,o,e):Y3(t,r,o,e)}var v7=iy.bind(void 0,!1),Ki=iy.bind(void 0,!0);function X3(e,t,r,o,n){if(n.crit!==void 0&&o?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!o||o.crit===void 0)return new Set;if(!Array.isArray(o.crit)||o.crit.length===0||o.crit.some(i=>typeof i!="string"||i.length===0))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let s;r!==void 0?s=new Map([...Object.entries(r),...t.entries()]):s=t;for(let i of o.crit){if(!s.has(i))throw new lt(`Extension Header Parameter "${i}" is not recognized`);if(n[i]===void 0)throw new e(`Extension Header Parameter "${i}" is missing`);if(s.get(i)&&o[i]===void 0)throw new e(`Extension Header Parameter "${i}" MUST be integrity protected`)}return new Set(o.crit)}var Lc=X3;var Q3=(e,t)=>{if(t!==void 0&&(!Array.isArray(t)||t.some(r=>typeof r!="string")))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)},ay=Q3;import*as Bc from"node:crypto";import{promisify as n2}from"node:util";function qi(e){switch(e){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"Ed25519":case"EdDSA":return;default:throw new lt(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}import{constants as cy,KeyObject as Z3}from"node:crypto";var e2=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);function Ji(e,t){let r,o,n;if(t instanceof Z3)r=t.asymmetricKeyType,o=t.asymmetricKeyDetails;else switch(n=!0,t.kty){case"RSA":r="rsa";break;case"EC":r="ec";break;case"OKP":{if(t.crv==="Ed25519"){r="ed25519";break}if(t.crv==="Ed448"){r="ed448";break}throw new TypeError("Invalid key for this operation, its crv must be Ed25519 or Ed448")}default:throw new TypeError("Invalid key for this operation, its kty must be RSA, OKP, or EC")}let s;switch(e){case"Ed25519":if(r!=="ed25519")throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519");break;case"EdDSA":if(!["ed25519","ed448"].includes(r))throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");break;case"RS256":case"RS384":case"RS512":if(r!=="rsa")throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");of(t,e);break;case"PS256":case"PS384":case"PS512":if(r==="rsa-pss"){let{hashAlgorithm:i,mgf1HashAlgorithm:a,saltLength:c}=o,l=parseInt(e.slice(-3),10);if(i!==void 0&&(i!==`sha${l}`||a!==i))throw new TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}`);if(c!==void 0&&c>l>>3)throw new TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}`)}else if(r!=="rsa")throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");of(t,e),s={padding:cy.RSA_PKCS1_PSS_PADDING,saltLength:cy.RSA_PSS_SALTLEN_DIGEST};break;case"ES256":case"ES256K":case"ES384":case"ES512":{if(r!=="ec")throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let i=oy(t),a=e2.get(e);if(i!==a)throw new TypeError(`Invalid key curve for the algorithm, its curve must be ${a}, got ${i}`);s={dsaEncoding:"ieee-p1363"};break}default:throw new lt(`alg ${e} is not supported either by JOSE or your javascript runtime`)}return n?{format:"jwk",key:t,...s}:s?{...s,key:t}:t}import*as Uc from"node:crypto";import{promisify as t2}from"node:util";function sf(e){switch(e){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new lt(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}import{KeyObject as dy,createSecretKey as ly}from"node:crypto";function Yi(e,t,r){if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(zi(t,...Ao));return ly(t)}if(t instanceof dy)return t;if(Bs(t))return Xx(t,e,r),dy.from(t);if(ro(t))return e.startsWith("HS")?ly(Buffer.from(t.k,"base64url")):t;throw new TypeError(zi(t,...Ao,"Uint8Array","JSON Web Key"))}var r2=t2(Uc.sign),o2=async(e,t,r)=>{let o=Yi(e,t,"sign");if(e.startsWith("HS")){let n=Uc.createHmac(sf(e),o);return n.update(r),n.digest()}return r2(qi(e),r,Ji(e,o))},Fc=o2;var s2=n2(Bc.verify),i2=async(e,t,r,o)=>{let n=Yi(e,t,"verify");if(e.startsWith("HS")){let a=await Fc(e,n,o),c=r;try{return Bc.timingSafeEqual(c,a)}catch{return!1}}let s=qi(e),i=Ji(e,n);try{return await s2(s,o,i,r)}catch{return!1}},py=i2;async function uy(e,t,r){if(!zt(e))throw new ge("Flattened JWS must be an object");if(e.protected===void 0&&e.header===void 0)throw new ge('Flattened JWS must have either of the "protected" or "header" members');if(e.protected!==void 0&&typeof e.protected!="string")throw new ge("JWS Protected Header incorrect type");if(e.payload===void 0)throw new ge("JWS Payload missing");if(typeof e.signature!="string")throw new ge("JWS Signature missing or incorrect type");if(e.header!==void 0&&!zt(e.header))throw new ge("JWS Unprotected Header incorrect type");let o={};if(e.protected)try{let g=Fs(e.protected);o=JSON.parse(Gr.decode(g))}catch{throw new ge("JWS Protected Header is invalid")}if(!Mc(o,e.header))throw new ge("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let n={...o,...e.header},s=Lc(ge,new Map([["b64",!0]]),r?.crit,o,n),i=!0;if(s.has("b64")&&(i=o.b64,typeof i!="boolean"))throw new ge('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:a}=n;if(typeof a!="string"||!a)throw new ge('JWS "alg" (Algorithm) Header Parameter missing or invalid');let c=r&&ay("algorithms",r.algorithms);if(c&&!c.has(a))throw new Oc('"alg" (Algorithm) Header Parameter value not allowed');if(i){if(typeof e.payload!="string")throw new ge("JWS Payload must be a string")}else if(typeof e.payload!="string"&&!(e.payload instanceof Uint8Array))throw new ge("JWS Payload must be a string or an Uint8Array instance");let l=!1;typeof t=="function"?(t=await t(o,e),l=!0,Ki(a,t,"verify"),ro(t)&&(t=await sy(t,a))):Ki(a,t,"verify");let p=Dc(Wt.encode(e.protected??""),Wt.encode("."),typeof e.payload=="string"?Wt.encode(e.payload):e.payload),u;try{u=Fs(e.signature)}catch{throw new ge("Failed to base64url decode the signature")}if(!await py(a,t,u,p))throw new kc;let m;if(i)try{m=Fs(e.payload)}catch{throw new ge("Failed to base64url decode the payload")}else typeof e.payload=="string"?m=Wt.encode(e.payload):m=e.payload;let h={payload:m};return e.protected!==void 0&&(h.protectedHeader=o),e.header!==void 0&&(h.unprotectedHeader=e.header),l?{...h,key:t}:h}async function fy(e,t,r){if(e instanceof Uint8Array&&(e=Gr.decode(e)),typeof e!="string")throw new ge("Compact JWS must be a string or Uint8Array");let{0:o,1:n,2:s,length:i}=e.split(".");if(i!==3)throw new ge("Invalid Compact JWS");let a=await uy({payload:n,protected:o,signature:s},t,r),c={payload:a.payload,protectedHeader:a.protectedHeader};return typeof t=="function"?{...c,key:a.key}:c}var oo=e=>Math.floor(e.getTime()/1e3);var a2=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,Jn=e=>{let t=a2.exec(e);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");let r=parseFloat(t[2]),o=t[3].toLowerCase(),n;switch(o){case"sec":case"secs":case"second":case"seconds":case"s":n=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":n=Math.round(r*60);break;case"hour":case"hours":case"hr":case"hrs":case"h":n=Math.round(r*3600);break;case"day":case"days":case"d":n=Math.round(r*86400);break;case"week":case"weeks":case"w":n=Math.round(r*604800);break;default:n=Math.round(r*31557600);break}return t[1]==="-"||t[4]==="ago"?-n:n};var my=e=>e.toLowerCase().replace(/^application\//,""),c2=(e,t)=>typeof e=="string"?t.includes(e):Array.isArray(e)?t.some(Set.prototype.has.bind(new Set(e))):!1,hy=(e,t,r={})=>{let o;try{o=JSON.parse(Gr.decode(t))}catch{}if(!zt(o))throw new rn("JWT Claims Set must be a top-level JSON object");let{typ:n}=r;if(n&&(typeof e.typ!="string"||my(e.typ)!==my(n)))throw new Ot('unexpected "typ" JWT header value',o,"typ","check_failed");let{requiredClaims:s=[],issuer:i,subject:a,audience:c,maxTokenAge:l}=r,p=[...s];l!==void 0&&p.push("iat"),c!==void 0&&p.push("aud"),a!==void 0&&p.push("sub"),i!==void 0&&p.push("iss");for(let h of new Set(p.reverse()))if(!(h in o))throw new Ot(`missing required "${h}" claim`,o,h,"missing");if(i&&!(Array.isArray(i)?i:[i]).includes(o.iss))throw new Ot('unexpected "iss" claim value',o,"iss","check_failed");if(a&&o.sub!==a)throw new Ot('unexpected "sub" claim value',o,"sub","check_failed");if(c&&!c2(o.aud,typeof c=="string"?[c]:c))throw new Ot('unexpected "aud" claim value',o,"aud","check_failed");let u;switch(typeof r.clockTolerance){case"string":u=Jn(r.clockTolerance);break;case"number":u=r.clockTolerance;break;case"undefined":u=0;break;default:throw new TypeError("Invalid clockTolerance option type")}let{currentDate:f}=r,m=oo(f||new Date);if((o.iat!==void 0||l)&&typeof o.iat!="number")throw new Ot('"iat" claim must be a number',o,"iat","invalid");if(o.nbf!==void 0){if(typeof o.nbf!="number")throw new Ot('"nbf" claim must be a number',o,"nbf","invalid");if(o.nbf>m+u)throw new Ot('"nbf" claim timestamp check failed',o,"nbf","check_failed")}if(o.exp!==void 0){if(typeof o.exp!="number")throw new Ot('"exp" claim must be a number',o,"exp","invalid");if(o.exp<=m-u)throw new ji('"exp" claim timestamp check failed',o,"exp","check_failed")}if(l){let h=m-o.iat,g=typeof l=="number"?l:Jn(l);if(h-u>g)throw new ji('"iat" claim timestamp check failed (too far in the past)',o,"iat","check_failed");if(h<0-u)throw new Ot('"iat" claim timestamp check failed (it should be in the past)',o,"iat","check_failed")}return o};async function af(e,t,r){let o=await fy(e,t,r);if(o.protectedHeader.crit?.includes("b64")&&o.protectedHeader.b64===!1)throw new rn("JWTs MUST NOT use unencoded payload");let s={payload:hy(o.protectedHeader,o.payload,r),protectedHeader:o.protectedHeader};return typeof t=="function"?{...s,key:o.key}:s}var Hc=class{_payload;_protectedHeader;_unprotectedHeader;constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=t}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}async sign(t,r){if(!this._protectedHeader&&!this._unprotectedHeader)throw new ge("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!Mc(this._protectedHeader,this._unprotectedHeader))throw new ge("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let o={...this._protectedHeader,...this._unprotectedHeader},n=Lc(ge,new Map([["b64",!0]]),r?.crit,this._protectedHeader,o),s=!0;if(n.has("b64")&&(s=this._protectedHeader.b64,typeof s!="boolean"))throw new ge('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:i}=o;if(typeof i!="string"||!i)throw new ge('JWS "alg" (Algorithm) Header Parameter missing or invalid');Ki(i,t,"sign");let a=this._payload;s&&(a=Wt.encode(Nc(a)));let c;this._protectedHeader?c=Wt.encode(Nc(JSON.stringify(this._protectedHeader))):c=Wt.encode("");let l=Dc(c,Wt.encode("."),a),p=await Fc(i,t,l),u={signature:Nc(p),payload:""};return s&&(u.payload=Gr.decode(a)),this._unprotectedHeader&&(u.header=this._unprotectedHeader),this._protectedHeader&&(u.protected=Gr.decode(c)),u}};var Vc=class{_flattened;constructor(t){this._flattened=new Hc(t)}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}async sign(t,r){let o=await this._flattened.sign(t,r);if(o.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${o.protected}.${o.payload}.${o.signature}`}};function Yn(e,t){if(!Number.isFinite(t))throw new TypeError(`Invalid ${e} input`);return t}var Gc=class{_payload;constructor(t={}){if(!zt(t))throw new TypeError("JWT Claims Set MUST be an object");this._payload=t}setIssuer(t){return this._payload={...this._payload,iss:t},this}setSubject(t){return this._payload={...this._payload,sub:t},this}setAudience(t){return this._payload={...this._payload,aud:t},this}setJti(t){return this._payload={...this._payload,jti:t},this}setNotBefore(t){return typeof t=="number"?this._payload={...this._payload,nbf:Yn("setNotBefore",t)}:t instanceof Date?this._payload={...this._payload,nbf:Yn("setNotBefore",oo(t))}:this._payload={...this._payload,nbf:oo(new Date)+Jn(t)},this}setExpirationTime(t){return typeof t=="number"?this._payload={...this._payload,exp:Yn("setExpirationTime",t)}:t instanceof Date?this._payload={...this._payload,exp:Yn("setExpirationTime",oo(t))}:this._payload={...this._payload,exp:oo(new Date)+Jn(t)},this}setIssuedAt(t){return typeof t>"u"?this._payload={...this._payload,iat:oo(new Date)}:t instanceof Date?this._payload={...this._payload,iat:Yn("setIssuedAt",oo(t))}:typeof t=="string"?this._payload={...this._payload,iat:Yn("setIssuedAt",oo(new Date)+Jn(t))}:this._payload={...this._payload,iat:Yn("setIssuedAt",t)},this}};var Xi=class extends Gc{_protectedHeader;setProtectedHeader(t){return this._protectedHeader=t,this}async sign(t,r){let o=new Vc(Wt.encode(JSON.stringify(this._payload)));if(o.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new rn("JWTs MUST NOT use unencoded payload");return o.sign(t,r)}};var d2=[/password/i,/secret/i,/token/i,/key/i,/auth/i,/credential/i,/ssn/i,/social.security/i,/credit.card/i,/card.number/i,/cvv/i,/pin/i,/phone/i,/email/i,/address/i,/zip/i,/postal/i],l2=/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,p2=[/\b\d{3}-\d{3}-\d{4}\b/g,/\b\(\d{3}\)\s*\d{3}-\d{4}\b/g,/\b\d{10}\b/g,/\b\+1\s*\d{3}\s*\d{3}\s*\d{4}\b/g],df=class{logLevel;enableConsoleOutput;constructor(t="info",r=!0){this.logLevel=t,this.enableConsoleOutput=r}shouldLog(t){let r=["debug","info","warn","error"],o=r.indexOf(this.logLevel);return r.indexOf(t)>=o}createLogEntry(t,r,o){return{level:t,message:r,timestamp:new Date().toISOString(),...o&&{metadata:this.sanitizeMetadata(o)}}}output(t){this.shouldLog(t.level)&&this.enableConsoleOutput&&console.log(JSON.stringify(t))}debug(t,r){let o=this.createLogEntry("debug",t,r);this.output(o)}info(t,r){let o=this.createLogEntry("info",t,r);this.output(o)}warn(t,r){let o=this.createLogEntry("warn",t,r);this.output(o)}error(t,r,o){let n=this.createLogEntry("error",t,{...o,error:r instanceof Error?{name:r.name,message:r.message,stack:r.stack}:r});this.output(n)}sanitizeMetadata(t){return this.sanitizeObject(t)}sanitizeObject(t){if(t==null)return t;if(typeof t=="string")return this.sanitizeString(t);if(typeof t=="number"||typeof t=="boolean")return t;if(Array.isArray(t))return t.map(r=>this.sanitizeObject(r));if(typeof t=="object"){let r={};for(let[o,n]of Object.entries(t))this.isPiiField(o)?r[o]="[REDACTED]":r[o]=this.sanitizeObject(n);return r}return t}isPiiField(t){return d2.some(r=>r.test(t))}sanitizeString(t){let r=t;return r=r.replace(l2,"[EMAIL_REDACTED]"),p2.forEach(o=>{r=r.replace(o,"[PHONE_REDACTED]")}),r}},cf=null;function jc(){if(!cf){let e=vo();cf=new df(e.logging.level,!0)}return cf}var x={debug:(e,t)=>jc().debug(e,t),info:(e,t)=>jc().info(e,t),warn:(e,t)=>jc().warn(e,t),error:(e,t,r)=>jc().error(e,t,r)};var gy="HS256",xy="aws-lambda-control-plane",yy="control-plane-api",u2=()=>{let t=vo().jwt.secret;if(!t)throw new Error("JWT_SECRET environment variable is required");if(t.length<32)throw new Error("JWT_SECRET must be at least 32 characters long");return new TextEncoder().encode(t)},Vs=class{secret;constructor(){this.secret=u2(),x.info("JWT helper initialized")}async signToken(t,r){try{x.info("Signing JWT token",{staffId:t.staffId,email:t.email,roles:t.roles,correlationId:r});let o=Math.floor(Date.now()/1e3),n=o+24*60*60,s=await new Xi({sub:t.staffId,email:t.email,roles:t.roles,iat:o,exp:n,iss:xy,aud:yy}).setProtectedHeader({alg:gy}).sign(this.secret);return x.info("JWT token signed successfully",{staffId:t.staffId,expiresAt:new Date(n*1e3).toISOString(),correlationId:r}),s}catch(o){throw x.error("Failed to sign JWT token",{error:o instanceof Error?o.message:"Unknown error",staffId:t.staffId,correlationId:r}),o}}async verifyToken(t,r){try{x.info("Verifying JWT token",{correlationId:r});let{payload:o}=await af(t,this.secret,{issuer:xy,audience:yy,algorithms:[gy]});if(!o.sub||!o.email||!o.roles)throw new Error("Invalid JWT payload: missing required fields");if(!Array.isArray(o.roles))throw new Error("Invalid JWT payload: roles must be an array");let n={sub:o.sub,email:o.email,roles:o.roles,iat:o.iat,exp:o.exp,...o.iss&&{iss:o.iss},...typeof o.aud=="string"&&{aud:o.aud}};return x.info("JWT token verified successfully",{staffId:n.sub,email:n.email,roles:n.roles,expiresAt:new Date(n.exp*1e3).toISOString(),correlationId:r}),n}catch(o){throw x.error("Failed to verify JWT token",{error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o}}static extractTokenFromHeader(t){if(!t)return null;let r=t.split(" ");return r.length!==2||r[0]!=="Bearer"?null:r[1]||null}static isTokenExpired(t){try{let r=t.split(".");if(r.length!==3)return!0;let o=JSON.parse(atob(r[1])),n=Math.floor(Date.now()/1e3);return o.exp&&o.exp<n}catch{return!0}}static getTokenExpiration(t){try{let r=t.split(".");if(r.length!==3)return null;let o=JSON.parse(atob(r[1]));return o.exp?new Date(o.exp*1e3):null}catch{return null}}},lf=null,Gs={get instance(){return lf||(lf=new Vs),lf},signToken:(e,t)=>Gs.instance.signToken(e,t),verifyToken:(e,t)=>Gs.instance.verifyToken(e,t)};function on(e={}){let{required:t=!0}=e;return async(r,o,n)=>{try{let s=r.headers.authorization||r.headers.Authorization;if(!s)if(t){x.warn("Missing authorization header",{correlationId:r.correlationId,path:r.path,method:r.method}),A(o,"Unauthorized","Missing authorization header",r.correlationId);return}else{r.context={authenticated:!1},await n();return}let i=Vs.extractTokenFromHeader(s);if(!i){x.warn("Invalid authorization header format",{correlationId:r.correlationId,path:r.path,method:r.method}),A(o,"Unauthorized","Invalid authorization header format",r.correlationId);return}if(Vs.isTokenExpired(i)){x.warn("Token is expired",{correlationId:r.correlationId,path:r.path,method:r.method}),A(o,"Unauthorized","Token has expired",r.correlationId);return}let a=await Gs.verifyToken(i,r.correlationId),c={staff_id:a.sub,email:a.email,roles:a.roles,stage:process.env.STAGE||"dev",authenticated:!0};r.context=c,x.info("Authentication successful",{staffId:c.staff_id,email:c.email,roles:c.roles,correlationId:r.correlationId,path:r.path,method:r.method}),await n()}catch(s){x.error("Authentication middleware error",{error:s instanceof Error?s.message:"Unknown error",correlationId:r.correlationId,path:r.path,method:r.method}),s instanceof Error?s.message.includes("expired")||s.message.includes("exp")?A(o,"Unauthorized","Token has expired",r.correlationId):s.message.includes("signature")||s.message.includes("invalid")?A(o,"Unauthorized","Invalid token signature",r.correlationId):A(o,"Unauthorized","Authentication failed",r.correlationId):A(o,"Unauthorized","Authentication failed",r.correlationId)}}}function pf(e){return async(t,r,o)=>{if(!t.context.authenticated){x.warn("Authorization failed: not authenticated",{correlationId:t.correlationId,path:t.path,method:t.method,requiredRoles:e}),A(r,"Unauthorized","Authentication required",t.correlationId);return}let n=t.context.roles||[];if(!e.some(i=>n.includes(i))){x.warn("Authorization failed: insufficient permissions",{correlationId:t.correlationId,path:t.path,method:t.method,userRoles:n,requiredRoles:e}),A(r,"Forbidden",`Insufficient permissions. Required roles: ${e.join(", ")}`,t.correlationId);return}x.info("Authorization successful",{correlationId:t.correlationId,path:t.path,method:t.method,userRoles:n,requiredRoles:e}),await o()}}var Qi=pf(["admin"]),uf=pf(["admin","manager"]);function f2(e={}){let{corsOrigins:t=["*"],enableLogging:r=!0,logLevel:o="info"}=e,n=new Gi({corsOrigins:t,enableLogging:r,enableTracing:!0});return r&&n.use(Zu({enableRequestLogging:!0,enableResponseLogging:!0,logLevel:o})),n.use(Xu({origins:t,methods:["GET","POST","PUT","DELETE","OPTIONS"],headers:["Content-Type","Authorization","X-Correlation-ID"],credentials:!1})),n}function Sy(){let e=process.env.STAGE||"dev",t=e==="prod"?process.env.CORS_ORIGINS?.split(",")||["https://app.example.com"]:["*"];return f2({corsOrigins:t,enableLogging:!0,logLevel:e==="prod"?"info":"debug"})}var js=_.object({staff_id:_.string().uuid(),email:_.string().email().toLowerCase(),password_hash:_.string().min(1),roles:_.array(_.enum(["admin","manager","staff"])).min(1),enabled:_.boolean(),created_at:_.string().datetime(),updated_at:_.string().datetime()}),Wc=_.object({token_hash:_.string().min(1),staff_id:_.string().uuid(),expires_at:_.number().int().positive(),created_at:_.string().datetime(),used_at:_.string().datetime().optional()}),zc=_.object({tenant_id:_.string().uuid(),name:_.string().min(1).max(255),email:_.string().email().toLowerCase(),contact_info:_.object({phone:_.string().optional(),address:_.string().optional(),company:_.string().optional()}),status:_.enum(["pending","active","suspended"]),created_at:_.string().datetime(),updated_at:_.string().datetime()}),Rz=_.object({sub:_.string().uuid(),email:_.string().email(),roles:_.array(_.enum(["admin","manager","staff"])),iat:_.number().int().positive(),exp:_.number().int().positive(),iss:_.string().optional(),aud:_.string().optional()}),Kc=_.object({email:_.string().email().toLowerCase(),password:_.string().min(8).max(128),roles:_.array(_.enum(["admin","manager","staff"])).min(1)}),Iz=_.object({roles:_.array(_.enum(["admin","manager","staff"])).min(1).optional(),enabled:_.boolean().optional()}),qc=_.object({name:_.string().min(1).max(255),email:_.string().email().toLowerCase(),contact_info:_.object({phone:_.string().optional(),address:_.string().optional(),company:_.string().optional()}).optional().default({})}),Jc=_.object({email:_.string().email().toLowerCase(),password:_.string().min(1)}),Yc=_.object({email:_.string().email().toLowerCase()}),Xc=_.object({token:_.string().min(1),new_password:_.string().min(8).max(128)});Ze();var Qc="preferred",m2=["disabled","preferred","required"];function ea(e){return m2.includes(e)}var M0=e=>{let{accountIdEndpointMode:t}=e,r=de(t??Qc);return Object.assign(e,{accountIdEndpointMode:async()=>{let o=await r();if(!ea(o))throw new Error(`Invalid value for accountIdEndpointMode: ${o}. Valid values are: "required", "preferred", "disabled".`);return o}})};var L0="Invalid AccountIdEndpointMode value",U0=e=>{throw new Error(e)},h2="AWS_ACCOUNT_ID_ENDPOINT_MODE",g2="account_id_endpoint_mode",F0={environmentVariableSelector:e=>{let t=e[h2];return t&&!ea(t)&&U0(L0),t},configFileSelector:e=>{let t=e[g2];return t&&!ea(t)&&U0(L0),t},default:Qc};var B0=["AWS_ENABLE_ENDPOINT_DISCOVERY","AWS_ENDPOINT_DISCOVERY_ENABLED"],ff="endpoint_discovery_enabled",H0=e=>["false","0"].indexOf(e)>=0,V0={environmentVariableSelector:e=>{for(let t=0;t<B0.length;t++){let r=B0[t];if(r in e){let o=e[r];if(o==="")throw Error(`Environment variable ${r} can't be empty of undefined, got "${o}"`);return!H0(o)}}},configFileSelector:e=>{if(ff in e){let t=e[ff];if(t===void 0)throw Error(`Shared config entry ${ff} can't be undefined, got "${t}"`);return!H0(t)}},default:void 0};var dS=h$(cS()),Zc=class{cache;constructor(t){this.cache=new dS.default(t)}getEndpoint(t){let r=this.get(t);if(!r||r.length===0)return;let o=r.map(n=>n.Address);return o[Math.floor(Math.random()*o.length)]}get(t){if(!this.has(t))return;let r=this.cache.get(t);if(!r)return;let o=Date.now(),n=r.filter(s=>o<s.Expires);if(n.length===0){this.delete(t);return}return n}set(t,r){let o=Date.now();this.cache.set(t,r.map(({Address:n,CachePeriodInMinutes:s})=>({Address:n,Expires:o+s*60*1e3})))}delete(t){this.cache.set(t,[])}has(t){if(!this.cache.has(t))return!1;let r=this.cache.peek(t);return r?r.length>0:!1}clear(){this.cache.clear()}};var lS=(e,{endpointDiscoveryCommandCtor:t})=>{let{endpointCacheSize:r,endpointDiscoveryEnabled:o,endpointDiscoveryEnabledProvider:n}=e;return Object.assign(e,{endpointDiscoveryCommandCtor:t,endpointCache:new Zc(r??1e3),endpointDiscoveryEnabled:o!==void 0?()=>Promise.resolve(o):n,isClientEndpointDiscoveryEnabled:o!==void 0})};Xn();Qn();Zn();hn();ut();Fe();ae();ls();Te();Ut();N();Ne();Ze();var _v=async(e,t,r)=>({operation:ve(t).operation,region:await de(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function w4(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"dynamodb",region:e.region},propertiesExtractor:(t,r)=>({signingProperties:{config:t,context:r}})}}var bv=e=>{let t=[];switch(e.operation){default:t.push(w4(e))}return t},wv=e=>{let t=ur(e);return Object.assign(t,{authSchemePreference:de(e.authSchemePreference??[])})};Te();N();var Rv=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"dynamodb"}),vt={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},AccountId:{type:"builtInParams",name:"accountId"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"},AccountIdEndpointMode:{type:"builtInParams",name:"accountIdEndpointMode"}};ae();N();var G=class e extends wt{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}};var ml=class e extends G{name="BackupInUseException";$fault="client";constructor(t){super({name:"BackupInUseException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},hl=class e extends G{name="BackupNotFoundException";$fault="client";constructor(t){super({name:"BackupNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},gl=class e extends G{name="InternalServerError";$fault="server";constructor(t){super({name:"InternalServerError",$fault:"server",...t}),Object.setPrototypeOf(this,e.prototype)}},xl=class e extends G{name="RequestLimitExceeded";$fault="client";ThrottlingReasons;constructor(t){super({name:"RequestLimitExceeded",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ThrottlingReasons=t.ThrottlingReasons}},yl=class e extends G{name="ThrottlingException";$fault="client";throttlingReasons;constructor(t){super({name:"ThrottlingException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.throttlingReasons=t.throttlingReasons}},Sl=class e extends G{name="InvalidEndpointException";$fault="client";Message;constructor(t){super({name:"InvalidEndpointException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Message=t.Message}},El=class e extends G{name="ProvisionedThroughputExceededException";$fault="client";ThrottlingReasons;constructor(t){super({name:"ProvisionedThroughputExceededException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ThrottlingReasons=t.ThrottlingReasons}},_l=class e extends G{name="ResourceNotFoundException";$fault="client";constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},bl=class e extends G{name="ItemCollectionSizeLimitExceededException";$fault="client";constructor(t){super({name:"ItemCollectionSizeLimitExceededException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},wl=class e extends G{name="ReplicatedWriteConflictException";$fault="client";$retryable={};constructor(t){super({name:"ReplicatedWriteConflictException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Rl=class e extends G{name="ContinuousBackupsUnavailableException";$fault="client";constructor(t){super({name:"ContinuousBackupsUnavailableException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Il=class e extends G{name="LimitExceededException";$fault="client";constructor(t){super({name:"LimitExceededException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Tl=class e extends G{name="TableInUseException";$fault="client";constructor(t){super({name:"TableInUseException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},vl=class e extends G{name="TableNotFoundException";$fault="client";constructor(t){super({name:"TableNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Cl=class e extends G{name="GlobalTableAlreadyExistsException";$fault="client";constructor(t){super({name:"GlobalTableAlreadyExistsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Al=class e extends G{name="ResourceInUseException";$fault="client";constructor(t){super({name:"ResourceInUseException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Pl=class e extends G{name="TransactionConflictException";$fault="client";constructor(t){super({name:"TransactionConflictException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Dl=class e extends G{name="PolicyNotFoundException";$fault="client";constructor(t){super({name:"PolicyNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Nl=class e extends G{name="ExportNotFoundException";$fault="client";constructor(t){super({name:"ExportNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Ol=class e extends G{name="GlobalTableNotFoundException";$fault="client";constructor(t){super({name:"GlobalTableNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},kl=class e extends G{name="ImportNotFoundException";$fault="client";constructor(t){super({name:"ImportNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},$l=class e extends G{name="DuplicateItemException";$fault="client";constructor(t){super({name:"DuplicateItemException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Ml=class e extends G{name="IdempotentParameterMismatchException";$fault="client";Message;constructor(t){super({name:"IdempotentParameterMismatchException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Message=t.Message}},Ll=class e extends G{name="TransactionInProgressException";$fault="client";Message;constructor(t){super({name:"TransactionInProgressException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Message=t.Message}},Ul=class e extends G{name="ExportConflictException";$fault="client";constructor(t){super({name:"ExportConflictException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Fl=class e extends G{name="InvalidExportTimeException";$fault="client";constructor(t){super({name:"InvalidExportTimeException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Bl=class e extends G{name="PointInTimeRecoveryUnavailableException";$fault="client";constructor(t){super({name:"PointInTimeRecoveryUnavailableException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Hl=class e extends G{name="ImportConflictException";$fault="client";constructor(t){super({name:"ImportConflictException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Vl=class e extends G{name="TableAlreadyExistsException";$fault="client";constructor(t){super({name:"TableAlreadyExistsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Gl=class e extends G{name="InvalidRestoreTimeException";$fault="client";constructor(t){super({name:"InvalidRestoreTimeException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},jl=class e extends G{name="ReplicaAlreadyExistsException";$fault="client";constructor(t){super({name:"ReplicaAlreadyExistsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Wl=class e extends G{name="ReplicaNotFoundException";$fault="client";constructor(t){super({name:"ReplicaNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},zl=class e extends G{name="IndexNotFoundException";$fault="client";constructor(t){super({name:"IndexNotFoundException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Kl=class e extends G{name="ConditionalCheckFailedException";$fault="client";Item;constructor(t){super({name:"ConditionalCheckFailedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Item=t.Item}},ql=class e extends G{name="TransactionCanceledException";$fault="client";Message;CancellationReasons;constructor(t){super({name:"TransactionCanceledException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Message=t.Message,this.CancellationReasons=t.CancellationReasons}};var R4="Action";var I4="AttributeMap";var fh="AttributesToGet",Tv="AttributeUpdates",T4="AttributeValue",mh="AttributeValueList",v4="AttributeValueUpdate",C4="Address",hh="Attributes";var A4="BackupInUseException";var P4="BackupNotFoundException",D4="BOOL";var N4="BS";var O4="B",k4="Code";var $4="ContinuousBackupsUnavailableException",ps="ConsumedCapacity",M4="ConditionalCheckFailedException";var gh="ConditionExpression";var vv="ComparisonOperator",wa="ConditionalOperator";var L4="CachePeriodInMinutes",xh="ConsistentRead";var U4="CancellationReasonList",F4="ConfirmRemoveSelfResourceAccess";var B4="CancellationReason",H4="CancellationReasons";var Cv="CapacityUnits";var V4="Capacity",G4="Condition",Av="Count";var j4="DescribeEndpoints";var W4="DescribeEndpointsRequest",z4="DescribeEndpointsResponse";var K4="DeleteItem",q4="DuplicateItemException",J4="DeleteItemInput";var Y4="DeleteItemOutput";var X4="ExpectedAttributeMap",gi="ExpressionAttributeNames",Ra="ExpressionAttributeValues",Q4="ExpressionAttributeValueMap",Z4="ExpectedAttributeValue";var eU="ExportConflictException";var tU="ExportNotFoundException";var rU="ExpectedRevisionId";var Pv="ExclusiveStartKey";var Dv="Endpoints";var oU="Endpoint",yh="Expected",nU="Exists";var sU="FilterConditionMap";var Nv="FilterExpression";var iU="GetItem",aU="GetItemInput",cU="GetItemOutput";var dU="GlobalSecondaryIndexes";var lU="GlobalTableAlreadyExistsException";var pU="GlobalTableNotFoundException";var Jl="Item";var uU="ImportConflictException",fU="ItemCollectionKey",mU="ItemCollectionKeyAttributeMap",Yl="ItemCollectionMetrics";var hU="ItemCollectionSizeLimitExceededException";var gU="InvalidEndpointException";var xU="InvalidExportTimeException";var yU="ItemList",Ov="IndexName",SU="ImportNotFoundException",EU="IndexNotFoundException",_U="IdempotentParameterMismatchException";var bU="InvalidRestoreTimeException";var wU="InternalServerError";var kv="Items",Xl="Key";var $v="KeyConditions",RU="KeyConditionExpression";var Mv="Limit",IU="ListAttributeValue";var TU="LimitExceededException";var Lv="LastEvaluatedKey";var vU="LocalSecondaryIndexes";var CU="L",Ia="Message",AU="MapAttributeValue";var PU="M",DU="N";var NU="NS";var OU="NULL";var Sh="ProjectionExpression",kU="PutItem";var $U="PutItemInput",MU="PutItemInputAttributeMap",LU="PutItemOutput";var UU="PointInTimeRecoveryUnavailableException";var FU="PolicyNotFoundException";var BU="PutResourcePolicyInput";var HU="ProvisionedThroughputExceededException";var VU="Policy";var GU="Query",jU="QueryFilter",WU="QueryInput",zU="QueryOutput";var KU="ResourceArn",qU="ReplicaAlreadyExistsException";var xi="ReturnConsumedCapacity",Uv="ReadCapacityUnits";var Eh="ReturnItemCollectionMetrics";var JU="ResourceInUseException";var YU="RequestLimitExceeded";var XU="ReplicaNotFoundException",QU="ResourceNotFoundException";var _h="ReturnValues",bh="ReturnValuesOnConditionCheckFailure",ZU="ReplicatedWriteConflictException";var Fv="ScannedCount";var eF="SizeEstimateRangeGB",tF="ScanFilter",rF="ScanInput";var oF="SecondaryIndexesCapacityMap",nF="ScanIndexForward";var sF="ScanOutput";var iF="SS";var aF="S",cF="Scan",Bv="Select",dF="Segment";var lF="Table";var pF="TableAlreadyExistsException";var uF="TransactionCanceledException",fF="TransactionConflictException";var mF="ThrottlingException";var hF="TransactionInProgressException",gF="TableInUseException";var us="TableName",xF="TableNotFoundException";var Hv="ThrottlingReasons";var yF="ThrottlingReasonList";var SF="ThrottlingReason";var EF="TotalSegments";var _F="UpdateExpression";var bF="UpdateItemInput",wF="UpdateItemOutput",RF="UpdateItem";var Vv="Value",Gv="WriteCapacityUnits";var IF="awsQueryError",X="client",J="error",jv="httpError",TF="httpHeader",ce="message",vF="reason",CF="resource",AF="server",Wv="smithy.ts.sdk.synthetic.com.amazonaws.dynamodb",PF="throttlingReasons",DF="x-amz-confirm-remove-self-resource-access",y="com.amazonaws.dynamodb";var NF=[3,y,v4,0,[Vv,R4],[()=>uo,0]];var OF=[-3,y,A4,{[J]:X},[ce],[0]];S.for(y).registerError(OF,ml);var kF=[-3,y,P4,{[J]:X},[ce],[0]];S.for(y).registerError(kF,hl);var $F=[3,y,B4,0,[Jl,k4,Ia],[()=>fs,0,0]],zv=[3,y,V4,0,[Uv,Gv,Cv],[1,1,1]],Kv=[3,y,G4,0,[mh,vv],[()=>qv,0]],MF=[-3,y,M4,{[J]:X},[ce,Jl],[0,()=>fs]];S.for(y).registerError(MF,Kl);var yi=[3,y,ps,0,[us,Cv,Uv,Gv,lF,vU,dU],[0,1,1,1,()=>zv,()=>Iv,()=>Iv]];var LF=[-3,y,$4,{[J]:X},[ce],[0]];S.for(y).registerError(LF,Rl);var UF=[3,y,J4,0,[us,Xl,yh,wa,_h,xi,Eh,gh,gi,Ra,bh],[0,()=>ms,()=>Ih,0,0,0,0,0,128,()=>Ta,0]],FF=[3,y,Y4,0,[hh,ps,Yl],[()=>fs,()=>yi,()=>wh]];var BF=[3,y,W4,0,[],[]],HF=[3,y,z4,0,[Dv],[()=>k6]];var VF=[-3,y,q4,{[J]:X},[ce],[0]];S.for(y).registerError(VF,$l);var GF=[3,y,oU,0,[C4,L4],[0,1]];var jF=[3,y,Z4,0,[Vv,nU,vv,mh],[()=>uo,2,0,()=>qv]],WF=[-3,y,eU,{[J]:X},[ce],[0]];S.for(y).registerError(WF,Ul);var zF=[-3,y,tU,{[J]:X},[ce],[0]];S.for(y).registerError(zF,Nl);var KF=[3,y,aU,0,[us,Xl,fh,xh,xi,Sh,gi],[0,()=>ms,64,2,0,0,128]],qF=[3,y,cU,0,[Jl,ps],[()=>fs,()=>yi]];var JF=[-3,y,lU,{[J]:X},[ce],[0]];S.for(y).registerError(JF,Cl);var YF=[-3,y,pU,{[J]:X},[ce],[0]];S.for(y).registerError(YF,Ol);var XF=[-3,y,_U,{[J]:X},[Ia],[0]];S.for(y).registerError(XF,Ml);var QF=[-3,y,uU,{[J]:X},[ce],[0]];S.for(y).registerError(QF,Hl);var ZF=[-3,y,SU,{[J]:X},[ce],[0]];S.for(y).registerError(ZF,kl);var e6=[-3,y,EU,{[J]:X},[ce],[0]];S.for(y).registerError(e6,zl);var t6=[-3,y,wU,{[J]:AF},[ce],[0]];S.for(y).registerError(t6,gl);var r6=[-3,y,gU,{[J]:X,[jv]:421},[Ia],[0]];S.for(y).registerError(r6,Sl);var o6=[-3,y,xU,{[J]:X},[ce],[0]];S.for(y).registerError(o6,Fl);var n6=[-3,y,bU,{[J]:X},[ce],[0]];S.for(y).registerError(n6,Gl);var wh=[3,y,Yl,0,[fU,eF],[()=>L6,65]],s6=[-3,y,hU,{[J]:X},[ce],[0]];S.for(y).registerError(s6,bl);var i6=[-3,y,TU,{[J]:X},[ce],[0]];S.for(y).registerError(i6,Il);var a6=[-3,y,UU,{[J]:X},[ce],[0]];S.for(y).registerError(a6,Bl);var c6=[-3,y,FU,{[J]:X},[ce],[0]];S.for(y).registerError(c6,Dl);var d6=[-3,y,HU,{[J]:X},[ce,Hv],[0,()=>Rh]];S.for(y).registerError(d6,El);var l6=[3,y,$U,0,[us,Jl,yh,_h,xi,Eh,wa,gh,gi,Ra,bh],[0,()=>B6,()=>Ih,0,0,0,0,0,128,()=>Ta,0]],p6=[3,y,LU,0,[hh,ps,Yl],[()=>fs,()=>yi,()=>wh]];var Zue=[3,y,BU,0,[KU,VU,rU,F4],[0,0,0,[2,{[TF]:DF}]]];var u6=[3,y,WU,0,[us,Ov,Bv,fh,Mv,xh,$v,jU,wa,nF,Pv,xi,Sh,Nv,RU,gi,Ra],[0,0,0,64,1,2,()=>U6,()=>Yv,0,2,()=>ms,0,0,0,0,128,()=>Ta]],f6=[3,y,zU,0,[kv,Av,Fv,Lv,ps],[()=>Jv,1,1,()=>ms,()=>yi]];var m6=[-3,y,qU,{[J]:X},[ce],[0]];S.for(y).registerError(m6,jl);var h6=[-3,y,XU,{[J]:X},[ce],[0]];S.for(y).registerError(h6,Wl);var g6=[-3,y,ZU,{[J]:X},[ce],[0]];S.for(y).registerError(g6,wl);var x6=[-3,y,YU,{[J]:X},[ce,Hv],[0,()=>Rh]];S.for(y).registerError(x6,xl);var y6=[-3,y,JU,{[J]:X},[ce],[0]];S.for(y).registerError(y6,Al);var S6=[-3,y,QU,{[J]:X},[ce],[0]];S.for(y).registerError(S6,_l);var E6=[3,y,rF,0,[us,Ov,fh,Mv,Bv,tF,wa,Pv,xi,EF,dF,Sh,Nv,gi,Ra,xh],[0,0,64,1,0,()=>Yv,0,()=>ms,0,1,1,0,0,128,()=>Ta,2]],_6=[3,y,sF,0,[kv,Av,Fv,Lv,ps],[()=>Jv,1,1,()=>ms,()=>yi]];var b6=[-3,y,pF,{[J]:X},[ce],[0]];S.for(y).registerError(b6,Vl);var w6=[-3,y,gF,{[J]:X},[ce],[0]];S.for(y).registerError(w6,Tl);var R6=[-3,y,xF,{[J]:X},[ce],[0]];S.for(y).registerError(R6,vl);var I6=[-3,y,mF,{[IF]:["Throttling",400],[J]:X,[jv]:400},[ce,PF],[0,()=>Rh]];S.for(y).registerError(I6,yl);var T6=[3,y,SF,0,[vF,CF],[0,0]];var v6=[-3,y,uF,{[J]:X},[Ia,H4],[0,()=>O6]];S.for(y).registerError(v6,ql);var C6=[-3,y,fF,{[J]:X},[ce],[0]];S.for(y).registerError(C6,Pl);var A6=[-3,y,hF,{[J]:X},[Ia],[0]];S.for(y).registerError(A6,Ll);var P6=[3,y,bF,0,[us,Xl,Tv,yh,wa,_h,xi,Eh,_F,gh,gi,Ra,bh],[0,()=>ms,()=>M6,()=>Ih,0,0,0,0,0,0,128,()=>Ta,0]],D6=[3,y,wF,0,[hh,ps,Yl],[()=>fs,()=>yi,()=>wh]];var N6=[-3,Wv,"DynamoDBServiceException",0,[],[]];S.for(Wv).registerError(N6,G);var qv=[1,y,mh,0,()=>uo];var O6=[1,y,U4,0,()=>$F];var k6=[1,y,Dv,0,()=>GF];var Jv=[1,y,yU,0,()=>fs];var $6=[1,y,IU,0,()=>uo];var Rh=[1,y,yF,0,()=>T6];var fs=[2,y,I4,0,0,()=>uo],M6=[2,y,Tv,0,0,()=>NF];var Ih=[2,y,X4,0,0,()=>jF];var Ta=[2,y,Q4,0,0,()=>uo],Yv=[2,y,sU,0,0,()=>Kv],L6=[2,y,mU,0,0,()=>uo];var ms=[2,y,Xl,0,0,()=>uo],U6=[2,y,$v,0,0,()=>Kv],F6=[2,y,AU,0,0,()=>uo],B6=[2,y,MU,0,0,()=>uo],Iv=[2,y,oF,0,0,()=>zv],uo=[4,y,T4,0,[aF,DU,O4,iF,NU,N4,PU,CU,OU,D4],[0,0,21,64,64,85,()=>F6,()=>$6,2,2]];var Xv=[9,y,K4,0,()=>UF,()=>FF];var Qv=[9,y,j4,0,()=>BF,()=>HF];var Zv=[9,y,iU,0,()=>KF,()=>qF];var eC=[9,y,kU,0,()=>l6,()=>p6];var tC=[9,y,GU,0,()=>u6,()=>f6];var rC=[9,y,cF,0,()=>E6,()=>_6];var oC=[9,y,RF,0,()=>P6,()=>D6];var Ql=class extends V.classBuilder().ep(vt).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("DynamoDB_20120810","DescribeEndpoints",{}).n("DynamoDBClient","DescribeEndpointsCommand").sc(Qv).build(){};var nC={name:"@aws-sdk/client-dynamodb",description:"AWS SDK for JavaScript Dynamodb Client for Node.js, Browser and React Native",version:"3.958.0",scripts:{build:"concurrently 'yarn:build:types' 'yarn:build:es' && yarn build:cjs","build:cjs":"node ../../scripts/compilation/inline client-dynamodb","build:es":"tsc -p tsconfig.es.json","build:include:deps":'yarn g:turbo run build -F="$npm_package_name"',"build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo dynamodb","test:e2e":"yarn g:vitest run -c vitest.config.e2e.mts","test:e2e:watch":"yarn g:vitest watch -c vitest.config.e2e.mts","test:index":"tsc --noEmit ./test/index-types.ts && node ./test/index-objects.spec.mjs"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.957.0","@aws-sdk/credential-provider-node":"3.958.0","@aws-sdk/dynamodb-codec":"3.957.0","@aws-sdk/middleware-endpoint-discovery":"3.957.0","@aws-sdk/middleware-host-header":"3.957.0","@aws-sdk/middleware-logger":"3.957.0","@aws-sdk/middleware-recursion-detection":"3.957.0","@aws-sdk/middleware-user-agent":"3.957.0","@aws-sdk/region-config-resolver":"3.957.0","@aws-sdk/types":"3.957.0","@aws-sdk/util-endpoints":"3.957.0","@aws-sdk/util-user-agent-browser":"3.957.0","@aws-sdk/util-user-agent-node":"3.957.0","@smithy/config-resolver":"^4.4.5","@smithy/core":"^3.20.0","@smithy/fetch-http-handler":"^5.3.8","@smithy/hash-node":"^4.2.7","@smithy/invalid-dependency":"^4.2.7","@smithy/middleware-content-length":"^4.2.7","@smithy/middleware-endpoint":"^4.4.1","@smithy/middleware-retry":"^4.4.17","@smithy/middleware-serde":"^4.2.8","@smithy/middleware-stack":"^4.2.7","@smithy/node-config-provider":"^4.3.7","@smithy/node-http-handler":"^4.4.7","@smithy/protocol-http":"^5.3.7","@smithy/smithy-client":"^4.10.2","@smithy/types":"^4.11.0","@smithy/url-parser":"^4.2.7","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.16","@smithy/util-defaults-mode-node":"^4.2.19","@smithy/util-endpoints":"^3.2.7","@smithy/util-middleware":"^4.2.7","@smithy/util-retry":"^4.2.7","@smithy/util-utf8":"^4.2.0","@smithy/util-waiter":"^4.2.7",tslib:"^2.6.2"},devDependencies:{"@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-dynamodb",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-dynamodb"}};Ne();vh();fe();ft();fe();var kC="AWS_EC2_METADATA_DISABLED",$C=async e=>{let{ENV_CMDS_FULL_URI:t,ENV_CMDS_RELATIVE_URI:r,fromContainerMetadata:o,fromInstanceMetadata:n}=await Promise.resolve().then(()=>(Pa(),Aa));if(process.env[r]||process.env[t]){e.logger?.debug("@aws-sdk/credential-provider-node - remoteProvider::fromHttp/fromContainerMetadata");let{fromHttp:s}=await Promise.resolve().then(()=>(Lh(),Mh));return ni(s(e),o(e))}return process.env[kC]&&process.env[kC]!=="false"?async()=>{throw new v("EC2 Instance Metadata Service access disabled",{logger:e.logger})}:(e.logger?.debug("@aws-sdk/credential-provider-node - remoteProvider::fromInstanceMetadata"),n(e))};function MC(e,t){let r=SB(e),o,n,s,i=async a=>{if(a?.forceRefresh)return await r(a);if(s?.expiration&&s?.expiration?.getTime()<Date.now()&&(s=void 0),o)await o;else if(!s||t?.(s))if(s)n||(n=r(a).then(c=>{s=c,n=void 0}));else return o=r(a).then(c=>{s=c,o=void 0}),i(a);return s};return i}var SB=e=>async t=>{let r;for(let o of e)try{return await o(t)}catch(n){if(r=n,n?.tryNextLink)continue;throw n}throw r};var _k=!1,Kp=(e={})=>MC([async()=>{if(e.profile??process.env[eh])throw process.env[Zl]&&process.env[ep]&&(_k||((e.logger?.warn&&e.logger?.constructor?.name!=="NoOpLogger"?e.logger.warn.bind(e.logger):console.warn)(`@aws-sdk/credential-provider-node - defaultProvider::fromEnv WARNING:
    Multiple credential sources detected: 
    Both AWS_PROFILE and the pair AWS_ACCESS_KEY_ID/AWS_SECRET_ACCESS_KEY static credentials are set.
    This SDK will proceed with the AWS_PROFILE value.
    
    However, a future version may change this behavior to prefer the ENV static credentials.
    Please ensure that your environment only sets either the AWS_PROFILE or the
    AWS_ACCESS_KEY_ID/AWS_SECRET_ACCESS_KEY pair.
`),_k=!0)),new v("AWS_PROFILE is set, skipping fromEnv provider.",{logger:e.logger,tryNextLink:!0});return e.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromEnv"),Th(e)()},async t=>{e.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromSSO");let{ssoStartUrl:r,ssoAccountId:o,ssoRegion:n,ssoRoleName:s,ssoSession:i}=e;if(!r&&!o&&!n&&!s&&!i)throw new v("Skipping SSO provider in default chain (inputs do not include SSO fields).",{logger:e.logger});let{fromSSO:a}=await Promise.resolve().then(()=>(ug(),pg));return a(e)(t)},async t=>{e.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromIni");let{fromIni:r}=await Promise.resolve().then(()=>(Ek(),Sk));return r(e)(t)},async t=>{e.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromProcess");let{fromProcess:r}=await Promise.resolve().then(()=>(Vg(),Hg));return r(e)(t)},async t=>{e.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::fromTokenFile");let{fromTokenFile:r}=await Promise.resolve().then(()=>(qg(),Kg));return r(e)(t)},async()=>(e.logger?.debug("@aws-sdk/credential-provider-node - defaultProvider::remoteProvider"),(await $C(e))()),async()=>{throw new v("Could not load credentials from any providers",{tryNextLink:!1,logger:e.logger})}],EH);var EH=e=>e?.expiration!==void 0&&e.expiration.getTime()-Date.now()<3e5;gs();ut();xs();Ut();wr();ko();N();ys();Ss();Go();Ne();Ho();Ho();ae();N();et();var qp=class extends un{constructor(){super({timestampFormat:{useTrait:!0,default:7},jsonName:!1})}createSerializer(){let t=new Yg(this.settings);return t.setSerdeContext(this.serdeContext),t}createDeserializer(){let t=new Xg(this.settings);return t.setSerdeContext(this.serdeContext),t}},bk="com.amazonaws.dynamodb#AttributeValue",Yg=class extends di{_write(t,r,o){let n=M.of(t);if(n.isStructSchema()&&n.getName(!0)===bk&&r&&typeof r=="object"){let s=r,i=ua(s),a=this.serdeContext?.base64Encoder??Ee;if(s.B instanceof Uint8Array&&(i.B=a(s.B)),Array.isArray(s.BS)&&(i.BS=s.BS.map(a)),Array.isArray(s.L)&&(i.L=s.L.filter(c=>c!=null).map(c=>this._write(n,c,o))),s.M&&typeof s.M=="object"){i.M={};for(let[c,l]of Object.entries(s.M))l!=null&&(i.M[c]=this._write(n,l,o))}return i}return super._write(n,r,o)}},Xg=class extends ci{_read(t,r){let o=M.of(t);if(o.isStructSchema()&&o.getName(!0)===bk&&r&&typeof r=="object"){let n=r,s=ua(n),i=this.serdeContext?.base64Decoder??Ie;if(typeof n.B=="string"&&(s.B=i(n.B)),Array.isArray(n.BS)&&(s.BS=n.BS.map(i)),Array.isArray(n.L)&&(s.L=n.L.map(a=>this._read(o,a))),n.M&&typeof n.M=="object"){s.M={};for(let[a,c]of Object.entries(n.M))s.M[a]=this._read(o,c)}return s}return super._read(o,r)}};N();Bo();et();Ae();an();Wr();var ex="required",U="type",Oe="rules",me="conditions",O="fn",k="argv",K="ref",Jp="assign",xo="url",yo="properties",So="headers",jk="metricValues";var ke="error",dt="stringEquals",wk="https://dynamodb.{Region}.{PartitionResult#dualStackDnsSuffix}",Pt="endpoint",Ue="tree",tx="dynamodb",dc={[ex]:!1,[U]:"string"},Rk={[ex]:!0,default:!1,[U]:"boolean"},Ik={[O]:"isSet",[k]:[{[K]:"Endpoint"}]},_H={[K]:"Endpoint"},Tk={[O]:"isSet",[k]:[{[K]:"Region"}]},Wk={[K]:"Region"},vk={[O]:"aws.partition",[k]:[Wk],[Jp]:"PartitionResult"},Ck={[me]:[{[O]:"booleanEquals",[k]:[{[K]:"UseFIPS"},!0]}],[ke]:"Invalid Configuration: FIPS and custom endpoint are not supported",[U]:ke},ki={[O]:"booleanEquals",[k]:[{[K]:"UseFIPS"},!0]},Ak={[me]:[{[O]:"booleanEquals",[k]:[{[K]:"UseDualStack"},!0]}],[ke]:"Invalid Configuration: Dualstack and custom endpoint are not supported",[U]:ke},zk={[O]:"booleanEquals",[k]:[{[K]:"UseDualStack"},!0]},Pk={[Pt]:{[xo]:"{Endpoint}",[yo]:{},[So]:{}},[U]:Pt},qo={},Dk={[O]:"booleanEquals",[k]:[{[O]:"getAttr",[k]:[{[K]:"PartitionResult"},"supportsFIPS"]},!0]},Nk={[O]:"booleanEquals",[k]:[{[O]:"getAttr",[k]:[{[K]:"PartitionResult"},"supportsDualStack"]},!0]},Qg={[me]:[{[O]:"isSet",[k]:[{[K]:"AccountIdEndpointMode"}]},{[O]:dt,[k]:[{[K]:"AccountIdEndpointMode"},"required"]}],[Oe]:[{[ke]:"Invalid Configuration: AccountIdEndpointMode is required and FIPS is enabled, but FIPS account endpoints are not supported",[U]:ke}],[U]:Ue},lc={[O]:"getAttr",[k]:[{[K]:"PartitionResult"},"name"]},Ok={[Pt]:{[xo]:"https://dynamodb.{Region}.{PartitionResult#dnsSuffix}",[yo]:{},[So]:{}},[U]:Pt},kk={[xo]:"https://{ParsedArn#accountId}.ddb.{Region}.{PartitionResult#dualStackDnsSuffix}",[yo]:{[jk]:["O"]},[So]:{}},Zg={[jk]:["O"]},$k={[ke]:"Credentials-sourced account ID parameter is invalid",[U]:ke},Mk={[me]:[{[O]:"isSet",[k]:[{[K]:"AccountIdEndpointMode"}]},{[O]:dt,[k]:[{[K]:"AccountIdEndpointMode"},"required"]}],[Oe]:[{[me]:[{[O]:"not",[k]:[ki]}],[Oe]:[{[me]:[{[O]:dt,[k]:[lc,"aws"]}],[Oe]:[{[ke]:"AccountIdEndpointMode is required but no AccountID was provided or able to be loaded",[U]:ke}],[U]:Ue},{[ke]:"Invalid Configuration: AccountIdEndpointMode is required but account endpoints are not supported in this partition",[U]:ke}],[U]:Ue},{[ke]:"Invalid Configuration: AccountIdEndpointMode is required and FIPS is enabled, but FIPS account endpoints are not supported",[U]:ke}],[U]:Ue},Lk={[xo]:"https://{ParsedArn#accountId}.ddb.{Region}.{PartitionResult#dnsSuffix}",[yo]:Zg,[So]:{}},Uk=[ki],Fk=[zk],Bk=[{[O]:"isSet",[k]:[{[K]:"AccountIdEndpointMode"}]},{[O]:"not",[k]:[{[O]:dt,[k]:[{[K]:"AccountIdEndpointMode"},"disabled"]}]},{[O]:dt,[k]:[lc,"aws"]},{[O]:"not",[k]:[ki]},{[O]:"isSet",[k]:[{[K]:"ResourceArn"}]},{[O]:"aws.parseArn",[k]:[{[K]:"ResourceArn"}],[Jp]:"ParsedArn"},{[O]:dt,[k]:[{[O]:"getAttr",[k]:[{[K]:"ParsedArn"},"service"]},tx]},{[O]:"isValidHostLabel",[k]:[{[O]:"getAttr",[k]:[{[K]:"ParsedArn"},"region"]},!1]},{[O]:dt,[k]:[{[O]:"getAttr",[k]:[{[K]:"ParsedArn"},"region"]},"{Region}"]},{[O]:"isValidHostLabel",[k]:[{[O]:"getAttr",[k]:[{[K]:"ParsedArn"},"accountId"]},!1]}],Hk=[{[O]:"isSet",[k]:[{[K]:"AccountIdEndpointMode"}]},{[O]:"not",[k]:[{[O]:dt,[k]:[{[K]:"AccountIdEndpointMode"},"disabled"]}]},{[O]:dt,[k]:[lc,"aws"]},{[O]:"not",[k]:[ki]},{[O]:"isSet",[k]:[{[K]:"ResourceArnList"}]},{[O]:"getAttr",[k]:[{[K]:"ResourceArnList"},"[0]"],[Jp]:"FirstArn"},{[O]:"aws.parseArn",[k]:[{[K]:"FirstArn"}],[Jp]:"ParsedArn"},{[O]:dt,[k]:[{[O]:"getAttr",[k]:[{[K]:"ParsedArn"},"service"]},tx]},{[O]:"isValidHostLabel",[k]:[{[O]:"getAttr",[k]:[{[K]:"ParsedArn"},"region"]},!1]},{[O]:dt,[k]:[{[O]:"getAttr",[k]:[{[K]:"ParsedArn"},"region"]},"{Region}"]},{[O]:"isValidHostLabel",[k]:[{[O]:"getAttr",[k]:[{[K]:"ParsedArn"},"accountId"]},!1]}],Vk=[{[O]:"isSet",[k]:[{[K]:"AccountIdEndpointMode"}]},{[O]:"not",[k]:[{[O]:dt,[k]:[{[K]:"AccountIdEndpointMode"},"disabled"]}]},{[O]:dt,[k]:[lc,"aws"]},{[O]:"not",[k]:[ki]},{[O]:"isSet",[k]:[{[K]:"AccountId"}]}],Gk=[{[O]:"isValidHostLabel",[k]:[{[K]:"AccountId"},!1]}],bH={version:"1.0",parameters:{Region:dc,UseDualStack:Rk,UseFIPS:Rk,Endpoint:dc,AccountId:dc,AccountIdEndpointMode:dc,ResourceArn:dc,ResourceArnList:{[ex]:!1,[U]:"stringArray"}},[Oe]:[{[me]:[Ik,Tk,vk],[Oe]:[Ck,Ak,{[me]:[{[O]:dt,[k]:[_H,wk]}],error:"Endpoint override is not supported for dual-stack endpoints. Please enable dual-stack functionality by enabling the configuration. For more details, see: https://docs.aws.amazon.com/sdkref/latest/guide/feature-endpoints.html",[U]:ke},Pk],[U]:Ue},{[me]:[Ik],[Oe]:[Ck,Ak,Pk],[U]:Ue},{[me]:[Tk],[Oe]:[{[me]:[vk],[Oe]:[{[me]:[{[O]:dt,[k]:[Wk,"local"]}],[Oe]:[{[me]:Uk,error:"Invalid Configuration: FIPS and local endpoint are not supported",[U]:ke},{[me]:Fk,error:"Invalid Configuration: Dualstack and local endpoint are not supported",[U]:ke},{endpoint:{[xo]:"http://localhost:8000",[yo]:{authSchemes:[{name:"sigv4",signingName:tx,signingRegion:"us-east-1"}]},[So]:qo},[U]:Pt}],[U]:Ue},{[me]:[ki,zk],[Oe]:[{[me]:[Dk,Nk],[Oe]:[Qg,{endpoint:{[xo]:"https://dynamodb-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",[yo]:qo,[So]:qo},[U]:Pt}],[U]:Ue},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[U]:ke}],[U]:Ue},{[me]:Uk,[Oe]:[{[me]:[Dk],[Oe]:[{[me]:[{[O]:dt,[k]:[lc,"aws-us-gov"]}],[Oe]:[Qg,Ok],[U]:Ue},Qg,{endpoint:{[xo]:"https://dynamodb-fips.{Region}.{PartitionResult#dnsSuffix}",[yo]:qo,[So]:qo},[U]:Pt}],[U]:Ue},{error:"FIPS is enabled but this partition does not support FIPS",[U]:ke}],[U]:Ue},{[me]:Fk,[Oe]:[{[me]:[Nk],[Oe]:[{[me]:Bk,endpoint:kk,[U]:Pt},{[me]:Hk,endpoint:kk,[U]:Pt},{[me]:Vk,[Oe]:[{[me]:Gk,[Oe]:[{endpoint:{[xo]:"https://{AccountId}.ddb.{Region}.{PartitionResult#dualStackDnsSuffix}",[yo]:Zg,[So]:qo},[U]:Pt}],[U]:Ue},$k],[U]:Ue},Mk,{endpoint:{[xo]:wk,[yo]:qo,[So]:qo},[U]:Pt}],[U]:Ue},{error:"DualStack is enabled but this partition does not support DualStack",[U]:ke}],[U]:Ue},{[me]:Bk,endpoint:Lk,[U]:Pt},{[me]:Hk,endpoint:Lk,[U]:Pt},{[me]:Vk,[Oe]:[{[me]:Gk,[Oe]:[{endpoint:{[xo]:"https://{AccountId}.ddb.{Region}.{PartitionResult#dnsSuffix}",[yo]:Zg,[So]:qo},[U]:Pt}],[U]:Ue},$k],[U]:Ue},Mk,Ok],[U]:Ue}],[U]:Ue},{error:"Invalid Configuration: Missing Region",[U]:ke}]},Kk=bH;var wH=new bt({size:50,params:["AccountId","AccountIdEndpointMode","Endpoint","Region","ResourceArn","ResourceArnList","UseDualStack","UseFIPS"]}),qk=(e,t={})=>wH.get(e,()=>ar(Kk,{endpointParams:e,logger:t.logger}));ze.aws=kt;var Jk=e=>({apiVersion:"2012-08-10",base64Decoder:e?.base64Decoder??Ie,base64Encoder:e?.base64Encoder??Ee,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??qk,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??bv,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new qe}],logger:e?.logger??new ot,protocol:e?.protocol??Hd,protocolSettings:e?.protocolSettings??{defaultNamespace:"com.amazonaws.dynamodb",xmlNamespace:"http://dynamodb.amazonaws.com/doc/2012-08-10/",version:"2012-08-10",serviceTarget:"DynamoDB_20120810",jsonCodec:new qp},serviceId:e?.serviceId??"DynamoDB",urlParser:e?.urlParser??Ve,utf8Decoder:e?.utf8Decoder??_e,utf8Encoder:e?.utf8Encoder??Se});var Yk=e=>{mr(process.version);let t=Nr(e),r=()=>t().then(fr),o=Jk(e);cr(process.version);let n={profile:e?.profile,logger:o.logger};return{...o,...e,runtime:"node",defaultsMode:t,accountIdEndpointMode:e?.accountIdEndpointMode??P(F0,n),authSchemePreference:e?.authSchemePreference??P(dr,n),bodyLengthChecker:e?.bodyLengthChecker??Dr,credentialDefaultProvider:e?.credentialDefaultProvider??Kp,defaultUserAgentProvider:e?.defaultUserAgentProvider??Ar({serviceId:o.serviceId,clientVersion:nC.version}),endpointDiscoveryEnabledProvider:e?.endpointDiscoveryEnabledProvider??P(V0,n),maxAttempts:e?.maxAttempts??P(Ir,e),region:e?.region??P(nt,{...Rt,...n}),requestHandler:tt.create(e?.requestHandler??r),retryMode:e?.retryMode??P({...vr,default:async()=>(await r()).retryMode||Tt},e),sha256:e?.sha256??Ct.bind(null,"sha256"),streamCollector:e?.streamCollector??xt,useDualstackEndpoint:e?.useDualstackEndpoint??P(Sr,n),useFipsEndpoint:e?.useFipsEndpoint??P(Er,n),userAgentAppId:e?.userAgentAppId??P(Pr,n)}};_n();we();N();var Xk=e=>{let t=e.httpAuthSchemes,r=e.httpAuthSchemeProvider,o=e.credentials;return{setHttpAuthScheme(n){let s=t.findIndex(i=>i.schemeId===n.schemeId);s===-1?t.push(n):t.splice(s,1,n)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(n){r=n},httpAuthSchemeProvider(){return r},setCredentials(n){o=n},credentials(){return o}}},Qk=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()});var Zk=(e,t)=>{let r=Object.assign(Mr(e),hr(e),Kt(e),Xk(e));return t.forEach(o=>o.configure(r)),Object.assign(e,Lr(r),gr(r),qt(r),Qk(r))};var Yp=class extends Be{config;constructor(...[t]){let r=Yk(t||{});super(r),this.initConfig=r;let o=Rv(r),n=M0(o),s=nr(n),i=Tr(s),a=_r(i),c=a,l=Rr(c),p=wv(l),u=lS(p,{endpointDiscoveryCommandCtor:Ql}),f=Zk(u,t?.extensions||[]);this.config=f,this.middlewareStack.use(tr(this.config)),this.middlewareStack.use(yr(this.config)),this.middlewareStack.use(Cr(this.config)),this.middlewareStack.use(br(this.config)),this.middlewareStack.use(Yt(this.config)),this.middlewareStack.use(Xt(this.config)),this.middlewareStack.use(Qt(this.config)),this.middlewareStack.use(Zt(this.config,{httpAuthSchemeParametersProvider:_v,identityProviderConfigProvider:async m=>new _t({"aws.auth#sigv4":m.credentials})})),this.middlewareStack.use(er(this.config))}destroy(){super.destroy()}};Te();N();var Xp=class extends V.classBuilder().ep({...vt,ResourceArn:{type:"contextParams",name:"TableName"}}).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("DynamoDB_20120810","DeleteItem",{}).n("DynamoDBClient","DeleteItemCommand").sc(Xv).build(){};Te();N();var Qp=class extends V.classBuilder().ep({...vt,ResourceArn:{type:"contextParams",name:"TableName"}}).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("DynamoDB_20120810","GetItem",{}).n("DynamoDBClient","GetItemCommand").sc(Zv).build(){};Te();N();var Zp=class extends V.classBuilder().ep({...vt,ResourceArn:{type:"contextParams",name:"TableName"}}).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("DynamoDB_20120810","PutItem",{}).n("DynamoDBClient","PutItemCommand").sc(eC).build(){};Te();N();var eu=class extends V.classBuilder().ep({...vt,ResourceArn:{type:"contextParams",name:"TableName"}}).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("DynamoDB_20120810","Query",{}).n("DynamoDBClient","QueryCommand").sc(tC).build(){};Te();N();var tu=class extends V.classBuilder().ep({...vt,ResourceArn:{type:"contextParams",name:"TableName"}}).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("DynamoDB_20120810","Scan",{}).n("DynamoDBClient","ScanCommand").sc(rC).build(){};Te();N();var ru=class extends V.classBuilder().ep({...vt,ResourceArn:{type:"contextParams",name:"TableName"}}).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("DynamoDB_20120810","UpdateItem",{}).n("DynamoDBClient","UpdateItemCommand").sc(oC).build(){};Ne();N();var As=class e{value;constructor(t){typeof t=="object"&&"N"in t?this.value=String(t.N):this.value=String(t);let r=typeof t.valueOf()=="number"?t.valueOf():0;if(r>Number.MAX_SAFE_INTEGER||r<Number.MIN_SAFE_INTEGER||Math.abs(r)===1/0||Number.isNaN(r))throw new Error(`NumberValue should not be initialized with an imprecise number=${r}. Use a string instead.`)}static from(t){return new e(t)}toAttributeValue(){return{N:this.toString()}}toBigInt(){let t=this.toString();return BigInt(t)}toString(){return String(this.value)}valueOf(){return this.toString()}};var pc=(e,t)=>{if(e===void 0)throw new Error("Pass options.removeUndefinedValues=true to remove undefined values from map/array/set.");if(e===null&&typeof e=="object")return ou();if(Array.isArray(e))return RH(e,t);if(e?.constructor?.name==="Set")return IH(e,t);if(e?.constructor?.name==="Map")return TH(e,t);if(e?.constructor?.name==="Object"||!e.constructor&&typeof e=="object")return e1(e,t);if(i1(e))return e.length===0&&t?.convertEmptyValues?ou():r1(e);if(typeof e=="boolean"||e?.constructor?.name==="Boolean")return{BOOL:e.valueOf()};if(typeof e=="number"||e?.constructor?.name==="Number")return s1(e,t);if(e instanceof As)return e.toAttributeValue();if(typeof e=="bigint")return n1(e);if(typeof e=="string"||e?.constructor?.name==="String")return e.length===0&&t?.convertEmptyValues?ou():o1(e);if(t?.convertClassInstanceToMap&&typeof e=="object")return e1(e,t);throw new Error(`Unsupported type passed: ${e}. Pass options.convertClassInstanceToMap=true to marshall typeof object as map attribute.`)},RH=(e,t)=>({L:e.filter(r=>typeof r!="function"&&(!t?.removeUndefinedValues||t?.removeUndefinedValues&&r!==void 0)).map(r=>pc(r,t))}),IH=(e,t)=>{let r=t?.removeUndefinedValues?new Set([...e].filter(n=>n!==void 0)):e;if(!t?.removeUndefinedValues&&r.has(void 0))throw new Error("Pass options.removeUndefinedValues=true to remove undefined values from map/array/set.");if(r.size===0){if(t?.convertEmptyValues)return ou();throw new Error("Pass a non-empty set, or options.convertEmptyValues=true.")}let o=r.values().next().value;if(o instanceof As)return{NS:Array.from(r).map(n=>n.toString())};if(typeof o=="number")return{NS:Array.from(r).map(n=>s1(n,t)).map(n=>n.N)};if(typeof o=="bigint")return{NS:Array.from(r).map(n1).map(n=>n.N)};if(typeof o=="string")return{SS:Array.from(r).map(o1).map(n=>n.S)};if(i1(o))return{BS:Array.from(r).map(r1).map(n=>n.B)};throw new Error("Only Number Set (NS), Binary Set (BS) or String Set (SS) are allowed.")},TH=(e,t)=>({M:(r=>{let o={};for(let[n,s]of r)typeof s!="function"&&(s!==void 0||!t?.removeUndefinedValues)&&(o[n]=pc(s,t));return o})(e)}),e1=(e,t)=>({M:(r=>{let o={};for(let n in r){let s=r[n];typeof s!="function"&&(s!==void 0||!t?.removeUndefinedValues)&&(o[n]=pc(s,t))}return o})(e)}),ou=()=>({NULL:!0}),r1=e=>({B:e}),o1=e=>({S:e.toString()}),n1=e=>({N:e.toString()}),t1=e=>{throw new Error(`${e} Use NumberValue from @aws-sdk/lib-dynamodb.`)},s1=(e,t)=>{if([Number.NaN,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY].map(r=>r.toString()).includes(e.toString()))throw new Error(`Special numeric value ${e.toString()} is not allowed`);return t?.allowImpreciseNumbers||(Number(e)>Number.MAX_SAFE_INTEGER?t1(`Number ${e.toString()} is greater than Number.MAX_SAFE_INTEGER.`):Number(e)<Number.MIN_SAFE_INTEGER&&t1(`Number ${e.toString()} is lesser than Number.MIN_SAFE_INTEGER.`)),{N:e.toString()}},i1=e=>{let t=["ArrayBuffer","Blob","Buffer","DataView","File","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];return e?.constructor?t.includes(e.constructor.name):!1};var uc=(e,t)=>{for(let[r,o]of Object.entries(e))if(o!==void 0)switch(r){case"NULL":return null;case"BOOL":return!!o;case"N":return a1(o,t);case"B":return d1(o);case"S":return c1(o);case"L":return vH(o,t);case"M":return CH(o,t);case"NS":return new Set(o.map(n=>a1(n,t)));case"BS":return new Set(o.map(d1));case"SS":return new Set(o.map(c1));default:throw new Error(`Unsupported type passed: ${r}`)}throw new Error(`No value defined: ${JSON.stringify(e)}`)},a1=(e,t)=>{if(typeof t?.wrapNumbers=="function")return t?.wrapNumbers(e);if(t?.wrapNumbers)return As.from(e);let r=Number(e),o=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];if((r>Number.MAX_SAFE_INTEGER||r<Number.MIN_SAFE_INTEGER)&&!o.includes(r))if(typeof BigInt=="function")try{return BigInt(e)}catch{throw new Error(`${e} can't be converted to BigInt. Set options.wrapNumbers to get string value.`)}else throw new Error(`${e} is outside SAFE_INTEGER bounds. Set options.wrapNumbers to get string value.`);return r},c1=e=>e,d1=e=>e,vH=(e,t)=>e.map(r=>uc(r,t)),CH=(e,t)=>Object.entries(e).reduce((r,[o,n])=>(r[o]=uc(n,t),r),{});function l1(e,t){let r=pc(e,t),[o,n]=Object.entries(r)[0];switch(o){case"M":case"L":return t?.convertTopLevelContainer?r:n;case"SS":case"NS":case"BS":case"S":case"N":case"B":case"NULL":case"BOOL":case"$unknown":default:return r}}var p1=(e,t)=>t?.convertWithoutMapWrapper?uc(e,t):uc({M:e},t);var Cn=null,Y={},Dt=[],u1="*",nu=(e,t,r)=>{if(e!==void 0){if(r==null)return t(e);{let o=Object.keys(r),n=o.length===1&&o[0]===u1,s=o.length>=1&&!n,i=o.length===0;if(s)return rx(e,t,r);if(i)return AH(e,t,Cn);if(n)return Object.entries(e??{}).reduce((a,[c,l])=>(typeof l!="function"&&(a[c]=nu(l,t,r[u1])),a),Array.isArray(e)?[]:{})}}},rx=(e,t,r)=>{let o;if(Array.isArray(e))o=e.filter(n=>typeof n!="function");else{o={};for(let[n,s]of Object.entries(e))typeof s!="function"&&(o[n]=s)}for(let[n,s]of Object.entries(r)){if(typeof e[n]=="function")continue;let i=nu(e[n],t,s);i!==void 0&&typeof i!="function"&&(o[n]=i)}return o},AH=(e,t,r)=>Array.isArray(e)?e.filter(o=>typeof o!="function").map(o=>nu(o,t,r)):Object.entries(e).reduce((o,[n,s])=>{if(typeof s=="function")return o;let i=nu(s,t,r);return i!==void 0&&typeof i!="function"&&(o[n]=i),o},{}),f1=(e,t,r)=>rx(e,n=>l1(n,r),t),m1=(e,t,r)=>rx(e,n=>p1(n,r),t);var $e=class extends V{addMarshallingMiddleware(t){let{marshallOptions:r={},unmarshallOptions:o={}}=t.translateConfig||{};r.convertTopLevelContainer=r.convertTopLevelContainer??!0,o.convertWithoutMapWrapper=o.convertWithoutMapWrapper??!0,this.clientCommand.middlewareStack.addRelativeTo((n,s)=>async i=>($t(s,"DDB_MAPPER","d"),n({...i,input:f1(i.input,this.inputKeyNodes,r)})),{name:"DocumentMarshall",relation:"before",toMiddleware:"serializerMiddleware",override:!0}),this.clientCommand.middlewareStack.addRelativeTo((n,s)=>async i=>{let a=await n(i);return a.output=m1(a.output,this.outputKeyNodes,o),a},{name:"DocumentUnmarshall",relation:"before",toMiddleware:"deserializerMiddleware",override:!0})}};var fc=class extends $e{input;inputKeyNodes={Key:Y,Expected:{"*":{Value:Cn,AttributeValueList:Dt}},ExpressionAttributeValues:Y};outputKeyNodes={Attributes:Y,ItemCollectionMetrics:{ItemCollectionKey:Y}};clientCommand;middlewareStack;constructor(t){super(),this.input=t,this.clientCommand=new Xp(this.input),this.middlewareStack=this.clientCommand.middlewareStack}resolveMiddleware(t,r,o){this.addMarshallingMiddleware(r);let n=t.concat(this.middlewareStack),s=this.clientCommand.resolveMiddleware(n,r,o);return async()=>s(this.clientCommand)}};var mc=class extends $e{input;inputKeyNodes={Key:Y};outputKeyNodes={Item:Y};clientCommand;middlewareStack;constructor(t){super(),this.input=t,this.clientCommand=new Qp(this.input),this.middlewareStack=this.clientCommand.middlewareStack}resolveMiddleware(t,r,o){this.addMarshallingMiddleware(r);let n=t.concat(this.middlewareStack),s=this.clientCommand.resolveMiddleware(n,r,o);return async()=>s(this.clientCommand)}};var hc=class extends $e{input;inputKeyNodes={Item:Y,Expected:{"*":{Value:Cn,AttributeValueList:Dt}},ExpressionAttributeValues:Y};outputKeyNodes={Attributes:Y,ItemCollectionMetrics:{ItemCollectionKey:Y}};clientCommand;middlewareStack;constructor(t){super(),this.input=t,this.clientCommand=new Zp(this.input),this.middlewareStack=this.clientCommand.middlewareStack}resolveMiddleware(t,r,o){this.addMarshallingMiddleware(r);let n=t.concat(this.middlewareStack),s=this.clientCommand.resolveMiddleware(n,r,o);return async()=>s(this.clientCommand)}};var Ps=class extends $e{input;inputKeyNodes={KeyConditions:{"*":{AttributeValueList:Dt}},QueryFilter:{"*":{AttributeValueList:Dt}},ExclusiveStartKey:Y,ExpressionAttributeValues:Y};outputKeyNodes={Items:{"*":Y},LastEvaluatedKey:Y};clientCommand;middlewareStack;constructor(t){super(),this.input=t,this.clientCommand=new eu(this.input),this.middlewareStack=this.clientCommand.middlewareStack}resolveMiddleware(t,r,o){this.addMarshallingMiddleware(r);let n=t.concat(this.middlewareStack),s=this.clientCommand.resolveMiddleware(n,r,o);return async()=>s(this.clientCommand)}};var gc=class extends $e{input;inputKeyNodes={ScanFilter:{"*":{AttributeValueList:Dt}},ExclusiveStartKey:Y,ExpressionAttributeValues:Y};outputKeyNodes={Items:{"*":Y},LastEvaluatedKey:Y};clientCommand;middlewareStack;constructor(t){super(),this.input=t,this.clientCommand=new tu(this.input),this.middlewareStack=this.clientCommand.middlewareStack}resolveMiddleware(t,r,o){this.addMarshallingMiddleware(r);let n=t.concat(this.middlewareStack),s=this.clientCommand.resolveMiddleware(n,r,o);return async()=>s(this.clientCommand)}};var xc=class extends $e{input;inputKeyNodes={Key:Y,AttributeUpdates:{"*":{Value:Cn}},Expected:{"*":{Value:Cn,AttributeValueList:Dt}},ExpressionAttributeValues:Y};outputKeyNodes={Attributes:Y,ItemCollectionMetrics:{ItemCollectionKey:Y}};clientCommand;middlewareStack;constructor(t){super(),this.input=t,this.clientCommand=new ru(this.input),this.middlewareStack=this.clientCommand.middlewareStack}resolveMiddleware(t,r,o){this.addMarshallingMiddleware(r);let n=t.concat(this.middlewareStack),s=this.clientCommand.resolveMiddleware(n,r,o);return async()=>s(this.clientCommand)}};N();var Jo=class e extends Be{config;constructor(t,r){if(super(t.config),this.config=t.config,this.config.translateConfig=r,this.middlewareStack=t.middlewareStack,this.config?.cacheMiddleware)throw new Error("@aws-sdk/lib-dynamodb - cacheMiddleware=true is not compatible with the DynamoDBDocumentClient. This option must be set to false.")}static from(t,r){return new e(t,r)}destroy(){}};Fe();var pve=No(Jo,Ps,"ExclusiveStartKey","LastEvaluatedKey","Limit");Fe();var gve=No(Jo,gc,"ExclusiveStartKey","LastEvaluatedKey","Limit");var Yo=class e extends Error{code;statusCode;details;correlationId;constructor(t,r,o,n){super(r),this.name="AppError",this.code=t,this.statusCode=Yu(t),this.details=o,this.correlationId=n,Error.captureStackTrace&&Error.captureStackTrace(this,e)}},ox=class extends Yo{constructor(t,r,o){super("ValidationError",t,r,o),this.name="ValidationError"}},nx=class extends Yo{constructor(t="Authentication required",r){super("Unauthorized",t,void 0,r),this.name="UnauthorizedError"}},sx=class extends Yo{constructor(t="Insufficient permissions",r){super("Forbidden",t,void 0,r),this.name="ForbiddenError"}},ix=class extends Yo{constructor(t="Resource not found",r){super("NotFound",t,void 0,r),this.name="NotFoundError"}},ax=class extends Yo{constructor(t="Resource already exists",r){super("Conflict",t,void 0,r),this.name="ConflictError"}},cx=class extends Yo{constructor(t="Internal server error",r,o){super("InternalError",t,r,o),this.name="InternalError"}};function Xe(e,t,r,o){switch(e){case"ValidationError":return new ox(t,r,o);case"Unauthorized":return new nx(t,o);case"Forbidden":return new sx(t,o);case"NotFound":return new ix(t,o);case"Conflict":return new ax(t,o);case"InternalError":return new cx(t,r,o);default:return new Yo(e,t,r,o)}}import{randomUUID as h1}from"crypto";var PH=()=>{let e=new Yp({region:process.env.AWS_REGION||"us-east-1",maxAttempts:3,retryMode:"adaptive",requestHandler:{requestTimeout:5e3,httpsAgent:{maxSockets:50,keepAlive:!0}}});return Jo.from(e,{marshallOptions:{convertEmptyValues:!1,removeUndefinedValues:!0,convertClassInstanceToMap:!1},unmarshallOptions:{wrapNumbers:!1}})},dx=null,DH=()=>(dx||(dx=PH(),x.info("DynamoDB client initialized")),dx),NH=()=>{let e=vo();return{staff:e.dynamodb.staffTable,passwordResetTokens:e.dynamodb.passwordResetTokensTable,tenants:e.dynamodb.tenantsTable}},px=class{client;tables;constructor(){this.client=DH(),this.tables=NH()}async getItem(t,r,o){try{x.info("DynamoDB GetItem operation",{tableName:t,key:Object.keys(r),correlationId:o});let n=new mc({TableName:t,Key:r}),s=await this.client.send(n);return x.info("DynamoDB GetItem completed",{tableName:t,found:!!s.Item,correlationId:o}),s.Item}catch(n){throw x.error("DynamoDB GetItem failed",{tableName:t,error:n instanceof Error?n.message:"Unknown error",correlationId:o}),n}}async putItem(t,r,o){try{x.info("DynamoDB PutItem operation",{tableName:t,itemKeys:Object.keys(r),correlationId:o});let n=new hc({TableName:t,Item:r});return await this.client.send(n),x.info("DynamoDB PutItem completed",{tableName:t,correlationId:o}),r}catch(n){throw x.error("DynamoDB PutItem failed",{tableName:t,error:n instanceof Error?n.message:"Unknown error",correlationId:o}),n}}async updateItem(t,r,o,n,s,i){try{x.info("DynamoDB UpdateItem operation",{tableName:t,key:Object.keys(r),correlationId:i});let a=new xc({TableName:t,Key:r,UpdateExpression:o,ExpressionAttributeValues:n,ExpressionAttributeNames:s,ReturnValues:"ALL_NEW"}),c=await this.client.send(a);return x.info("DynamoDB UpdateItem completed",{tableName:t,correlationId:i}),c.Attributes}catch(a){throw x.error("DynamoDB UpdateItem failed",{tableName:t,error:a instanceof Error?a.message:"Unknown error",correlationId:i}),a}}async deleteItem(t,r,o){try{x.info("DynamoDB DeleteItem operation",{tableName:t,key:Object.keys(r),correlationId:o});let n=new fc({TableName:t,Key:r});await this.client.send(n),x.info("DynamoDB DeleteItem completed",{tableName:t,correlationId:o})}catch(n){throw x.error("DynamoDB DeleteItem failed",{tableName:t,error:n instanceof Error?n.message:"Unknown error",correlationId:o}),n}}async queryItems(t,r,o,n,s,i){try{x.info("DynamoDB Query operation",{tableName:t,indexName:n,correlationId:i});let a=new Ps({TableName:t,KeyConditionExpression:r,ExpressionAttributeValues:o,ExpressionAttributeNames:s,IndexName:n}),c=await this.client.send(a);return x.info("DynamoDB Query completed",{tableName:t,itemCount:c.Items?.length||0,correlationId:i}),c.Items||[]}catch(a){throw x.error("DynamoDB Query failed",{tableName:t,error:a instanceof Error?a.message:"Unknown error",correlationId:i}),a}}async getStaffById(t,r){try{let o=await this.getItem(this.tables.staff,{staff_id:t},r);if(!o)return{found:!1};let n=js.safeParse(o);if(!n.success)throw x.error("Invalid staff record format in database",{staffId:t,errors:n.error.errors,correlationId:r}),Xe("InternalError","Invalid staff record format");return{staff:n.data,found:!0}}catch(o){throw x.error("Failed to get staff by ID",{staffId:t,error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o}}async getStaffByEmail(t,r){try{let o=t.toLowerCase(),n=await this.queryItems(this.tables.staff,"email = :email",{":email":o},"EmailIndex",void 0,r);if(!n||n.length===0)return{found:!1};let s=n[0],i=js.safeParse(s);if(!i.success)throw x.error("Invalid staff record format in database",{email:o,errors:i.error.errors,correlationId:r}),Xe("InternalError","Invalid staff record format");return{staff:i.data,found:!0}}catch(o){throw x.error("Failed to get staff by email",{email:t,error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o}}async createStaff(t,r){try{let o=new Date().toISOString(),n={staff_id:h1(),...t,email:t.email.toLowerCase(),created_at:o,updated_at:o},s=js.safeParse(n);if(!s.success)throw x.error("Invalid staff record data",{errors:s.error.errors,correlationId:r}),Xe("ValidationError","Invalid staff record data");if((await this.getStaffByEmail(n.email,r)).found)throw x.warn("Attempted to create staff with duplicate email",{email:n.email,correlationId:r}),Xe("Conflict","Staff member with this email already exists");return await this.putItem(this.tables.staff,s.data,r),{success:!0,data:s.data,correlationId:r}}catch(o){if(x.error("Failed to create staff",{error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o instanceof Error&&o.message.includes("already exists"))return{success:!1,error:o.message,correlationId:r};throw o}}async updateStaff(t,r,o){try{let n={...r,updated_at:new Date().toISOString()},s="SET "+Object.keys(n).map((p,u)=>`#${p} = :val${u}`).join(", "),i=Object.keys(n).reduce((p,u)=>(p[`#${u}`]=u,p),{}),a=Object.keys(n).reduce((p,u,f)=>(p[`:val${f}`]=n[u],p),{}),c=await this.updateItem(this.tables.staff,{staff_id:t},s,a,i,o);if(!c)throw Xe("NotFound","Staff member not found");let l=js.safeParse(c);if(!l.success)throw x.error("Invalid staff record after update",{staffId:t,errors:l.error.errors,correlationId:o}),Xe("InternalError","Invalid staff record after update");return{success:!0,data:l.data,correlationId:o}}catch(n){throw x.error("Failed to update staff",{staffId:t,error:n instanceof Error?n.message:"Unknown error",correlationId:o}),n}}async updateStaffPassword(t,r,o){try{let n={password_hash:r,updated_at:new Date().toISOString()},s="SET password_hash = :password_hash, updated_at = :updated_at",i={":password_hash":n.password_hash,":updated_at":n.updated_at},a=await this.updateItem(this.tables.staff,{staff_id:t},s,i,void 0,o);if(!a)throw Xe("NotFound","Staff member not found");let c=js.safeParse(a);if(!c.success)throw x.error("Invalid staff record after password update",{staffId:t,errors:c.error.errors,correlationId:o}),Xe("InternalError","Invalid staff record after password update");return{success:!0,data:c.data,correlationId:o}}catch(n){throw x.error("Failed to update staff password",{staffId:t,error:n instanceof Error?n.message:"Unknown error",correlationId:o}),n}}async getPasswordResetToken(t,r){try{let o=await this.getItem(this.tables.passwordResetTokens,{token_hash:t},r);if(!o)return{found:!1};let n=Wc.safeParse(o);if(!n.success)throw x.error("Invalid password reset token format in database",{tokenHash:t,errors:n.error.errors,correlationId:r}),Xe("InternalError","Invalid password reset token format");let s=Math.floor(Date.now()/1e3),i=n.data.expires_at<=s;return{token:n.data,found:!0,expired:i}}catch(o){throw x.error("Failed to get password reset token",{tokenHash:t,error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o}}async createPasswordResetToken(t,r){try{let o={...t,created_at:new Date().toISOString()},n=Wc.safeParse(o);if(!n.success)throw x.error("Invalid password reset token data",{errors:n.error.errors,correlationId:r}),Xe("ValidationError","Invalid password reset token data");return await this.putItem(this.tables.passwordResetTokens,n.data,r),{success:!0,data:n.data,correlationId:r}}catch(o){throw x.error("Failed to create password reset token",{error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o}}async markPasswordResetTokenUsed(t,r){try{let o=await this.updateItem(this.tables.passwordResetTokens,{token_hash:t},"SET used_at = :used_at",{":used_at":new Date().toISOString()},void 0,r);if(!o)throw Xe("NotFound","Password reset token not found");let n=Wc.safeParse(o);if(!n.success)throw x.error("Invalid password reset token after update",{tokenHash:t,errors:n.error.errors,correlationId:r}),Xe("InternalError","Invalid password reset token after update");return{success:!0,data:n.data,correlationId:r}}catch(o){throw x.error("Failed to mark password reset token as used",{tokenHash:t,error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o}}async deletePasswordResetToken(t,r){return this.deleteItem(this.tables.passwordResetTokens,{token_hash:t},r)}async getTenant(t,r){try{let o=await this.getItem(this.tables.tenants,{tenant_id:t},r);if(!o)return{found:!1};let n=zc.safeParse(o);if(!n.success)throw x.error("Invalid tenant record format in database",{tenantId:t,errors:n.error.errors,correlationId:r}),Xe("InternalError","Invalid tenant record format");return{tenant:n.data,found:!0}}catch(o){throw x.error("Failed to get tenant",{tenantId:t,error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o}}async createTenant(t,r){try{let o=new Date().toISOString(),n={tenant_id:h1(),...t,email:t.email.toLowerCase(),status:"pending",created_at:o,updated_at:o},s=zc.safeParse(n);if(!s.success)throw x.error("Invalid tenant record data",{errors:s.error.errors,correlationId:r}),Xe("ValidationError","Invalid tenant record data");return await this.putItem(this.tables.tenants,s.data,r),{success:!0,data:s.data,correlationId:r}}catch(o){throw x.error("Failed to create tenant",{error:o instanceof Error?o.message:"Unknown error",correlationId:r}),o}}async updateTenant(t,r,o){try{let n={...r,...r.email&&{email:r.email.toLowerCase()},updated_at:new Date().toISOString()},s="SET "+Object.keys(n).map((p,u)=>`#${p} = :val${u}`).join(", "),i=Object.keys(n).reduce((p,u)=>(p[`#${u}`]=u,p),{}),a=Object.keys(n).reduce((p,u,f)=>(p[`:val${f}`]=n[u],p),{}),c=await this.updateItem(this.tables.tenants,{tenant_id:t},s,a,i,o);if(!c)throw Xe("NotFound","Tenant not found");let l=zc.safeParse(c);if(!l.success)throw x.error("Invalid tenant record after update",{tenantId:t,errors:l.error.errors,correlationId:o}),Xe("InternalError","Invalid tenant record after update");return{success:!0,data:l.data,correlationId:o}}catch(n){throw x.error("Failed to update tenant",{tenantId:t,error:n instanceof Error?n.message:"Unknown error",correlationId:o}),n}}},lx=null,j={get instance(){return lx||(lx=new px),lx},getItem:(e,t,r)=>j.instance.getItem(e,t,r),putItem:(e,t,r)=>j.instance.putItem(e,t,r),updateItem:(e,t,r,o,n,s)=>j.instance.updateItem(e,t,r,o,n,s),deleteItem:(e,t,r)=>j.instance.deleteItem(e,t,r),queryItems:(e,t,r,o,n,s)=>j.instance.queryItems(e,t,r,o,n,s),getStaffById:(e,t)=>j.instance.getStaffById(e,t),getStaffByEmail:(e,t)=>j.instance.getStaffByEmail(e,t),createStaff:(e,t)=>j.instance.createStaff(e,t),updateStaff:(e,t,r)=>j.instance.updateStaff(e,t,r),updateStaffPassword:(e,t,r)=>j.instance.updateStaffPassword(e,t,r),getPasswordResetToken:(e,t)=>j.instance.getPasswordResetToken(e,t),createPasswordResetToken:(e,t)=>j.instance.createPasswordResetToken(e,t),markPasswordResetTokenUsed:(e,t)=>j.instance.markPasswordResetTokenUsed(e,t),deletePasswordResetToken:(e,t)=>j.instance.deletePasswordResetToken(e,t),getTenant:(e,t)=>j.instance.getTenant(e,t),createTenant:(e,t)=>j.instance.createTenant(e,t),updateTenant:(e,t,r)=>j.instance.updateTenant(e,t,r)};import OH from"crypto";var ux=null;function kH(e){try{return crypto.getRandomValues(new Uint8Array(e))}catch{}try{return OH.randomBytes(e)}catch{}if(!ux)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return ux(e)}function $H(e){ux=e}function mx(e,t){if(e=e||hx,typeof e!="number")throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2b$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(su(kH(yc),yc)),r.join("")}function E1(e,t,r){if(typeof t=="function"&&(r=t,t=void 0),typeof e=="function"&&(r=e,e=void 0),typeof e>"u")e=hx;else if(typeof e!="number")throw Error("illegal arguments: "+typeof e);function o(n){Yr(function(){try{n(null,mx(e))}catch(s){n(s)}})}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);o(r)}else return new Promise(function(n,s){o(function(i,a){if(i){s(i);return}n(a)})})}function _1(e,t){if(typeof t>"u"&&(t=hx),typeof t=="number"&&(t=mx(t)),typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return fx(e,t)}function b1(e,t,r,o){function n(s){typeof e=="string"&&typeof t=="number"?E1(t,function(i,a){fx(e,a,s,o)}):typeof e=="string"&&typeof t=="string"?fx(e,t,s,o):Yr(s.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(s,i){n(function(a,c){if(a){i(a);return}s(c)})})}function w1(e,t){for(var r=e.length^t.length,o=0;o<e.length;++o)r|=e.charCodeAt(o)^t.charCodeAt(o);return r===0}function MH(e,t){if(typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return t.length!==60?!1:w1(_1(e,t.substring(0,t.length-31)),t)}function LH(e,t,r,o){function n(s){if(typeof e!="string"||typeof t!="string"){Yr(s.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)));return}if(t.length!==60){Yr(s.bind(this,null,!1));return}b1(e,t.substring(0,29),function(i,a){i?s(i):s(null,w1(a,t))},o)}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(s,i){n(function(a,c){if(a){i(a);return}s(c)})})}function UH(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)}function FH(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);if(e.length!==60)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)}function BH(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return R1(e)>72}var Yr=typeof setImmediate=="function"?setImmediate:typeof scheduler=="object"&&typeof scheduler.postTask=="function"?scheduler.postTask.bind(scheduler):setTimeout;function R1(e){for(var t=0,r=0,o=0;o<e.length;++o)r=e.charCodeAt(o),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(o+1)&64512)===56320?(++o,t+=4):t+=3;return t}function HH(e){for(var t=0,r,o,n=new Array(R1(e)),s=0,i=e.length;s<i;++s)r=e.charCodeAt(s),r<128?n[t++]=r:r<2048?(n[t++]=r>>6|192,n[t++]=r&63|128):(r&64512)===55296&&((o=e.charCodeAt(s+1))&64512)===56320?(r=65536+((r&1023)<<10)+(o&1023),++s,n[t++]=r>>18|240,n[t++]=r>>12&63|128,n[t++]=r>>6&63|128,n[t++]=r&63|128):(n[t++]=r>>12|224,n[t++]=r>>6&63|128,n[t++]=r&63|128);return n}var $i="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),An=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function su(e,t){var r=0,o=[],n,s;if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;r<t;){if(n=e[r++]&255,o.push($i[n>>2&63]),n=(n&3)<<4,r>=t){o.push($i[n&63]);break}if(s=e[r++]&255,n|=s>>4&15,o.push($i[n&63]),n=(s&15)<<2,r>=t){o.push($i[n&63]);break}s=e[r++]&255,n|=s>>6&3,o.push($i[n&63]),o.push($i[s&63])}return o.join("")}function I1(e,t){var r=0,o=e.length,n=0,s=[],i,a,c,l,p,u;if(t<=0)throw Error("Illegal len: "+t);for(;r<o-1&&n<t&&(u=e.charCodeAt(r++),i=u<An.length?An[u]:-1,u=e.charCodeAt(r++),a=u<An.length?An[u]:-1,!(i==-1||a==-1||(p=i<<2>>>0,p|=(a&48)>>4,s.push(String.fromCharCode(p)),++n>=t||r>=o)||(u=e.charCodeAt(r++),c=u<An.length?An[u]:-1,c==-1)||(p=(a&15)<<4>>>0,p|=(c&60)>>2,s.push(String.fromCharCode(p)),++n>=t||r>=o)));)u=e.charCodeAt(r++),l=u<An.length?An[u]:-1,p=(c&3)<<6>>>0,p|=l,s.push(String.fromCharCode(p)),++n;var f=[];for(r=0;r<n;r++)f.push(s[r].charCodeAt(0));return f}var yc=16,hx=10,VH=16,GH=100,g1=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],x1=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],T1=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function Sc(e,t,r,o){var n,s=e[t],i=e[t+1];return s^=r[0],n=o[s>>>24],n+=o[256|s>>16&255],n^=o[512|s>>8&255],n+=o[768|s&255],i^=n^r[1],n=o[i>>>24],n+=o[256|i>>16&255],n^=o[512|i>>8&255],n+=o[768|i&255],s^=n^r[2],n=o[s>>>24],n+=o[256|s>>16&255],n^=o[512|s>>8&255],n+=o[768|s&255],i^=n^r[3],n=o[i>>>24],n+=o[256|i>>16&255],n^=o[512|i>>8&255],n+=o[768|i&255],s^=n^r[4],n=o[s>>>24],n+=o[256|s>>16&255],n^=o[512|s>>8&255],n+=o[768|s&255],i^=n^r[5],n=o[i>>>24],n+=o[256|i>>16&255],n^=o[512|i>>8&255],n+=o[768|i&255],s^=n^r[6],n=o[s>>>24],n+=o[256|s>>16&255],n^=o[512|s>>8&255],n+=o[768|s&255],i^=n^r[7],n=o[i>>>24],n+=o[256|i>>16&255],n^=o[512|i>>8&255],n+=o[768|i&255],s^=n^r[8],n=o[s>>>24],n+=o[256|s>>16&255],n^=o[512|s>>8&255],n+=o[768|s&255],i^=n^r[9],n=o[i>>>24],n+=o[256|i>>16&255],n^=o[512|i>>8&255],n+=o[768|i&255],s^=n^r[10],n=o[s>>>24],n+=o[256|s>>16&255],n^=o[512|s>>8&255],n+=o[768|s&255],i^=n^r[11],n=o[i>>>24],n+=o[256|i>>16&255],n^=o[512|i>>8&255],n+=o[768|i&255],s^=n^r[12],n=o[s>>>24],n+=o[256|s>>16&255],n^=o[512|s>>8&255],n+=o[768|s&255],i^=n^r[13],n=o[i>>>24],n+=o[256|i>>16&255],n^=o[512|i>>8&255],n+=o[768|i&255],s^=n^r[14],n=o[s>>>24],n+=o[256|s>>16&255],n^=o[512|s>>8&255],n+=o[768|s&255],i^=n^r[15],n=o[i>>>24],n+=o[256|i>>16&255],n^=o[512|i>>8&255],n+=o[768|i&255],s^=n^r[16],e[t]=i^r[VH+1],e[t+1]=s,e}function Mi(e,t){for(var r=0,o=0;r<4;++r)o=o<<8|e[t]&255,t=(t+1)%e.length;return{key:o,offp:t}}function y1(e,t,r){for(var o=0,n=[0,0],s=t.length,i=r.length,a,c=0;c<s;c++)a=Mi(e,o),o=a.offp,t[c]=t[c]^a.key;for(c=0;c<s;c+=2)n=Sc(n,0,t,r),t[c]=n[0],t[c+1]=n[1];for(c=0;c<i;c+=2)n=Sc(n,0,t,r),r[c]=n[0],r[c+1]=n[1]}function jH(e,t,r,o){for(var n=0,s=[0,0],i=r.length,a=o.length,c,l=0;l<i;l++)c=Mi(t,n),n=c.offp,r[l]=r[l]^c.key;for(n=0,l=0;l<i;l+=2)c=Mi(e,n),n=c.offp,s[0]^=c.key,c=Mi(e,n),n=c.offp,s[1]^=c.key,s=Sc(s,0,r,o),r[l]=s[0],r[l+1]=s[1];for(l=0;l<a;l+=2)c=Mi(e,n),n=c.offp,s[0]^=c.key,c=Mi(e,n),n=c.offp,s[1]^=c.key,s=Sc(s,0,r,o),o[l]=s[0],o[l+1]=s[1]}function S1(e,t,r,o,n){var s=T1.slice(),i=s.length,a;if(r<4||r>31)if(a=Error("Illegal number of rounds (4-31): "+r),o){Yr(o.bind(this,a));return}else throw a;if(t.length!==yc)if(a=Error("Illegal salt length: "+t.length+" != "+yc),o){Yr(o.bind(this,a));return}else throw a;r=1<<r>>>0;var c,l,p=0,u;typeof Int32Array=="function"?(c=new Int32Array(g1),l=new Int32Array(x1)):(c=g1.slice(),l=x1.slice()),jH(t,e,c,l);function f(){if(n&&n(p/r),p<r)for(var h=Date.now();p<r&&(p=p+1,y1(e,c,l),y1(t,c,l),!(Date.now()-h>GH)););else{for(p=0;p<64;p++)for(u=0;u<i>>1;u++)Sc(s,u<<1,c,l);var g=[];for(p=0;p<i;p++)g.push((s[p]>>24&255)>>>0),g.push((s[p]>>16&255)>>>0),g.push((s[p]>>8&255)>>>0),g.push((s[p]&255)>>>0);if(o){o(null,g);return}else return g}o&&Yr(f)}if(typeof o<"u")f();else for(var m;;)if(typeof(m=f())<"u")return m||[]}function fx(e,t,r,o){var n;if(typeof e!="string"||typeof t!="string")if(n=Error("Invalid string / salt: Not a string"),r){Yr(r.bind(this,n));return}else throw n;var s,i;if(t.charAt(0)!=="$"||t.charAt(1)!=="2")if(n=Error("Invalid salt version: "+t.substring(0,2)),r){Yr(r.bind(this,n));return}else throw n;if(t.charAt(2)==="$")s="\0",i=3;else{if(s=t.charAt(2),s!=="a"&&s!=="b"&&s!=="y"||t.charAt(3)!=="$")if(n=Error("Invalid salt revision: "+t.substring(2,4)),r){Yr(r.bind(this,n));return}else throw n;i=4}if(t.charAt(i+2)>"$")if(n=Error("Missing salt rounds"),r){Yr(r.bind(this,n));return}else throw n;var a=parseInt(t.substring(i,i+1),10)*10,c=parseInt(t.substring(i+1,i+2),10),l=a+c,p=t.substring(i+3,i+25);e+=s>="a"?"\0":"";var u=HH(e),f=I1(p,yc);function m(h){var g=[];return g.push("$2"),s>="a"&&g.push(s),g.push("$"),l<10&&g.push("0"),g.push(l.toString()),g.push("$"),g.push(su(f,f.length)),g.push(su(h,T1.length*4-1)),g.join("")}if(typeof r>"u")return m(S1(u,f,l));S1(u,f,l,function(h,g){h?r(h,null):r(null,m(g))},o)}function WH(e,t){return su(e,t)}function zH(e,t){return I1(e,t)}var gx={setRandomFallback:$H,genSaltSync:mx,genSalt:E1,hashSync:_1,hash:b1,compareSync:MH,compare:LH,getRounds:UH,getSalt:FH,truncates:BH,encodeBase64:WH,decodeBase64:zH};async function iu(e,t){try{x.info("Hashing password",{correlationId:t,passwordType:typeof e,passwordValue:e?"[REDACTED]":"null/undefined"});let r=String(e);if(!r||r.length===0)throw new Error("Password cannot be empty");if(r.length<8)throw new Error("Password must be at least 8 characters long");let n=await gx.hash(r,12);return x.info("Password hashed successfully",{correlationId:t}),n}catch(r){throw x.error("Failed to hash password",{error:r instanceof Error?r.message:"Unknown error",correlationId:t}),r}}async function v1(e,t,r){try{if(x.info("Verifying password",{correlationId:r}),!e||!t)return x.info("Password verification failed: empty password or hash",{correlationId:r}),!1;let o=await gx.compare(e,t);return x.info("Password verification completed",{isValid:o,correlationId:r}),o}catch(o){return x.error("Failed to verify password",{error:o instanceof Error?o.message:"Unknown error",correlationId:r}),!1}}function C1(e){let t=[];return e?(e.length<8&&t.push("Password must be at least 8 characters long"),e.length>128&&t.push("Password must be less than 128 characters long"),/[a-z]/.test(e)||t.push("Password must contain at least one lowercase letter"),/[A-Z]/.test(e)||t.push("Password must contain at least one uppercase letter"),/\d/.test(e)||t.push("Password must contain at least one number"),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)||t.push("Password must contain at least one special character"),["password","password123","123456","123456789","qwerty","abc123","password1","admin","letmein","welcome"].includes(e.toLowerCase())&&t.push("Password is too common and easily guessable"),{isValid:t.length===0,errors:t}):(t.push("Password is required"),{isValid:!1,errors:t})}var xx=async(e,t)=>{try{x.info("Processing login request",{correlationId:e.correlationId,email:e.body?.email});let r=Jc.safeParse(e.body);if(!r.success){x.warn("Login validation failed",{correlationId:e.correlationId,errors:r.error.errors}),A(t,"ValidationError","Invalid login credentials format",e.correlationId,{validationErrors:r.error.errors});return}let{email:o,password:n}=r.data,s=await j.getStaffByEmail(o,e.correlationId);if(!s.found||!s.staff){x.warn("Login attempt for non-existent email",{correlationId:e.correlationId,email:o}),A(t,"Unauthorized","Invalid email or password",e.correlationId);return}let i=s.staff;if(!i.enabled){x.warn("Login attempt for disabled account",{correlationId:e.correlationId,email:o,staffId:i.staff_id}),A(t,"Unauthorized","Account is disabled",e.correlationId);return}if(!await v1(n,i.password_hash,e.correlationId)){x.warn("Login attempt with invalid password",{correlationId:e.correlationId,email:o,staffId:i.staff_id}),A(t,"Unauthorized","Invalid email or password",e.correlationId);return}let c=await Gs.signToken({staffId:i.staff_id,email:i.email,roles:i.roles},e.correlationId);x.info("Login successful",{correlationId:e.correlationId,staffId:i.staff_id,email:i.email,roles:i.roles}),t.status(200).json({success:!0,data:{token:c,staff:{staff_id:i.staff_id,email:i.email,roles:i.roles,enabled:i.enabled}},timestamp:new Date().toISOString()})}catch(r){x.error("Login handler error",{correlationId:e.correlationId,error:r instanceof Error?r.message:"Unknown error"}),A(t,"InternalError","Login failed",e.correlationId)}};Xn();Qn();Zn();hn();ut();Fe();ae();ls();Te();Ut();N();Ne();Ze();var A1=async(e,t,r)=>({operation:ve(t).operation,region:await de(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function KH(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"ses",region:e.region},propertiesExtractor:(t,r)=>({signingProperties:{config:t,context:r}})}}var P1=e=>{let t=[];switch(e.operation){default:t.push(KH(e))}return t},D1=e=>{let t=ur(e);return Object.assign(t,{authSchemePreference:de(e.authSchemePreference??[])})};var N1=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"ses"}),O1={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};var k1={name:"@aws-sdk/client-ses",description:"AWS SDK for JavaScript Ses Client for Node.js, Browser and React Native",version:"3.958.0",scripts:{build:"concurrently 'yarn:build:types' 'yarn:build:es' && yarn build:cjs","build:cjs":"node ../../scripts/compilation/inline client-ses","build:es":"tsc -p tsconfig.es.json","build:include:deps":'yarn g:turbo run build -F="$npm_package_name"',"build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo ses","test:e2e":"yarn g:vitest run -c vitest.config.e2e.mts --mode development","test:e2e:watch":"yarn g:vitest watch -c vitest.config.e2e.mts","test:index":"tsc --noEmit ./test/index-types.ts && node ./test/index-objects.spec.mjs"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.957.0","@aws-sdk/credential-provider-node":"3.958.0","@aws-sdk/middleware-host-header":"3.957.0","@aws-sdk/middleware-logger":"3.957.0","@aws-sdk/middleware-recursion-detection":"3.957.0","@aws-sdk/middleware-user-agent":"3.957.0","@aws-sdk/region-config-resolver":"3.957.0","@aws-sdk/types":"3.957.0","@aws-sdk/util-endpoints":"3.957.0","@aws-sdk/util-user-agent-browser":"3.957.0","@aws-sdk/util-user-agent-node":"3.957.0","@smithy/config-resolver":"^4.4.5","@smithy/core":"^3.20.0","@smithy/fetch-http-handler":"^5.3.8","@smithy/hash-node":"^4.2.7","@smithy/invalid-dependency":"^4.2.7","@smithy/middleware-content-length":"^4.2.7","@smithy/middleware-endpoint":"^4.4.1","@smithy/middleware-retry":"^4.4.17","@smithy/middleware-serde":"^4.2.8","@smithy/middleware-stack":"^4.2.7","@smithy/node-config-provider":"^4.3.7","@smithy/node-http-handler":"^4.4.7","@smithy/protocol-http":"^5.3.7","@smithy/smithy-client":"^4.10.2","@smithy/types":"^4.11.0","@smithy/url-parser":"^4.2.7","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.16","@smithy/util-defaults-mode-node":"^4.2.19","@smithy/util-endpoints":"^3.2.7","@smithy/util-middleware":"^4.2.7","@smithy/util-retry":"^4.2.7","@smithy/util-utf8":"^4.2.0","@smithy/util-waiter":"^4.2.7",tslib:"^2.6.2"},devDependencies:{"@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-ses",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-ses"}};Ne();gs();ut();xs();Ut();wr();ko();N();ys();Ss();Go();Ne();Ho();N();Bo();et();Ae();an();Wr();var j1="required",_o="fn",bo="argv",Ui="ref";var $1="isSet",_c="booleanEquals",Li="error",Ec="endpoint",Xo="tree",yx="PartitionResult",M1={[j1]:!1,type:"string"},L1={[j1]:!0,default:!1,type:"boolean"},U1={[Ui]:"Endpoint"},W1={[_o]:_c,[bo]:[{[Ui]:"UseFIPS"},!0]},z1={[_o]:_c,[bo]:[{[Ui]:"UseDualStack"},!0]},Eo={},F1={[_o]:"getAttr",[bo]:[{[Ui]:yx},"supportsFIPS"]},B1={[_o]:_c,[bo]:[!0,{[_o]:"getAttr",[bo]:[{[Ui]:yx},"supportsDualStack"]}]},H1=[W1],V1=[z1],G1=[{[Ui]:"Region"}],JH={version:"1.0",parameters:{Region:M1,UseDualStack:L1,UseFIPS:L1,Endpoint:M1},rules:[{conditions:[{[_o]:$1,[bo]:[U1]}],rules:[{conditions:H1,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Li},{conditions:V1,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Li},{endpoint:{url:U1,properties:Eo,headers:Eo},type:Ec}],type:Xo},{conditions:[{[_o]:$1,[bo]:G1}],rules:[{conditions:[{[_o]:"aws.partition",[bo]:G1,assign:yx}],rules:[{conditions:[W1,z1],rules:[{conditions:[{[_o]:_c,[bo]:[!0,F1]},B1],rules:[{endpoint:{url:"https://email-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Eo,headers:Eo},type:Ec}],type:Xo},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Li}],type:Xo},{conditions:H1,rules:[{conditions:[{[_o]:_c,[bo]:[F1,!0]}],rules:[{endpoint:{url:"https://email-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Eo,headers:Eo},type:Ec}],type:Xo},{error:"FIPS is enabled but this partition does not support FIPS",type:Li}],type:Xo},{conditions:V1,rules:[{conditions:[B1],rules:[{endpoint:{url:"https://email.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Eo,headers:Eo},type:Ec}],type:Xo},{error:"DualStack is enabled but this partition does not support DualStack",type:Li}],type:Xo},{endpoint:{url:"https://email.{Region}.{PartitionResult#dnsSuffix}",properties:Eo,headers:Eo},type:Ec}],type:Xo}],type:Xo},{error:"Invalid Configuration: Missing Region",type:Li}]},K1=JH;var YH=new bt({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),q1=(e,t={})=>YH.get(e,()=>ar(K1,{endpointParams:e,logger:t.logger}));ze.aws=kt;var J1=e=>({apiVersion:"2010-12-01",base64Decoder:e?.base64Decoder??Ie,base64Encoder:e?.base64Encoder??Ee,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??q1,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??P1,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new qe}],logger:e?.logger??new ot,protocol:e?.protocol??pi,protocolSettings:e?.protocolSettings??{defaultNamespace:"com.amazonaws.ses",xmlNamespace:"http://ses.amazonaws.com/doc/2010-12-01/",version:"2010-12-01",serviceTarget:"SimpleEmailService"},serviceId:e?.serviceId??"SES",urlParser:e?.urlParser??Ve,utf8Decoder:e?.utf8Decoder??_e,utf8Encoder:e?.utf8Encoder??Se});var Y1=e=>{mr(process.version);let t=Nr(e),r=()=>t().then(fr),o=J1(e);cr(process.version);let n={profile:e?.profile,logger:o.logger};return{...o,...e,runtime:"node",defaultsMode:t,authSchemePreference:e?.authSchemePreference??P(dr,n),bodyLengthChecker:e?.bodyLengthChecker??Dr,credentialDefaultProvider:e?.credentialDefaultProvider??Kp,defaultUserAgentProvider:e?.defaultUserAgentProvider??Ar({serviceId:o.serviceId,clientVersion:k1.version}),maxAttempts:e?.maxAttempts??P(Ir,e),region:e?.region??P(nt,{...Rt,...n}),requestHandler:tt.create(e?.requestHandler??r),retryMode:e?.retryMode??P({...vr,default:async()=>(await r()).retryMode||Tt},e),sha256:e?.sha256??Ct.bind(null,"sha256"),streamCollector:e?.streamCollector??xt,useDualstackEndpoint:e?.useDualstackEndpoint??P(Sr,n),useFipsEndpoint:e?.useFipsEndpoint??P(Er,n),userAgentAppId:e?.userAgentAppId??P(Pr,n)}};_n();we();N();var X1=e=>{let t=e.httpAuthSchemes,r=e.httpAuthSchemeProvider,o=e.credentials;return{setHttpAuthScheme(n){let s=t.findIndex(i=>i.schemeId===n.schemeId);s===-1?t.push(n):t.splice(s,1,n)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(n){r=n},httpAuthSchemeProvider(){return r},setCredentials(n){o=n},credentials(){return o}}},Q1=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()});var Z1=(e,t)=>{let r=Object.assign(Mr(e),hr(e),Kt(e),X1(e));return t.forEach(o=>o.configure(r)),Object.assign(e,Lr(r),gr(r),qt(r),Q1(r))};var au=class extends Be{config;constructor(...[t]){let r=Y1(t||{});super(r),this.initConfig=r;let o=N1(r),n=nr(o),s=Tr(n),i=_r(s),a=i,c=Rr(a),l=D1(c),p=Z1(l,t?.extensions||[]);this.config=p,this.middlewareStack.use(tr(this.config)),this.middlewareStack.use(yr(this.config)),this.middlewareStack.use(Cr(this.config)),this.middlewareStack.use(br(this.config)),this.middlewareStack.use(Yt(this.config)),this.middlewareStack.use(Xt(this.config)),this.middlewareStack.use(Qt(this.config)),this.middlewareStack.use(Zt(this.config,{httpAuthSchemeParametersProvider:A1,identityProviderConfigProvider:async u=>new _t({"aws.auth#sigv4":u.credentials})})),this.middlewareStack.use(er(this.config))}destroy(){super.destroy()}};ae();N();var W=class e extends wt{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}};var cu=class e extends W{name="AccountSendingPausedException";$fault="client";constructor(t){super({name:"AccountSendingPausedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},du=class e extends W{name="AlreadyExistsException";$fault="client";Name;constructor(t){super({name:"AlreadyExistsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Name=t.Name}},lu=class e extends W{name="CannotDeleteException";$fault="client";Name;constructor(t){super({name:"CannotDeleteException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Name=t.Name}},pu=class e extends W{name="LimitExceededException";$fault="client";constructor(t){super({name:"LimitExceededException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},uu=class e extends W{name="RuleSetDoesNotExistException";$fault="client";Name;constructor(t){super({name:"RuleSetDoesNotExistException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Name=t.Name}},fu=class e extends W{name="ConfigurationSetAlreadyExistsException";$fault="client";ConfigurationSetName;constructor(t){super({name:"ConfigurationSetAlreadyExistsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName}},mu=class e extends W{name="ConfigurationSetDoesNotExistException";$fault="client";ConfigurationSetName;constructor(t){super({name:"ConfigurationSetDoesNotExistException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName}},hu=class e extends W{name="ConfigurationSetSendingPausedException";$fault="client";ConfigurationSetName;constructor(t){super({name:"ConfigurationSetSendingPausedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName}},gu=class e extends W{name="InvalidConfigurationSetException";$fault="client";constructor(t){super({name:"InvalidConfigurationSetException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},xu=class e extends W{name="EventDestinationAlreadyExistsException";$fault="client";ConfigurationSetName;EventDestinationName;constructor(t){super({name:"EventDestinationAlreadyExistsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName,this.EventDestinationName=t.EventDestinationName}},yu=class e extends W{name="InvalidCloudWatchDestinationException";$fault="client";ConfigurationSetName;EventDestinationName;constructor(t){super({name:"InvalidCloudWatchDestinationException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName,this.EventDestinationName=t.EventDestinationName}},Su=class e extends W{name="InvalidFirehoseDestinationException";$fault="client";ConfigurationSetName;EventDestinationName;constructor(t){super({name:"InvalidFirehoseDestinationException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName,this.EventDestinationName=t.EventDestinationName}},Eu=class e extends W{name="InvalidSNSDestinationException";$fault="client";ConfigurationSetName;EventDestinationName;constructor(t){super({name:"InvalidSNSDestinationException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName,this.EventDestinationName=t.EventDestinationName}},_u=class e extends W{name="InvalidTrackingOptionsException";$fault="client";constructor(t){super({name:"InvalidTrackingOptionsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},bu=class e extends W{name="TrackingOptionsAlreadyExistsException";$fault="client";ConfigurationSetName;constructor(t){super({name:"TrackingOptionsAlreadyExistsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName}},wu=class e extends W{name="CustomVerificationEmailInvalidContentException";$fault="client";constructor(t){super({name:"CustomVerificationEmailInvalidContentException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Ru=class e extends W{name="CustomVerificationEmailTemplateAlreadyExistsException";$fault="client";CustomVerificationEmailTemplateName;constructor(t){super({name:"CustomVerificationEmailTemplateAlreadyExistsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.CustomVerificationEmailTemplateName=t.CustomVerificationEmailTemplateName}},Iu=class e extends W{name="FromEmailAddressNotVerifiedException";$fault="client";FromEmailAddress;constructor(t){super({name:"FromEmailAddressNotVerifiedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.FromEmailAddress=t.FromEmailAddress}},Tu=class e extends W{name="InvalidLambdaFunctionException";$fault="client";FunctionArn;constructor(t){super({name:"InvalidLambdaFunctionException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.FunctionArn=t.FunctionArn}},vu=class e extends W{name="InvalidS3ConfigurationException";$fault="client";Bucket;constructor(t){super({name:"InvalidS3ConfigurationException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Bucket=t.Bucket}},Cu=class e extends W{name="InvalidSnsTopicException";$fault="client";Topic;constructor(t){super({name:"InvalidSnsTopicException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Topic=t.Topic}},Au=class e extends W{name="RuleDoesNotExistException";$fault="client";Name;constructor(t){super({name:"RuleDoesNotExistException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.Name=t.Name}},Pu=class e extends W{name="InvalidTemplateException";$fault="client";TemplateName;constructor(t){super({name:"InvalidTemplateException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.TemplateName=t.TemplateName}},Du=class e extends W{name="CustomVerificationEmailTemplateDoesNotExistException";$fault="client";CustomVerificationEmailTemplateName;constructor(t){super({name:"CustomVerificationEmailTemplateDoesNotExistException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.CustomVerificationEmailTemplateName=t.CustomVerificationEmailTemplateName}},Nu=class e extends W{name="EventDestinationDoesNotExistException";$fault="client";ConfigurationSetName;EventDestinationName;constructor(t){super({name:"EventDestinationDoesNotExistException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName,this.EventDestinationName=t.EventDestinationName}},Ou=class e extends W{name="TrackingOptionsDoesNotExistException";$fault="client";ConfigurationSetName;constructor(t){super({name:"TrackingOptionsDoesNotExistException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.ConfigurationSetName=t.ConfigurationSetName}},ku=class e extends W{name="TemplateDoesNotExistException";$fault="client";TemplateName;constructor(t){super({name:"TemplateDoesNotExistException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.TemplateName=t.TemplateName}},$u=class e extends W{name="InvalidDeliveryOptionsException";$fault="client";constructor(t){super({name:"InvalidDeliveryOptionsException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Mu=class e extends W{name="InvalidPolicyException";$fault="client";constructor(t){super({name:"InvalidPolicyException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Lu=class e extends W{name="InvalidRenderingParameterException";$fault="client";TemplateName;constructor(t){super({name:"InvalidRenderingParameterException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.TemplateName=t.TemplateName}},Uu=class e extends W{name="MailFromDomainNotVerifiedException";$fault="client";constructor(t){super({name:"MailFromDomainNotVerifiedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Fu=class e extends W{name="MessageRejected";$fault="client";constructor(t){super({name:"MessageRejected",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}},Bu=class e extends W{name="MissingRenderingAttributeException";$fault="client";TemplateName;constructor(t){super({name:"MissingRenderingAttributeException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype),this.TemplateName=t.TemplateName}},Hu=class e extends W{name="ProductionAccessNotGrantedException";$fault="client";constructor(t){super({name:"ProductionAccessNotGrantedException",$fault:"client",...t}),Object.setPrototypeOf(this,e.prototype)}};var XH="AlreadyExistsException";var QH="AccountSendingPausedException";var e$="Body";var ZH="BccAddresses";var eV="Bucket",tV="Content";var rV="CcAddresses";var oV="CannotDeleteException";var nV="ConfigurationSetAlreadyExistsException";var sV="ConfigurationSetDoesNotExistException",Xr="ConfigurationSetName",iV="ConfigurationSetSendingPausedException";var aV="CustomVerificationEmailInvalidContentException";var cV="CustomVerificationEmailTemplateAlreadyExistsException",dV="CustomVerificationEmailTemplateDoesNotExistException",t$="CustomVerificationEmailTemplateName";var lV="Charset";var r$="Destination";var pV="Data";var uV="EventDestinationAlreadyExistsException",fV="EventDestinationDoesNotExistException",bc="EventDestinationName";var mV="FunctionArn";var hV="FromEmailAddress",gV="FromEmailAddressNotVerifiedException";var xV="Html";var yV="InvalidConfigurationSetException",SV="InvalidCloudWatchDestinationException";var EV="InvalidDeliveryOptionsException";var _V="InvalidFirehoseDestinationException",bV="InvalidLambdaFunctionException";var wV="InvalidPolicyException";var RV="InvalidRenderingParameterException",IV="InvalidS3ConfigurationException",TV="InvalidSNSDestinationException",vV="InvalidSnsTopicException";var CV="InvalidTemplateException",AV="InvalidTrackingOptionsException";var PV="LimitExceededException";var o$="Message";var DV="MailFromDomainNotVerifiedException";var NV="MessageId";var OV="MissingRenderingAttributeException",kV="MessageRejected";var $V="MessageTag",MV="MessageTagList";var wc="Name";var LV="ProductionAccessNotGrantedException";var UV="RuleDoesNotExistException";var FV="ReturnPath",BV="ReturnPathArn";var HV="RuleSetDoesNotExistException";var VV="ReplyToAddresses";var GV="SourceArn";var jV="SendEmailRequest",WV="SendEmailResponse";var zV="SendEmail";var KV="Source";var qV="Subject",JV="Text";var YV="ToAddresses";var XV="TemplateDoesNotExistException";var Vu="TemplateName";var QV="TrackingOptionsAlreadyExistsException",ZV="TrackingOptionsDoesNotExistException";var eG="Tags";var tG="Topic";var rG="Value";var Q="awsQueryError",Z="client",ee="error",te="httpError",re="message",n$="smithy.ts.sdk.synthetic.com.amazonaws.ses",R="com.amazonaws.ses",oG=[-3,R,QH,{[Q]:["AccountSendingPausedException",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(oG,cu);var nG=[-3,R,XH,{[Q]:["AlreadyExists",400],[ee]:Z,[te]:400},[wc,re],[0,0]];S.for(R).registerError(nG,du);var sG=[3,R,e$,0,[JV,xV],[()=>Sx,()=>Sx]];var iG=[-3,R,oV,{[Q]:["CannotDelete",400],[ee]:Z,[te]:400},[wc,re],[0,0]];S.for(R).registerError(iG,lu);var aG=[-3,R,nV,{[Q]:["ConfigurationSetAlreadyExists",400],[ee]:Z,[te]:400},[Xr,re],[0,0]];S.for(R).registerError(aG,fu);var cG=[-3,R,sV,{[Q]:["ConfigurationSetDoesNotExist",400],[ee]:Z,[te]:400},[Xr,re],[0,0]];S.for(R).registerError(cG,mu);var dG=[-3,R,iV,{[Q]:["ConfigurationSetSendingPausedException",400],[ee]:Z,[te]:400},[Xr,re],[0,0]];S.for(R).registerError(dG,hu);var Sx=[3,R,tV,0,[pV,lV],[0,0]];var lG=[-3,R,aV,{[Q]:["CustomVerificationEmailInvalidContent",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(lG,wu);var pG=[-3,R,cV,{[Q]:["CustomVerificationEmailTemplateAlreadyExists",400],[ee]:Z,[te]:400},[t$,re],[0,0]];S.for(R).registerError(pG,Ru);var uG=[-3,R,dV,{[Q]:["CustomVerificationEmailTemplateDoesNotExist",400],[ee]:Z,[te]:400},[t$,re],[0,0]];S.for(R).registerError(uG,Du);var fG=[3,R,r$,0,[YV,rV,ZH],[64,64,64]];var mG=[-3,R,uV,{[Q]:["EventDestinationAlreadyExists",400],[ee]:Z,[te]:400},[Xr,bc,re],[0,0,0]];S.for(R).registerError(mG,xu);var hG=[-3,R,fV,{[Q]:["EventDestinationDoesNotExist",400],[ee]:Z,[te]:400},[Xr,bc,re],[0,0,0]];S.for(R).registerError(hG,Nu);var gG=[-3,R,gV,{[Q]:["FromEmailAddressNotVerified",400],[ee]:Z,[te]:400},[hV,re],[0,0]];S.for(R).registerError(gG,Iu);var xG=[-3,R,SV,{[Q]:["InvalidCloudWatchDestination",400],[ee]:Z,[te]:400},[Xr,bc,re],[0,0,0]];S.for(R).registerError(xG,yu);var yG=[-3,R,yV,{[Q]:["InvalidConfigurationSet",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(yG,gu);var SG=[-3,R,EV,{[Q]:["InvalidDeliveryOptions",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(SG,$u);var EG=[-3,R,_V,{[Q]:["InvalidFirehoseDestination",400],[ee]:Z,[te]:400},[Xr,bc,re],[0,0,0]];S.for(R).registerError(EG,Su);var _G=[-3,R,bV,{[Q]:["InvalidLambdaFunction",400],[ee]:Z,[te]:400},[mV,re],[0,0]];S.for(R).registerError(_G,Tu);var bG=[-3,R,wV,{[Q]:["InvalidPolicy",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(bG,Mu);var wG=[-3,R,RV,{[Q]:["InvalidRenderingParameter",400],[ee]:Z,[te]:400},[Vu,re],[0,0]];S.for(R).registerError(wG,Lu);var RG=[-3,R,IV,{[Q]:["InvalidS3Configuration",400],[ee]:Z,[te]:400},[eV,re],[0,0]];S.for(R).registerError(RG,vu);var IG=[-3,R,TV,{[Q]:["InvalidSNSDestination",400],[ee]:Z,[te]:400},[Xr,bc,re],[0,0,0]];S.for(R).registerError(IG,Eu);var TG=[-3,R,vV,{[Q]:["InvalidSnsTopic",400],[ee]:Z,[te]:400},[tG,re],[0,0]];S.for(R).registerError(TG,Cu);var vG=[-3,R,CV,{[Q]:["InvalidTemplate",400],[ee]:Z,[te]:400},[Vu,re],[0,0]];S.for(R).registerError(vG,Pu);var CG=[-3,R,AV,{[Q]:["InvalidTrackingOptions",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(CG,_u);var AG=[-3,R,PV,{[Q]:["LimitExceeded",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(AG,pu);var PG=[-3,R,DV,{[Q]:["MailFromDomainNotVerifiedException",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(PG,Uu);var DG=[3,R,o$,0,[qV,e$],[()=>Sx,()=>sG]];var NG=[-3,R,kV,{[Q]:["MessageRejected",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError(NG,Fu);var OG=[3,R,$V,0,[wc,rG],[0,0]],kG=[-3,R,OV,{[Q]:["MissingRenderingAttribute",400],[ee]:Z,[te]:400},[Vu,re],[0,0]];S.for(R).registerError(kG,Bu);var $G=[-3,R,LV,{[Q]:["ProductionAccessNotGranted",400],[ee]:Z,[te]:400},[re],[0]];S.for(R).registerError($G,Hu);var MG=[-3,R,UV,{[Q]:["RuleDoesNotExist",400],[ee]:Z,[te]:400},[wc,re],[0,0]];S.for(R).registerError(MG,Au);var LG=[-3,R,HV,{[Q]:["RuleSetDoesNotExist",400],[ee]:Z,[te]:400},[wc,re],[0,0]];S.for(R).registerError(LG,uu);var UG=[3,R,jV,0,[KV,r$,o$,VV,FV,GV,BV,eG,Xr],[0,()=>fG,()=>DG,64,0,0,0,()=>jG,0]],FG=[3,R,WV,0,[NV],[0]];var BG=[-3,R,XV,{[Q]:["TemplateDoesNotExist",400],[ee]:Z,[te]:400},[Vu,re],[0,0]];S.for(R).registerError(BG,ku);var HG=[-3,R,QV,{[Q]:["TrackingOptionsAlreadyExistsException",400],[ee]:Z,[te]:400},[Xr,re],[0,0]];S.for(R).registerError(HG,bu);var VG=[-3,R,ZV,{[Q]:["TrackingOptionsDoesNotExistException",400],[ee]:Z,[te]:400},[Xr,re],[0,0]];S.for(R).registerError(VG,Ou);var GG=[-3,n$,"SESServiceException",0,[],[]];S.for(n$).registerError(GG,W);var jG=[1,R,MV,0,()=>OG];var s$=[9,R,zV,0,()=>UG,()=>FG];Te();N();var Gu=class extends V.classBuilder().ep(O1).m(function(t,r,o,n){return[oe(o,t.getEndpointParameterInstructions())]}).s("SimpleEmailService","SendEmail",{}).n("SESClient","SendEmailCommand").sc(s$).build(){};var WG=()=>new au({region:process.env.AWS_REGION||"us-east-1",maxAttempts:3,retryMode:"adaptive",requestHandler:{requestTimeout:1e4}}),Ex=null,zG=()=>(Ex||(Ex=WG(),x.info("SES client initialized")),Ex),KG={passwordReset:e=>({subject:"Password Reset Request - AWS Lambda Control Plane",htmlBody:`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Password Reset Request</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background-color: #f8f9fa; padding: 20px; border-radius: 5px; margin-bottom: 20px; }
          .content { padding: 20px 0; }
          .button { display: inline-block; background-color: #007bff; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; margin: 20px 0; }
          .footer { margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; font-size: 12px; color: #666; }
          .warning { background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 5px; margin: 20px 0; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Password Reset Request</h1>
        </div>
        
        <div class="content">
          <p>Hello ${e.recipientName},</p>
          
          <p>We received a request to reset your password for your AWS Lambda Control Plane account. If you made this request, please click the button below to reset your password:</p>
          
          <a href="${e.resetUrl}" class="button">Reset Password</a>
          
          <p>Alternatively, you can copy and paste this link into your browser:</p>
          <p style="word-break: break-all; background-color: #f8f9fa; padding: 10px; border-radius: 3px;">${e.resetUrl}</p>
          
          <div class="warning">
            <strong>Important:</strong> This password reset link will expire in ${e.expirationMinutes} minutes for security reasons.
          </div>
          
          <p>If you did not request a password reset, please ignore this email. Your password will remain unchanged.</p>
          
          <p>For security reasons, please do not share this email or the reset link with anyone.</p>
        </div>
        
        <div class="footer">
          <p>This is an automated message from AWS Lambda Control Plane. Please do not reply to this email.</p>
          <p>If you continue to have problems, please contact your system administrator.</p>
        </div>
      </body>
      </html>
    `,textBody:`
Password Reset Request - AWS Lambda Control Plane

Hello ${e.recipientName},

We received a request to reset your password for your AWS Lambda Control Plane account. If you made this request, please use the following link to reset your password:

${e.resetUrl}

IMPORTANT: This password reset link will expire in ${e.expirationMinutes} minutes for security reasons.

If you did not request a password reset, please ignore this email. Your password will remain unchanged.

For security reasons, please do not share this email or the reset link with anyone.

This is an automated message from AWS Lambda Control Plane. Please do not reply to this email.
If you continue to have problems, please contact your system administrator.
    `.trim()})},bx=class{client;fromEmail;constructor(){this.client=zG();let t=vo();this.fromEmail=t.ses.fromEmail}async sendEmail(t,r,o){try{let n=Array.isArray(t)?t:[t];x.info("Sending email via SES",{recipients:n.length,subject:r.subject,correlationId:o});let s={Source:this.fromEmail,Destination:{ToAddresses:n},Message:{Subject:{Data:r.subject,Charset:"UTF-8"},Body:{Html:{Data:r.htmlBody,Charset:"UTF-8"},Text:{Data:r.textBody,Charset:"UTF-8"}}}},i=new Gu(s),a=await this.client.send(i);x.info("Email sent successfully via SES",{messageId:a.MessageId,recipients:n.length,correlationId:o})}catch(n){throw x.error("Failed to send email via SES",{error:n instanceof Error?n.message:"Unknown error",recipients:Array.isArray(t)?t.length:1,correlationId:o}),n}}async sendPasswordResetEmail(t,r,o,n){let i=`${vo().app.baseUrl}/auth/password-reset/confirm?token=${o}`,a=KG.passwordReset({recipientName:r,resetToken:o,resetUrl:i,expirationMinutes:30});await this.sendEmail(t,a,n)}static isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}static normalizeEmail(t){return t.toLowerCase().trim()}},_x=null,ju={get instance(){return _x||(_x=new bx),_x},sendEmail:(e,t,r)=>ju.instance.sendEmail(e,t,r),sendPasswordResetEmail:(e,t,r,o)=>ju.instance.sendPasswordResetEmail(e,t,r,o)};import{randomBytes as qG,createHash as JG}from"crypto";var wx=async(e,t)=>{try{x.info("Processing password reset request",{correlationId:e.correlationId,email:e.body?.email});let r=Yc.safeParse(e.body);if(!r.success){x.warn("Password reset request validation failed",{correlationId:e.correlationId,errors:r.error.errors}),A(t,"ValidationError","Invalid email format",e.correlationId,{validationErrors:r.error.errors});return}let{email:o}=r.data,n=await j.getStaffByEmail(o,e.correlationId);if(!n.found||!n.staff){x.warn("Password reset request for non-existent email",{correlationId:e.correlationId,email:o}),t.status(200).json({success:!0,message:"If an account with that email exists, a password reset link has been sent.",timestamp:new Date().toISOString()});return}let s=n.staff;if(!s.enabled){x.warn("Password reset request for disabled account",{correlationId:e.correlationId,email:o,staffId:s.staff_id}),t.status(200).json({success:!0,message:"If an account with that email exists, a password reset link has been sent.",timestamp:new Date().toISOString()});return}let i=qG(32).toString("hex"),a=JG("sha256").update(i).digest("hex"),c=Math.floor(Date.now()/1e3)+30*60,l=await j.createPasswordResetToken({token_hash:a,staff_id:s.staff_id,expires_at:c},e.correlationId);if(!l.success){x.error("Failed to create password reset token",{correlationId:e.correlationId,staffId:s.staff_id,error:l.error}),A(t,"InternalError","Failed to generate reset token",e.correlationId);return}try{await ju.sendPasswordResetEmail(s.email,s.email.split("@")[0]||"User",i,e.correlationId),x.info("Password reset email sent successfully",{correlationId:e.correlationId,staffId:s.staff_id,email:s.email,tokenHash:a})}catch(p){x.error("Failed to send password reset email",{correlationId:e.correlationId,staffId:s.staff_id,email:s.email,error:p instanceof Error?p.message:"Unknown error"});try{await j.deletePasswordResetToken(a,e.correlationId)}catch(u){x.error("Failed to cleanup password reset token after email failure",{correlationId:e.correlationId,tokenHash:a,error:u instanceof Error?u.message:"Unknown error"})}A(t,"InternalError","Failed to send reset email",e.correlationId);return}t.status(200).json({success:!0,message:"If an account with that email exists, a password reset link has been sent.",timestamp:new Date().toISOString()})}catch(r){x.error("Password reset request handler error",{correlationId:e.correlationId,error:r instanceof Error?r.message:"Unknown error"}),A(t,"InternalError","Password reset request failed",e.correlationId)}};import{createHash as YG}from"crypto";var Rx=async(e,t)=>{try{x.info("Processing password reset confirmation",{correlationId:e.correlationId});let r=Xc.safeParse(e.body);if(!r.success){x.warn("Password reset confirmation validation failed",{correlationId:e.correlationId,errors:r.error.errors}),A(t,"ValidationError","Invalid reset token or password format",e.correlationId,{validationErrors:r.error.errors});return}let{token:o,new_password:n}=r.data,s=C1(n);if(!s.isValid){x.warn("Password reset confirmation with weak password",{correlationId:e.correlationId,errors:s.errors}),A(t,"ValidationError","Password does not meet security requirements",e.correlationId,{passwordErrors:s.errors});return}let i=YG("sha256").update(o).digest("hex"),a=await j.getPasswordResetToken(i,e.correlationId);if(!a.found||!a.token){x.warn("Password reset confirmation with invalid token",{correlationId:e.correlationId,tokenHash:i}),A(t,"Unauthorized","Invalid or expired reset token",e.correlationId);return}let c=a.token;if(a.expired){x.warn("Password reset confirmation with expired token",{correlationId:e.correlationId,tokenHash:i,expiresAt:new Date(c.expires_at*1e3).toISOString()}),A(t,"Unauthorized","Reset token has expired",e.correlationId);return}if(c.used_at){x.warn("Password reset confirmation with already used token",{correlationId:e.correlationId,tokenHash:i,usedAt:c.used_at}),A(t,"Unauthorized","Reset token has already been used",e.correlationId);return}let l=await j.getStaffById(c.staff_id,e.correlationId);if(!l.found||!l.staff){x.error("Password reset token references non-existent staff member",{correlationId:e.correlationId,staffId:c.staff_id,tokenHash:i}),A(t,"InternalError","Invalid reset token",e.correlationId);return}let p=l.staff;if(!p.enabled){x.warn("Password reset confirmation for disabled account",{correlationId:e.correlationId,staffId:p.staff_id,email:p.email}),A(t,"Unauthorized","Account is disabled",e.correlationId);return}let u=await iu(n,e.correlationId),f=await j.updateStaffPassword(p.staff_id,u,e.correlationId);if(!f.success){x.error("Failed to update staff password",{correlationId:e.correlationId,staffId:p.staff_id,error:f.error}),A(t,"InternalError","Failed to update password",e.correlationId);return}try{await j.markPasswordResetTokenUsed(i,e.correlationId)}catch(m){x.error("Failed to mark password reset token as used",{correlationId:e.correlationId,tokenHash:i,error:m instanceof Error?m.message:"Unknown error"})}x.info("Password reset completed successfully",{correlationId:e.correlationId,staffId:p.staff_id,email:p.email}),t.status(200).json({success:!0,message:"Password has been reset successfully",timestamp:new Date().toISOString()})}catch(r){x.error("Password reset confirmation handler error",{correlationId:e.correlationId,error:r instanceof Error?r.message:"Unknown error"}),A(t,"InternalError","Password reset confirmation failed",e.correlationId)}};function i$(e){e.post("/auth/login",Vr({body:Jc}),xx),e.post("/auth/password-reset/request",Vr({body:Yc}),wx),e.post("/auth/password-reset/confirm",Vr({body:Xc}),Rx)}var Ix=async(e,t)=>{try{x.info("Processing staff registration request",{correlationId:e.correlationId,requestedBy:e.context.staff_id,requestedByEmail:e.context.email});let r=Kc.safeParse(e.body);if(!r.success){x.warn("Staff registration validation failed",{correlationId:e.correlationId,errors:r.error.errors}),A(t,"ValidationError","Invalid staff registration data",e.correlationId,{validationErrors:r.error.errors});return}let{email:o,password:n,roles:s}=r.data,i=await iu(n,e.correlationId),a={email:o,password_hash:i,roles:s,enabled:!0},c=await j.createStaff(a,e.correlationId);if(!c.success){x.warn("Staff registration failed",{correlationId:e.correlationId,email:o,error:c.error}),c.error?.includes("already exists")?A(t,"Conflict","Staff member with this email already exists",e.correlationId):A(t,"InternalError","Failed to create staff account",e.correlationId);return}x.info("Staff registration successful",{correlationId:e.correlationId,staffId:c.data?.staff_id,email:c.data?.email,roles:c.data?.roles,createdBy:e.context.staff_id}),t.status(201).json({success:!0,data:{staff_id:c.data?.staff_id,email:c.data?.email,roles:c.data?.roles,enabled:c.data?.enabled,created_at:c.data?.created_at},timestamp:new Date().toISOString()})}catch(r){x.error("Staff registration handler error",{correlationId:e.correlationId,error:r instanceof Error?r.message:"Unknown error"}),A(t,"InternalError","Staff registration failed",e.correlationId)}};var XG=_.object({staff_id:_.string().uuid()}),Tx=async(e,t)=>{try{x.info("Processing staff enable request",{correlationId:e.correlationId,requestedBy:e.context.staff_id,requestedByEmail:e.context.email});let r=XG.safeParse(e.body);if(!r.success){x.warn("Staff enable validation failed",{correlationId:e.correlationId,errors:r.error.errors}),A(t,"ValidationError","Invalid staff enable request",e.correlationId,{validationErrors:r.error.errors});return}let{staff_id:o}=r.data,n=await j.getStaffById(o,e.correlationId);if(!n.found||!n.staff){x.warn("Staff enable attempt for non-existent staff",{correlationId:e.correlationId,staffId:o}),A(t,"NotFound","Staff member not found",e.correlationId);return}if(n.staff.enabled){x.info("Staff member already enabled",{correlationId:e.correlationId,staffId:o,email:n.staff.email}),t.status(200).json({success:!0,data:{staff_id:n.staff.staff_id,email:n.staff.email,roles:n.staff.roles,enabled:n.staff.enabled,updated_at:n.staff.updated_at},message:"Staff member is already enabled",timestamp:new Date().toISOString()});return}let s=await j.updateStaff(o,{enabled:!0},e.correlationId);if(!s.success){x.error("Failed to enable staff member",{correlationId:e.correlationId,staffId:o,error:s.error}),A(t,"InternalError","Failed to enable staff member",e.correlationId);return}x.info("Staff member enabled successfully",{correlationId:e.correlationId,staffId:o,email:s.data?.email,enabledBy:e.context.staff_id}),t.status(200).json({success:!0,data:{staff_id:s.data?.staff_id,email:s.data?.email,roles:s.data?.roles,enabled:s.data?.enabled,updated_at:s.data?.updated_at},timestamp:new Date().toISOString()})}catch(r){x.error("Staff enable handler error",{correlationId:e.correlationId,error:r instanceof Error?r.message:"Unknown error"}),A(t,"InternalError","Staff enable failed",e.correlationId)}};var QG=_.object({staff_id:_.string().uuid()}),vx=async(e,t)=>{try{x.info("Processing staff disable request",{correlationId:e.correlationId,requestedBy:e.context.staff_id,requestedByEmail:e.context.email});let r=QG.safeParse(e.body);if(!r.success){x.warn("Staff disable validation failed",{correlationId:e.correlationId,errors:r.error.errors}),A(t,"ValidationError","Invalid staff disable request",e.correlationId,{validationErrors:r.error.errors});return}let{staff_id:o}=r.data;if(o===e.context.staff_id){x.warn("Staff member attempted to disable themselves",{correlationId:e.correlationId,staffId:o}),A(t,"Forbidden","Cannot disable your own account",e.correlationId);return}let n=await j.getStaffById(o,e.correlationId);if(!n.found||!n.staff){x.warn("Staff disable attempt for non-existent staff",{correlationId:e.correlationId,staffId:o}),A(t,"NotFound","Staff member not found",e.correlationId);return}if(!n.staff.enabled){x.info("Staff member already disabled",{correlationId:e.correlationId,staffId:o,email:n.staff.email}),t.status(200).json({success:!0,data:{staff_id:n.staff.staff_id,email:n.staff.email,roles:n.staff.roles,enabled:n.staff.enabled,updated_at:n.staff.updated_at},message:"Staff member is already disabled",timestamp:new Date().toISOString()});return}let s=await j.updateStaff(o,{enabled:!1},e.correlationId);if(!s.success){x.error("Failed to disable staff member",{correlationId:e.correlationId,staffId:o,error:s.error}),A(t,"InternalError","Failed to disable staff member",e.correlationId);return}x.info("Staff member disabled successfully",{correlationId:e.correlationId,staffId:o,email:s.data?.email,disabledBy:e.context.staff_id}),t.status(200).json({success:!0,data:{staff_id:s.data?.staff_id,email:s.data?.email,roles:s.data?.roles,enabled:s.data?.enabled,updated_at:s.data?.updated_at},timestamp:new Date().toISOString()})}catch(r){x.error("Staff disable handler error",{correlationId:e.correlationId,error:r instanceof Error?r.message:"Unknown error"}),A(t,"InternalError","Staff disable failed",e.correlationId)}};var Cx=async(e,t)=>{try{x.info("Processing staff profile request",{correlationId:e.correlationId,staffId:e.context.staff_id,email:e.context.email});let r=e.context.staff_id;if(!r){x.error("Staff profile request without staff_id in context",{correlationId:e.correlationId,context:e.context}),A(t,"Unauthorized","Invalid authentication context",e.correlationId);return}let o=await j.getStaffById(r,e.correlationId);if(!o.found||!o.staff){x.warn("Staff profile request for non-existent staff",{correlationId:e.correlationId,staffId:r}),A(t,"NotFound","Staff member not found",e.correlationId);return}let n=o.staff;if(!n.enabled){x.warn("Staff profile request for disabled account",{correlationId:e.correlationId,staffId:r,email:n.email}),A(t,"Forbidden","Account is disabled",e.correlationId);return}x.info("Staff profile retrieved successfully",{correlationId:e.correlationId,staffId:r,email:n.email,roles:n.roles}),t.status(200).json({success:!0,data:{staff_id:n.staff_id,email:n.email,roles:n.roles,enabled:n.enabled,created_at:n.created_at,updated_at:n.updated_at},timestamp:new Date().toISOString()})}catch(r){x.error("Staff profile handler error",{correlationId:e.correlationId,staffId:e.context.staff_id,error:r instanceof Error?r.message:"Unknown error"}),A(t,"InternalError","Failed to retrieve profile",e.correlationId)}};var ZG=_.object({staff_id:_.string().uuid()}),ej=_.object({staff_id:_.string().uuid()});function a$(e){e.post("/staff/register",on(),Qi,Vr({body:Kc}),Ix),e.post("/staff/enable",on(),Qi,Vr({body:ZG}),Tx),e.post("/staff/disable",on(),Qi,Vr({body:ej}),vx),e.get("/staff/me",on(),Cx)}var Ax=async(e,t)=>{try{x.info("Processing tenant registration request",{correlationId:e.correlationId,requestedBy:e.context.staff_id,requestedByEmail:e.context.email,requestedByRoles:e.context.roles});let r=qc.safeParse(e.body);if(!r.success){x.warn("Tenant registration validation failed",{correlationId:e.correlationId,errors:r.error.errors}),A(t,"ValidationError","Invalid tenant registration data",e.correlationId,{validationErrors:r.error.errors});return}let{name:o,email:n,contact_info:s}=r.data,i={name:o,email:n,contact_info:s||{}},a=await j.createTenant(i,e.correlationId);if(!a.success){x.warn("Tenant registration failed",{correlationId:e.correlationId,name:o,email:n,error:a.error}),a.error?.includes("already exists")||a.error?.includes("Conflict")?A(t,"Conflict","Tenant with this information already exists",e.correlationId):A(t,"InternalError","Failed to create tenant",e.correlationId);return}x.info("Tenant registration successful",{correlationId:e.correlationId,tenantId:a.data?.tenant_id,name:a.data?.name,email:a.data?.email,status:a.data?.status,createdBy:e.context.staff_id}),x.info("Tenant ready for downstream provisioning",{correlationId:e.correlationId,tenantId:a.data?.tenant_id,status:a.data?.status}),t.status(201).json({success:!0,data:{tenant_id:a.data?.tenant_id,name:a.data?.name,email:a.data?.email,contact_info:a.data?.contact_info,status:a.data?.status,created_at:a.data?.created_at},timestamp:new Date().toISOString()})}catch(r){x.error("Tenant registration handler error",{correlationId:e.correlationId,error:r instanceof Error?r.message:"Unknown error"}),A(t,"InternalError","Tenant registration failed",e.correlationId)}};function c$(e){e.post("/tenant/register",on(),uf,Vr({body:qc}),Ax)}var Pn=null;function tj(){if(Pn)return Pn;x.info("Initializing Lambda function with internal routing");try{return Pn=Sy(),i$(Pn),a$(Pn),c$(Pn),x.info("Router initialized successfully with all routes registered"),Pn}catch(e){throw x.error("Failed to initialize router",{error:e}),e}}var PPe=async(e,t)=>{t.callbackWaitsForEmptyEventLoop=!1;try{let r=tj(),o=e.requestContext?.requestId||"unknown",n=e.httpMethod||e.requestContext?.http?.method||"UNKNOWN",s=e.path||e.rawPath||"/";x.info("Processing request",{method:n,path:s,correlationId:o,coldStart:!Pn});let i=await r.handle(e,t);return x.info("Request processed successfully",{statusCode:i.statusCode,correlationId:o}),i}catch(r){let o=e.requestContext?.requestId||"unknown";return x.error("Unhandled error in Lambda handler",{error:r instanceof Error?r.message:String(r),stack:r instanceof Error?r.stack:void 0,correlationId:o}),{statusCode:500,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","X-Correlation-ID":o},body:JSON.stringify({error:{code:"InternalError",message:"Internal server error",correlationId:o},timestamp:new Date().toISOString()})}}};export{PPe as handler};
//# sourceMappingURL=index.mjs.map
